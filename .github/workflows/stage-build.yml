### This is the Terraform-generated dev-build.yml workflow for the          ###
### docker-matomo-stage app repository.                                     ###
### If this is a Lambda repo, uncomment the FUNCTION line at the end of the ###
### document. If the container requires any additional pre-build commands,  ###
### uncomment and edit the PREBUILD line at the end of the document.        ###
name: Stage Container Build and Deploy
on:
  workflow_dispatch:
  push:
    branches:
      - main
    paths-ignore:
      - '.github/**'

permissions: read-all

jobs:
  deploy:
    # These permissions are needed to interact with GitHub's OIDC Token endpoint.
    permissions:
      id-token: write
      contents: read

    name: Stage Container Deploy
    uses: mitlibraries/.github/.github/workflows/ecr-shared-deploy-stage.yml@main
    secrets: inherit
    with:
      AWS_REGION: "us-east-1"
      GHA_ROLE: "docker-matomo-gha-stage"
      ECR: "docker-matomo-stage"
      # FUNCTION: ""
      # PREBUILD: 
