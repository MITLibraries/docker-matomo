(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["HeatmapSessionRecording"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["HeatmapSessionRecording"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,a){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(i,n,function(t){return e[t]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="plugins/HeatmapSessionRecording/vue/dist/",a(a.s="fae3")}({"19dc":function(t,a){t.exports=e},"246e":function(e,t,a){var i,n;(function(s,r,o){e.exports?e.exports=o():(i=o,n="function"===typeof i?i.call(t,a,t,e):i,void 0===n||(e.exports=n))})(0,0,(function(){var e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},t=function(){var t=function(e){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=e["xField"]||e.defaultXField,this._yField=e["yField"]||e.defaultYField,this._valueField=e["valueField"]||e.defaultValueField,e["radius"]&&(this._cfgRadius=e["radius"])},a=e.defaultRadius;return t.prototype={_organiseData:function(e,t){var i=e[this._xField],n=e[this._yField],s=this._radi,r=this._data,o=this._max,l=this._min,c=e[this._valueField]||1,d=e.radius||this._cfgRadius||a;r[i]||(r[i]=[],s[i]=[]),r[i][n]?r[i][n]+=c:(r[i][n]=c,s[i][n]=d);var m=r[i][n];return m>o?(t?this.setDataMax(m):this._max=m,!1):m<l?(t?this.setDataMin(m):this._min=m,!1):{x:i,y:n,value:c,radius:d,min:l,max:o}},_unOrganizeData:function(){var e=[],t=this._data,a=this._radi;for(var i in t)for(var n in t[i])e.push({x:i,y:n,radius:a[i][n],value:t[i][n]});return{min:this._min,max:this._max,data:e}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0){var e=arguments[0],t=e.length;while(t--)this.addData.call(this,e[t])}else{var a=this._organiseData(arguments[0],!0);a&&(0===this._data.length&&(this._min=this._max=a.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[a]}))}return this},setData:function(e){var t=e.data,a=t.length;this._data=[],this._radi=[];for(var i=0;i<a;i++)this._organiseData(t[i],!1);return this._max=e.max,this._min=e.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(e){return this._max=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(e){return this._min=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(e){this._coordinator=e},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),a=function(){var e=function(e){var t=e.gradient||e.defaultGradient,a=document.createElement("canvas"),i=a.getContext("2d");a.width=256,a.height=1;var n=i.createLinearGradient(0,0,256,1);for(var s in t)n.addColorStop(s,t[s]);return i.fillStyle=n,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data},t=function(e,t){var a=document.createElement("canvas"),i=a.getContext("2d"),n=e,s=e;if(a.width=a.height=2*e,1==t)i.beginPath(),i.arc(n,s,e,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{var r=i.createRadialGradient(n,s,e*t,n,s,e);r.addColorStop(0,"rgba(0,0,0,1)"),r.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=r,i.fillRect(0,0,2*e,2*e)}return a},a=function(e){var t=[],a=e.min,i=e.max,n=e.radi,s=(e=e.data,Object.keys(e)),r=s.length;while(r--){var o=s[r],l=Object.keys(e[o]),c=l.length;while(c--){var d=l[c],m=e[o][d],p=n[o][d];t.push({x:o,y:d,value:m,radius:p})}}return{min:a,max:i,data:t}};function i(t){var a=t.container,i=this.shadowCanvas=document.createElement("canvas"),n=this.canvas=t.canvas||document.createElement("canvas"),s=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});n.className="heatmap-canvas",this._width=n.width=i.width=t.width||+s.width.replace(/px/,""),this._height=n.height=i.height=t.height||+s.height.replace(/px/,""),this.shadowCtx=i.getContext("2d"),this.ctx=n.getContext("2d"),n.style.cssText=i.style.cssText="position:absolute;left:0;top:0;",a.style.position="relative",a.appendChild(n),this._palette=e(t),this._templates={},this._setStyles(t)}return i.prototype={renderPartial:function(e){e.data.length>0&&(this._drawAlpha(e),this._colorize())},renderAll:function(e){this._clear(),e.data.length>0&&(this._drawAlpha(a(e)),this._colorize())},_updateGradient:function(t){this._palette=e(t)},updateConfig:function(e){e["gradient"]&&this._updateGradient(e),this._setStyles(e)},setDimensions:function(e,t){this._width=e,this._height=t,this.canvas.width=this.shadowCanvas.width=e,this.canvas.height=this.shadowCanvas.height=t},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(e){this._blur=0==e.blur?0:e.blur||e.defaultBlur,e.backgroundColor&&(this.canvas.style.backgroundColor=e.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=e.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=e.height||this._height,this._opacity=255*(e.opacity||0),this._maxOpacity=255*(e.maxOpacity||e.defaultMaxOpacity),this._minOpacity=255*(e.minOpacity||e.defaultMinOpacity),this._useGradientOpacity=!!e.useGradientOpacity},_drawAlpha:function(e){var a=this._min=e.min,i=this._max=e.max,n=(e=e.data||[],e.length),s=1-this._blur;while(n--){var r,o=e[n],l=o.x,c=o.y,d=o.radius,m=Math.min(o.value,i),p=l-d,u=c-d,h=this.shadowCtx;this._templates[d]?r=this._templates[d]:this._templates[d]=r=t(d,s);var g=(m-a)/(i-a);h.globalAlpha=g<.01?.01:g,h.drawImage(r,p,u),p<this._renderBoundaries[0]&&(this._renderBoundaries[0]=p),u<this._renderBoundaries[1]&&(this._renderBoundaries[1]=u),p+2*d>this._renderBoundaries[2]&&(this._renderBoundaries[2]=p+2*d),u+2*d>this._renderBoundaries[3]&&(this._renderBoundaries[3]=u+2*d)}},_colorize:function(){var e=this._renderBoundaries[0],t=this._renderBoundaries[1],a=this._renderBoundaries[2]-e,i=this._renderBoundaries[3]-t,n=this._width,s=this._height,r=this._opacity,o=this._maxOpacity,l=this._minOpacity,c=this._useGradientOpacity;e<0&&(e=0),t<0&&(t=0),e+a>n&&(a=n-e),t+i>s&&(i=s-t);for(var d=this.shadowCtx.getImageData(e,t,a,i),m=d.data,p=m.length,u=this._palette,h=3;h<p;h+=4){var g,b=m[h],v=4*b;if(v)g=r>0?r:b<o?b<l?l:b:o,m[h-3]=u[v],m[h-2]=u[v+1],m[h-1]=u[v+2],m[h]=c?u[v+3]:g}d.data=m,this.ctx.putImageData(d,e,t),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(e){var t,a=this.shadowCtx,i=a.getImageData(e.x,e.y,1,1),n=i.data[3],s=this._max,r=this._min;return t=Math.abs(s-r)*(n/255)>>0,t},getDataURL:function(){return this.canvas.toDataURL()}},i}(),i=function(){var t=!1;return"canvas2d"===e["defaultRenderer"]&&(t=a),t}(),n={merge:function(){for(var e={},t=arguments.length,a=0;a<t;a++){var i=arguments[a];for(var n in i)e[n]=i[n]}return e}},s=function(){var a=function(){function e(){this.cStore={}}return e.prototype={on:function(e,t,a){var i=this.cStore;i[e]||(i[e]=[]),i[e].push((function(e){return t.call(a,e)}))},emit:function(e,t){var a=this.cStore;if(a[e])for(var i=a[e].length,n=0;n<i;n++){var s=a[e][n];s(t)}}},e}(),s=function(e){var t=e._renderer,a=e._coordinator,i=e._store;a.on("renderpartial",t.renderPartial,t),a.on("renderall",t.renderAll,t),a.on("extremachange",(function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config["gradient"]||e._config["defaultGradient"]})})),i.setCoordinator(a)};function r(){var r=this._config=n.merge(e,arguments[0]||{});if(this._coordinator=new a,r["plugin"]){var o=r["plugin"];if(!e.plugins[o])throw new Error("Plugin '"+o+"' not found. Maybe it was not registered.");var l=e.plugins[o];this._renderer=new l.renderer(r),this._store=new l.store(r)}else this._renderer=new i(r),this._store=new t(r);s(this)}return r.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(e){return this._config=n.merge(this._config,e),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(e){return this._store.getValueAt?this._store.getValueAt(e):this._renderer.getValueAt?this._renderer.getValueAt(e):null}},r}(),r={create:function(e){return new s(e)},register:function(t,a){e.plugins[t]=a}};return r}))},"8bbf":function(e,a){e.exports=t},a5a2:function(e,t){e.exports=a},fae3:function(e,t,a){"use strict";if(a.r(t),a.d(t,"HeatmapVis",(function(){return oe})),a.d(t,"SessionRecordingVis",(function(){return Ot})),a.d(t,"HsrTargetTest",(function(){return Vt})),a.d(t,"HsrUrlTarget",(function(){return Ut})),a.d(t,"HeatmapEdit",(function(){return ha})),a.d(t,"HeatmapList",(function(){return Za})),a.d(t,"HeatmapManage",(function(){return di})),a.d(t,"SessionRecordingEdit",(function(){return Ti})),a.d(t,"SessionRecordingList",(function(){return On})),a.d(t,"SessionRecordingManage",(function(){return Sn})),a.d(t,"ListOfPageviews",(function(){return xn})),a.d(t,"HeatmapVisPage",(function(){return In})),a.d(t,"MatomoJsNotWritableAlert",(function(){return oi})),a.d(t,"Tooltip",(function(){return Y})),"undefined"!==typeof window){var i=window.document.currentScript,n=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(a.p=n[1])}var s=a("8bbf");const r={class:"heatmapVis"},o=["innerHTML"],l={class:"heatmapSelection"},c={style:{display:"inline","margin-right":"13.5px"}},d=["onClick"],m={style:{display:"inline","margin-left":"3rem","margin-right":"13.5px"}},p=["title","onClick"],u=["src","alt"],h={class:"numSamples"},g={class:"legendOuter"},b={class:"legend-area"},v=Object(s["createElementVNode"])("span",{class:"min"},"0",-1),O=["src"],j=Object(s["createElementVNode"])("span",{class:"max"},"0",-1),f={class:"customIframeWidth"},y=["textContent"],S={class:"iframeRecordingContainer",ref:"iframeRecordingContainer"},H={class:"heatmapWrapper"},_={id:"heatmapContainer",ref:"heatmapContainer"},E=Object(s["createElementVNode"])("div",{id:"highlightDiv"},null,-1),V=Object(s["createElementVNode"])("div",{class:"loadingUnderlay"},null,-1),N={class:"valign-wrapper loadingInner"},R={class:"loadingContent"},w=["title"],k=["src","width"],x={style:{"margin-top":"2rem"}},C={class:"ui-confirm",id:"confirmDeleteHeatmapScreenshot",ref:"confirmDeleteHeatmapScreenshot"},D=["value"],T=["value"];function M(e,t,a,i,n,M){const P=Object(s["resolveComponent"])("Field"),A=Object(s["resolveComponent"])("SaveButton"),B=Object(s["resolveComponent"])("Tooltip");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",r,[e.actualNumSamples.nb_samples_device_all?(Object(s["openBlock"])(),Object(s["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.recordedSamplesSince)},null,8,o)):Object(s["createCommentVNode"])("",!0),Object(s["createElementVNode"])("div",l,[Object(s["createElementVNode"])("h4",c,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_Action")),1),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.heatmapTypes,t=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",{class:Object(s["normalizeClass"])(["btn-flat",{visActive:t.key===e.heatmapType,["heatmapType"+t.key]:!0}]),onClick:a=>e.changeHeatmapType(t.key),key:t.key},Object(s["toDisplayString"])(t.name),11,d))),128)),Object(s["createElementVNode"])("h4",m,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_DeviceType")),1),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.deviceTypesWithSamples,t=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("span",{class:Object(s["normalizeClass"])(["btn-flat",{visActive:t.key===e.deviceType,["deviceType"+t.key]:!0}]),title:t.tooltip,onClick:a=>e.changeDeviceType(t.key),key:t.key},[Object(s["createElementVNode"])("img",{height:"15",src:t.logo,alt:`${e.translate("DevicesDetection_Device")} ${t.name}`},null,8,u),Object(s["createTextVNode"])(),Object(s["createElementVNode"])("span",h,Object(s["toDisplayString"])(t.numSamples),1)],10,p))),128)),Object(s["createElementVNode"])("div",g,[Object(s["createElementVNode"])("h4",null,Object(s["toDisplayString"])(e.translate("Installation_Legend")),1),Object(s["createElementVNode"])("div",b,[v,Object(s["createElementVNode"])("img",{class:"gradient",alt:"gradient",src:e.gradientImgData},null,8,O),j])]),Object(s["createElementVNode"])("div",f,[Object(s["createElementVNode"])("span",{style:{"margin-left":"2.5rem","margin-right":"13.5px"},textContent:Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_Width"))},null,8,y),Object(s["createVNode"])(P,{uicontrol:"select",name:"iframewidth","model-value":e.customIframeWidth,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.customIframeWidth=t,e.changeIframeWidth(e.customIframeWidth,!0)}),options:e.iframeWidthOptions},null,8,["model-value","options"])])]),Object(s["createElementVNode"])("div",S,[Object(s["createElementVNode"])("div",H,[Object(s["createElementVNode"])("div",_,null,512),E]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",{class:"hsrLoadingOuter",style:Object(s["normalizeStyle"])([{height:"400px"},{width:e.iframeWidth+"px"}])},[V,Object(s["createElementVNode"])("div",N,[Object(s["createElementVNode"])("div",R,Object(s["toDisplayString"])(e.translate("General_Loading")),1)])],4),[[s["vShow"],e.isLoading]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",{class:"aboveFoldLine",title:e.translate("HeatmapSessionRecording_AvgAboveFoldDescription"),style:Object(s["normalizeStyle"])({width:e.iframeWidth+"px",top:e.avgFold+"px"})},[Object(s["createElementVNode"])("div",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_AvgAboveFoldTitle",e.avgFold)),1)],12,w),[[s["vShow"],e.avgFold]]),e.embedUrl?(Object(s["openBlock"])(),Object(s["createElementBlock"])("iframe",{key:0,id:"recordingPlayer",ref:"recordingPlayer",sandbox:"allow-scripts allow-same-origin",referrerpolicy:"no-referrer",onLoad:t[1]||(t[1]=t=>e.onLoaded()),height:"400",src:e.embedUrl,width:e.iframeWidth},null,40,k)):Object(s["createCommentVNode"])("",!0)],512),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",x,[Object(s["createVNode"])(A,{style:{display:"block !important"},loading:e.isLoading,onClick:t[2]||(t[2]=t=>e.deleteScreenshot()),value:e.translate("HeatmapSessionRecording_DeleteScreenshot")},null,8,["loading","value"])],512),[[s["vShow"],e.showDeleteScreenshot]]),Object(s["createElementVNode"])("div",C,[Object(s["createElementVNode"])("h2",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteHeatmapScreenshotConfirm")),1),Object(s["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,D),Object(s["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,T)],512),Object(s["createVNode"])(B,{ref:"tooltip","click-count":e.clickCount,"click-rate":e.clickRate,"is-moves":1===e.heatmapType},null,8,["click-count","click-rate","is-moves"])])}var P=a("246e"),A=a.n(P),B=a("19dc"),U=a("a5a2");
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */
function F(e){return e&&e.contentWindow?e.contentWindow:e&&e.contentDocument&&e.contentDocument.defaultView?e.contentDocument.defaultView:void 0}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */function L(e,t){let a=null;return(i,n)=>(a&&(a.abort(),a=null),a=new AbortController,B["AjaxHelper"].post(Object.assign(Object.assign({},i),{},{method:e}),n,Object.assign(Object.assign({},t),{},{abortController:a})).finally(()=>{a=null}))}const I={class:"tooltip-item"},W={class:"tooltip-label"},q={class:"tooltip-value"},z={class:"tooltip-item"},$={class:"tooltip-label"},G={class:"tooltip-value"};function J(e,t,a,i,n,r){return Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{ref:"tooltipRef",class:"tooltip",style:Object(s["normalizeStyle"])(e.tooltipStyle)},[Object(s["createElementVNode"])("div",I,[Object(s["createElementVNode"])("span",W,Object(s["toDisplayString"])(e.getClickCountTranslation),1),Object(s["createElementVNode"])("span",q,Object(s["toDisplayString"])(e.getClickCount),1)]),Object(s["createElementVNode"])("div",z,[Object(s["createElementVNode"])("span",$,Object(s["toDisplayString"])(e.getClickRateTranslation),1),Object(s["createElementVNode"])("span",G,Object(s["toDisplayString"])(e.getClickRate),1)])],4)),[[s["vShow"],e.visible]])}var X=Object(s["defineComponent"])({props:{clickCount:{type:Number,required:!0},clickRate:{type:Number,required:!0},isMoves:{type:Boolean,required:!1,default:!1}},setup(){const e=Object(s["reactive"])({visible:!1,position:{top:0,left:0}}),t=Object(s["ref"])(null),a=Object(s["computed"])(()=>({top:e.position.top+"px",left:e.position.left+"px",position:"absolute",zIndex:1e3}));function i(a){const i=window.scrollY||document.documentElement.scrollTop,n=window.scrollX||document.documentElement.scrollLeft;e.position.top=a.clientY+i+10,e.position.left=a.clientX+n+10,e.visible=!0,Object(s["nextTick"])(()=>{const s=t.value;if(s){const{innerWidth:t,innerHeight:r}=window,o=s.getBoundingClientRect();o.right>t&&(e.position.left=a.clientX+n-o.width-10),o.bottom>r&&(e.position.top=a.clientY+i-o.height-10);const l=s.getBoundingClientRect();l.left<0&&(e.position.left=n+10),l.top<0&&(e.position.top=i+10)}})}function n(){e.visible=!1}return Object.assign(Object.assign({},Object(s["toRefs"])(e)),{},{tooltipRef:t,show:i,hide:n,tooltipStyle:a,translate:B["translate"]})},computed:{getClickCount(){return B["NumberFormatter"].formatNumber(this.clickCount)},getClickRate(){return B["NumberFormatter"].formatPercent(this.clickRate)},getClickCountTranslation(){const e=this.isMoves?"HeatmapSessionRecording_Moves":"HeatmapSessionRecording_Clicks";return Object(B["translate"])(e)},getClickRateTranslation(){const e=this.isMoves?"HeatmapSessionRecording_MoveRate":"HeatmapSessionRecording_ClickRate";return Object(B["translate"])(e)}}});X.render=J;var Y=X;const{$:K}=window,Q=1,Z=2,ee=3;let te=32e3;const ae=String(window.navigator.userAgent).toLowerCase();function ie(e,t,a){const i=K(e);i.css("height","400px");const n=a.getIframeHeight();i.css("height",n+"px"),K(t).css("height",n+"px").css("width",i.width()+"px").empty();const s=Math.ceil(n/te);for(let r=1;r<=s;r+=1){let e=te;r===s&&(e=n%te),K(t).append(`<div id="heatmap${r}" class="heatmapTile"></div>`),K(t).find("#heatmap"+r).css({height:e+"px"})}return s}function ne(e,t,a,i){const n=K(t);n.css("height","400px");const s=a.getIframeHeight();n.css("height",s+"px");const r=1e3,o=s/r,l=i.reduce((e,t)=>e+parseInt(t.value,10),0),c=[];let d=0,m=null,p=100,u=0;function h(e,t,a,i,n){return i+(e-t)/(a-t)*(n-i)}function g(e,t,a){if(t===a||!t&&!a)return[255,255,0];const i=h(e,t,a,0,255),n=(a-t)/5;return i>204?[255,h(e,a-n,a,255,0),0]:i>153?[h(e,a-2*n,a-n,0,255),255,0]:i>102?[0,255,h(e,a-3*n,a-2*n,255,0)]:i>51?[0,h(e,a-4*n,a-3*n,0,255),255]:[h(e,t,a-4*n,255,0),0,255]}if(i.forEach(e=>{const t=parseInt(e.value,10),a=parseInt(e.label,10),i=Math.round(a*o);m&&m.position===i?d+=t:(0!==l&&(p=(l-d)/l*100),d+=t,m={percentageValue:10*parseFloat(p.toFixed(1)),position:u,percent:p.toFixed(1)},c.push(m)),u=i}),c.length){const e=c.some(e=>0===e.position);e||c.unshift({percent:"100.0",percentageValue:1e3,position:0})}else c.push({percent:"0",percentageValue:0,position:0});let b=0;const v=1e3;c&&c.length&&c[0]&&(b=c[c.length-1].percentageValue);const O=n.width();let j=null;for(let f=0;f<c.length;f+=1){const t=c[f];j=c[f+1]?c[f+1]:{position:s};const a=t.position;let i=j.position-t.position;0===i&&(i=1);const n=t.percent+" percent reached this point",r=g(t.percentageValue,b,v),o=`rgb(${r.join(",")})`;K(e).append(`<div class="scrollHeatmapLeaf" title="${n}" style="width: ${O}px;height: ${i}px;left: 0;top: ${a}px; background-color: ${o};"></div>`)}K(".scrollHeatmapLeaf",e).tooltip({track:!0,items:"*",tooltipClass:"heatmapTooltip",show:!1,hide:!1}),K(".legend-area .min").text((b/10).toFixed(1)+"%"),K(".legend-area .max").text((v/10).toFixed(1)+"%")}function se(e,t,a,i){const n=ie(e,t,a),s=document.createElement("canvas");s.width=100,s.height=10;const r=document.querySelector(".legend-area .min"),o=document.querySelector(".legend-area .max"),l=document.querySelector(".legend-area .gradient"),c=s.getContext("2d");let d={};function m(e){if(r.innerHTML=""+e.min,o.innerHTML=""+e.max,e.gradient&&e.gradient!==d){d=e.gradient;const t=c.createLinearGradient(0,0,100,1);Object.keys(d).forEach(e=>{t.addColorStop(parseFloat(e),d[e])}),c.fillStyle=t,c.fillRect(0,0,100,10),l.src=s.toDataURL()}}const p=[];for(let u=1;u<=n;u+=1){const e={min:i.min,max:i.max,data:[]},t={container:document.getElementById("heatmap"+u),radius:10,maxOpacity:.5,minOpacity:0,blur:.75};if(1===u&&(t.onExtremaChange=m),i&&i.data&&i.data.length>=2e4?t.radius=8:i&&i.data&&i.data.length>=2e3&&(t.radius=9),1===n)e.data=i.data;else{const t=(u-1)*te,a=t+te-1;i.data.forEach(i=>{if(i.y>=t&&i.y<=a){const a=Object.assign(Object.assign({},i),{},{y:i.y-t});e.data.push(a)}})}const a=A.a.create(t);a.setData(e),p.push(a)}return p}ae.match(/(iPod|iPhone|iPad|Android|IEMobile|Windows Phone)/i)?te=2e3:(ae.indexOf("msie ")>0||ae.indexOf("trident/")>0||ae.indexOf("edge")>0)&&(te=8e3);var re=Object(s["defineComponent"])({props:{idSiteHsr:{type:Number,required:!0},deviceTypes:{type:Array,required:!0},heatmapTypes:{type:Array,required:!0},breakpointMobile:{type:Number,required:!0},breakpointTablet:{type:Number,required:!0},offsetAccuracy:{type:Number,required:!0},heatmapPeriod:{type:String,required:!0},heatmapDate:{type:String,required:!0},url:{type:String,required:!0},isActive:Boolean,numSamples:{type:Object,required:!0},excludedElements:{type:String,required:!0},createdDate:{type:String,required:!0},desktopPreviewSize:{type:Number,required:!0},iframeResolutionsValues:{type:Object,required:!0}},components:{Field:U["Field"],SaveButton:U["SaveButton"],Tooltip:Y},data(){return{isLoading:!1,iframeWidth:this.desktopPreviewSize,customIframeWidth:this.desktopPreviewSize,avgFold:0,heatmapType:this.heatmapTypes[0].key,deviceType:this.deviceTypes[0].key,iframeResolutions:this.iframeResolutionsValues,actualNumSamples:this.numSamples,dataCoordinates:[],currentElement:null,totalClicks:0,tooltipShowTimeoutId:null,clickCount:0,clickRate:0}},setup(e){const t=Object(s["ref"])(null);let a=null;const i=new Promise(e=>{a=e});let n=null;const r=t=>(n||(n=F(t).recordingFrame,n.excludeElements(e.excludedElements),n.addClass("html","piwikHeatmap"),n.addClass("html","matomoHeatmap"),n.addWorkaroundForSharepointHeatmaps()),n),o=Object(s["ref"])(null),l=(e,t,a,i)=>{o.value=se(e,t,a,i)};return{iframeLoadedPromise:i,onLoaded:a,getRecordedHeatmap:L("HeatmapSessionRecording.getRecordedHeatmap"),getRecordedHeatmapMetadata:L("HeatmapSessionRecording.getRecordedHeatmapMetadata"),getRecordingIframe:r,heatmapInstances:o,renderHeatmap:l,tooltip:t}},created(){-1===this.iframeResolutions.indexOf(this.breakpointMobile)&&this.iframeResolutions.push(this.breakpointMobile),-1===this.iframeResolutions.indexOf(this.breakpointTablet)&&this.iframeResolutions.push(this.breakpointTablet),this.iframeResolutions=this.iframeResolutions.sort((e,t)=>e-t),this.fetchHeatmap(),B["Matomo"].postEvent("hidePeriodSelector")},watch:{isLoading(){if(!0===this.isLoading)return;const e=window.document.getElementById("heatmapContainer");e&&(e.addEventListener("mouseleave",e=>{this.tooltipShowTimeoutId&&(clearTimeout(this.tooltipShowTimeoutId),this.tooltipShowTimeoutId=null),this.currentElement=null,this.handleTooltip(e,0,0,"hide");const t=window.document.getElementById("highlightDiv");t&&(t.hidden=!0)}),e.addEventListener("mousemove",e=>{this.handleMouseMove(e)}))}},beforeUnmount(){this.removeScrollHeatmap()},methods:{removeScrollHeatmap(){const e=this.$refs.iframeRecordingContainer;K(e).find(".scrollHeatmapLeaf").remove()},deleteScreenshot(){B["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteHeatmapScreenshot,{yes:()=>{this.isLoading=!0,B["AjaxHelper"].fetch({method:"HeatmapSessionRecording.deleteHeatmapScreenshot",idSiteHsr:this.idSiteHsr}).then(()=>{this.isLoading=!1,window.location.reload()})}})},fetchHeatmap(){if(this.removeScrollHeatmap(),this.heatmapInstances){const e=this.heatmapInstances;e.forEach(e=>{e.setData({max:1,min:0,data:[]})})}this.isLoading=!0,this.avgFold=0;const e=B["MatomoUrl"].parsed.value.segment?decodeURIComponent(B["MatomoUrl"].parsed.value.segment):void 0,t={idSiteHsr:this.idSiteHsr,heatmapType:this.heatmapType,deviceType:this.deviceType,period:this.heatmapPeriod,date:this.heatmapDate,filter_limit:-1,segment:e},a=this.getRecordedHeatmap(t),i=this.getRecordedHeatmapMetadata(t);Promise.all([a,i,this.iframeLoadedPromise]).then(e=>{const t=this.$refs.recordingPlayer,a=this.getRecordingIframe(t);ie(this.$refs.recordingPlayer,this.$refs.heatmapContainer,a),this.removeScrollHeatmap();const i=e[0],n=e[1];if(Array.isArray(n)&&n[0]?[this.actualNumSamples]=n:this.actualNumSamples=n,this.isLoading=!1,this.isScrollHeatmapType)ne(this.$refs.iframeRecordingContainer,t,a,i);else{var s;const e={min:0,max:0,data:[]};for(let t=0;t<i.length;t+=1){const n=i[t];if(n.selector){const t=a.getCoordinatesInFrame(n.selector,n.offset_x,n.offset_y,this.offsetAccuracy,!0);t&&(t.value=n.value,e.data.push(t),this.dataCoordinates.push(t),this.totalClicks+=parseInt(n.value,10))}}if(2===this.heatmapType){let t=0;e.data.forEach(e=>{null!==e&&void 0!==e&&e.value&&parseInt(e.value,10)>1&&(t+=1)}),t/e.data.length>=.1&&e.data.length>120?e.max=2:e.max=1}else{const t=10,a={};if(e.data.forEach(i=>{if(!i||!i.value)return;let n=parseInt(i.value,10);n>e.max&&(e.max=n),n>t&&(n=t);const s=""+n;s in a?a[s]+=1:a[s]=0}),e.max>t){let i=0;for(let n=t;n>1;n-=1){const t=""+n;if(t in a&&(i+=a[t]),i/e.data.length>=.2){e.max=n;break}}if(e.max>t){e.max=5;for(let t=5;t>0;t-=1){const i=""+t;if(i in a){e.max=t;break}}}}}if(this.renderHeatmap(this.$refs.recordingPlayer,this.$refs.heatmapContainer,a,e),null!==(s=this.actualNumSamples)&&void 0!==s&&s["avg_fold_device_"+this.deviceType]){const e=this.actualNumSamples["avg_fold_device_"+this.deviceType],t=a.getIframeHeight();t&&(this.avgFold=parseInt(""+e/100*t,10))}}}).finally(()=>{this.isLoading=!1})},changeDeviceType(e){this.deviceType=e,this.deviceType===Q?this.changeIframeWidth(this.desktopPreviewSize,!1):this.deviceType===Z?this.changeIframeWidth(this.breakpointTablet||960,!1):this.deviceType===ee&&this.changeIframeWidth(this.breakpointMobile||600,!1)},changeIframeWidth(e,t){this.iframeWidth=e,this.customIframeWidth=this.iframeWidth,this.totalClicks=0,this.dataCoordinates=[],this.fetchHeatmap(),t&&B["Matomo"].helper.lazyScrollToContent()},changeHeatmapType(e){this.heatmapType=e,this.totalClicks=0,this.clickCount=0,this.clickRate=0,this.dataCoordinates=[],this.fetchHeatmap()},handleMouseMove(e){const t=window.document.getElementById("highlightDiv");if(!t)return;this.tooltipShowTimeoutId&&(clearTimeout(this.tooltipShowTimeoutId),this.tooltipShowTimeoutId=null,this.currentElement=null),t.hidden||this.handleTooltip(e,0,0,"move");const a=this.lookUpRecordedElementAtEventLocation(e);if(!a||a===this.currentElement)return;this.handleTooltip(e,0,0,"hide"),t.hidden=!0;const i=a.getBoundingClientRect();let n=0;this.dataCoordinates.forEach(e=>{e.y<i.top||e.y>i.bottom||e.x<i.left||e.x>i.right||(n+=parseInt(e.value,10))}),this.tooltipShowTimeoutId=setTimeout(()=>{this.currentElement=a,t.hidden=!1;const i=this.totalClicks?Math.round(n/this.totalClicks*1e4)/100:0,s=a.getBoundingClientRect();t.style.top=s.top+"px",t.style.left=s.left+"px",t.style.width=s.width+"px",t.style.height=s.height+"px",this.handleTooltip(e,n,i,"show"),this.tooltipShowTimeoutId=null},100)},lookUpRecordedElementAtEventLocation(e){const t=e.target;if(!t)return null;const a=window.document.getElementById("recordingPlayer");if(!a)return null;const i=a.contentWindow?a.contentWindow.document:a.contentDocument;if(!i)return null;const n=t.getBoundingClientRect();return i.elementFromPoint(e.clientX-n.left,e.clientY-n.top)},handleTooltip(e,t,a,i){this.tooltip&&("show"===i?(this.clickCount=t,this.clickRate=a,this.tooltip.show(e)):"move"===i?this.tooltip.show(e):this.tooltip.hide())}},computed:{isScrollHeatmapType(){return 3===this.heatmapType},tokenAuth(){return B["MatomoUrl"].parsed.value.token_auth},embedUrl(){return"?"+B["MatomoUrl"].stringify({module:"HeatmapSessionRecording",action:"embedPage",idSite:B["Matomo"].idSite,idSiteHsr:this.idSiteHsr,token_auth:this.tokenAuth||void 0})},iframeWidthOptions(){return this.iframeResolutions.map(e=>({key:e,value:e+"px"}))},recordedSamplesSince(){const e=Object(B["translate"])("HeatmapSessionRecording_HeatmapXRecordedSamplesSince",`<span class="deviceAllCountSamples">${this.actualNumSamples.nb_samples_device_all}</span>`,this.createdDate),t=Object(B["externalLink"])("https://matomo.org/faq/heatmap-session-recording/troubleshooting-heatmaps/"),a=Object(B["translate"])("HeatmapSessionRecording_HeatmapTroubleshoot",t,"</a>");return`${e} ${a}`},deviceTypesWithSamples(){return this.deviceTypes.map(e=>{let t;t=this.actualNumSamples["nb_samples_device_"+e.key]?this.actualNumSamples["nb_samples_device_"+e.key]:0;const a=Object(B["translate"])("HeatmapSessionRecording_XSamples",`${e.name} - ${t}`);return Object.assign(Object.assign({},e),{},{numSamples:t,tooltip:a})})},hasWriteAccess(){return!(null===B["Matomo"]||void 0===B["Matomo"]||!B["Matomo"].heatmapWriteAccess)},showDeleteScreenshot(){return this.isActive&&this.hasWriteAccess},gradientImgData(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAKCAYAAABCHPt+AAAAnklEQVRYR+2WQQqDQBAES5wB/f8/Y05RcMWwSu6JIT0Dm4WlH1DUdHew7/z6WYFhhnGRpnlhAEaQpi/ADbh/np0MiBhGhW+2ymFU+DZfg1EhaoB4jCFuMYYcQKZrXwPEVvm5Og0pcYakBvI35G1jNIZ4jCHexxjSpz9ZFUjAynLbpOvqteaODkm9sloz5JF+ZTVmSAWSu9Qb65AvgDwBQoLgVDlWfAQAAAAASUVORK5CYII="}}});re.render=M;var oe=re;const le={class:"sessionRecordingPlayer"},ce={class:"controls"},de={class:"playerActions"},me=["title"],pe=["title"],ue=["title"],he=["title"],ge=["title"],be=["title"],ve=["title"],Oe=["title"],je={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},fe=Object(s["createElementVNode"])("path",{d:"M480 576.5v-321h-64.5v129h-63v-129h-64.5v192h127.5v129h64.5zM607.5 127.999c34.5 0\n              64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447z"},null,-1),ye=[fe],Se={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},He=Object(s["createElementVNode"])("path",{d:"M448.5 576.5v-321h-129v64.5h64.5v256.5h64.5zM607.5 127.999c34.5 0 64.5 30 64.5\n              64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5 0-64.5-30-64.5-64.5v-447c0-34.5\n              30-64.5 64.5-64.5h447z"},null,-1),_e=[He],Ee={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},Ve=Object(s["createElementVNode"])("path",{d:"M480 384.5v-64.5c0-36-30-64.5-64.5-64.5h-127.5v64.5h127.5v64.5h-63c-34.5 0-64.5\n              27-64.5 63v129h192v-64.5h-127.5v-64.5h63c34.5 0 64.5-27 64.5-63zM607.5 127.999c34.5\n              0 64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447z"},null,-1),Ne=[Ve],Re={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},we=Object(s["createElementVNode"])("path",{d:"M480 320v-64.5h-127.5c-34.5 0-64.5 28.5-64.5 64.5v192c0 36 30 64.5 64.5\n              64.5h63c34.5 0 64.5-28.5 64.5-64.5v-64.5c0-36-30-63-64.5-63h-63v-64.5h127.5zM607.5\n              127.999c34.5 0 64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447zM352.5 512v-64.5h63v64.5h-63z"},null,-1),ke=[we],xe=["title"],Ce=Object(s["createElementVNode"])("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},[Object(s["createElementVNode"])("path",{d:"M223.5 415.5h111l-64.5-63h-46.5v63zM72 72l624 624-42 40.5-88.5-90c-51 36-114\n              57-181.5 57-177 0-319.5-142.5-319.5-319.5 0-67.5 21-130.5 57-181.5l-90-88.5zM544.5\n              352.5h-111l-231-231c51-36 114-57 181.5-57 177 0 319.5 142.5 319.5 319.5 0 67.5-21\n              130.5-57 181.5l-148.5-150h46.5v-63z"})],-1),De=[Ce],Te=["title"],Me=Object(s["createElementVNode"])("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 768 768"},[Object(s["createElementVNode"])("path",{d:"M544.5 609v-129h63v192h-384v96l-127.5-127.5 127.5-127.5v96h321zM223.5\n              288v129h-63v-192h384v-96l127.5 127.5-127.5 127.5v-96h-321z"})],-1),Pe=[Me],Ae={class:"duration"},Be={class:"playerHelp"},Ue=Object(s["createElementVNode"])("span",{class:"clickEvent"},null,-1),Fe=Object(s["createElementVNode"])("span",{class:"moveEvent"},null,-1),Le=Object(s["createElementVNode"])("span",{class:"scrollEvent"},null,-1),Ie=Object(s["createElementVNode"])("span",{class:"resizeEvent"},null,-1),We=Object(s["createElementVNode"])("span",{class:"formChange"},null,-1),qe=Object(s["createElementVNode"])("span",{class:"mutationEvent"},null,-1),ze=Object(s["createElementVNode"])("br",{style:{clear:"right"}},null,-1),$e=["title"],Ge=Object(s["createElementVNode"])("br",null,null,-1),Je=Object(s["createElementVNode"])("div",{class:"loadingUnderlay"},null,-1),Xe={class:"valign-wrapper loadingInner"},Ye={class:"loadingContent"},Ke=["src","width","height"];function Qe(e,t,a,i,n,r){return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",le,[Object(s["createElementVNode"])("div",ce,[Object(s["createElementVNode"])("span",de,[Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"playerAction icon-skip-previous",title:e.skipPreviousButtonTitle,onClick:t[0]||(t[0]=t=>e.loadNewRecording(e.previousRecordingId))},null,8,me),[[s["vShow"],e.previousRecordingId]]),Object(s["createElementVNode"])("span",{class:"playerAction icon-fast-rewind",title:e.translate("HeatmapSessionRecording_PlayerRewindFast",10,"J"),onClick:t[1]||(t[1]=t=>e.jumpRelative(10,!1))},null,8,pe),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"playerAction icon-play",title:e.translate("HeatmapSessionRecording_PlayerPlay","K"),onClick:t[2]||(t[2]=t=>e.play())},null,8,ue),[[s["vShow"],!e.isPlaying&&!e.isFinished]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"playerAction icon-replay",title:e.translate("HeatmapSessionRecording_PlayerReplay","K"),onClick:t[3]||(t[3]=t=>e.replay())},null,8,he),[[s["vShow"],!e.isPlaying&&e.isFinished]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"playerAction icon-pause",title:e.translate("HeatmapSessionRecording_PlayerPause","K"),onClick:t[4]||(t[4]=t=>e.pause())},null,8,ge),[[s["vShow"],e.isPlaying]]),Object(s["createElementVNode"])("span",{class:"playerAction icon-fast-forward",title:e.translate("HeatmapSessionRecording_PlayerForwardFast",10,"L"),onClick:t[5]||(t[5]=t=>e.jumpRelative(10,!0))},null,8,be),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"playerAction icon-skip-next",title:e.translate("HeatmapSessionRecording_PlayerPageViewNext",e.nextRecordingInfo,"N"),onClick:t[6]||(t[6]=t=>e.loadNewRecording(e.nextRecordingId))},null,8,ve),[[s["vShow"],e.nextRecordingId]]),Object(s["createElementVNode"])("span",{class:"changeReplaySpeed",title:e.translate("HeatmapSessionRecording_ChangeReplaySpeed","S"),onClick:t[7]||(t[7]=t=>e.increaseReplaySpeed())},[Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("svg",je,ye,512)),[[s["vShow"],4===e.actualReplaySpeed]]),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("svg",Se,_e,512)),[[s["vShow"],1===e.actualReplaySpeed]]),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("svg",Ee,Ne,512)),[[s["vShow"],2===e.actualReplaySpeed]]),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("svg",Re,ke,512)),[[s["vShow"],6===e.actualReplaySpeed]])],8,Oe),Object(s["createElementVNode"])("span",{class:Object(s["normalizeClass"])(["toggleSkipPause",{active:e.actualSkipPausesEnabled}]),title:e.translate("HeatmapSessionRecording_ClickToSkipPauses",e.skipPausesEnabledText,"B"),onClick:t[8]||(t[8]=t=>e.toggleSkipPauses())},De,10,xe),Object(s["createElementVNode"])("span",{class:Object(s["normalizeClass"])(["toggleAutoPlay",{active:e.actualAutoPlayEnabled}]),title:e.translate("HeatmapSessionRecording_AutoPlayNextPageview",e.autoplayEnabledText,"A"),onClick:t[9]||(t[9]=t=>e.toggleAutoPlay())},Pe,10,Te),Object(s["createElementVNode"])("span",Ae,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_PlayerDurationXofY",e.positionPretty,e.durationPretty)),1)]),Object(s["createElementVNode"])("div",Be,[Object(s["createElementVNode"])("ul",null,[Object(s["createElementVNode"])("li",null,[Ue,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityClick")),1)]),Object(s["createElementVNode"])("li",null,[Fe,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityMove")),1)]),Object(s["createElementVNode"])("li",null,[Le,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityScroll")),1)]),Object(s["createElementVNode"])("li",null,[Ie,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityResize")),1)]),Object(s["createElementVNode"])("li",null,[We,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityFormChange")),1)]),Object(s["createElementVNode"])("li",null,[qe,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityPageChange")),1)])])]),ze]),Object(s["createElementVNode"])("div",{class:"timelineOuter",onClick:t[10]||(t[10]=t=>e.seekEvent(t)),style:Object(s["normalizeStyle"])({width:e.replayWidth+"px"})},[Object(s["createElementVNode"])("div",{class:"timelineInner",style:Object(s["normalizeStyle"])({width:e.progress+"%"})},null,4),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.clues,(e,t)=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{title:e.title,class:Object(s["normalizeClass"])(e.type),style:Object(s["normalizeStyle"])({left:e.left+"%"}),key:t},null,14,$e))),128))],4),Ge,Object(s["withDirectives"])(Object(s["createElementVNode"])("div",{class:"hsrLoadingOuter",style:Object(s["normalizeStyle"])({width:e.replayWidth+"px",height:e.replayHeight+"px"})},[Je,Object(s["createElementVNode"])("div",Xe,[Object(s["createElementVNode"])("div",Ye,Object(s["toDisplayString"])(e.translate("General_Loading")),1)])],4),[[s["vShow"],e.isLoading]]),Object(s["createElementVNode"])("div",{class:"replayContainerOuter",onClick:t[12]||(t[12]=t=>e.togglePlay()),style:Object(s["normalizeStyle"])({height:e.replayHeight+"px",width:e.replayWidth+"px"})},[Object(s["createElementVNode"])("div",{class:"replayContainerInner",style:Object(s["normalizeStyle"])([{"transform-origin":"0 0"},{transform:`scale(${e.replayScale})`,"margin-left":e.replayMarginLeft+"px"}])},[e.embedUrl?(Object(s["openBlock"])(),Object(s["createElementBlock"])("iframe",{key:0,id:"recordingPlayer",ref:"recordingPlayer",onLoad:t[11]||(t[11]=t=>e.onLoaded()),scrolling:"no",sandbox:"allow-scripts allow-same-origin",referrerpolicy:"no-referrer",src:e.embedUrl,width:e.recording.viewport_w_px,height:e.recording.viewport_h_px},null,40,Ke)):Object(s["createCommentVNode"])("",!0)],4)],4)])}const Ze=20,et=1,tt=2,at=3,it=4,nt=5,st=6,rt=9,ot=10,lt=12,ct={[tt]:"clickEvent",[et]:"moveEvent",[at]:"scrollEvent",[lt]:"scrollEvent",[it]:"resizeEvent",[rt]:"formChange",[ot]:"formChange",[nt]:"mutationEvent",[st]:"mutationEvent"},dt={[tt]:Object(B["translate"])("HeatmapSessionRecording_ActivityClick"),[et]:Object(B["translate"])("HeatmapSessionRecording_ActivityMove"),[at]:Object(B["translate"])("HeatmapSessionRecording_ActivityScroll"),[lt]:Object(B["translate"])("HeatmapSessionRecording_ActivityScroll"),[it]:Object(B["translate"])("HeatmapSessionRecording_ActivityResize"),[rt]:Object(B["translate"])("HeatmapSessionRecording_ActivityFormChange"),[ot]:Object(B["translate"])("HeatmapSessionRecording_ActivityFormChange"),[nt]:Object(B["translate"])("HeatmapSessionRecording_ActivityPageChange"),[st]:Object(B["translate"])("HeatmapSessionRecording_ActivityPageChange")},mt='\n<div class="mousePointer" style="width: 16px;height: 16px;position: absolute;z-index: 99999999;">\n    <svg enable-background="new 0 0 24 24" fill="black" stroke="white" version="1.0"\n        viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"\n        xmlns:xlink="http://www.w3.org/1999/xlink">\n        <path d="M7,2l12,11.2l-5.8,0.5l3.3,7.3l-2.2,1l-3.2-7.4L7,18.5V2"/>\n    </svg>\n</div>\n',{$:pt,Mousetrap:ut}=window;function ht(e){return"number"===typeof e?e:parseInt(e,10)}function gt(e){if(null!==e&&void 0!==e&&e.event_type)return ht(e.event_type)}function bt(e){const t=Math.floor(e/1e3);let a=Math.floor(t/60),i=t%60;return a<10&&(a="0"+a),i<10&&(i="0"+i),`${a}:${i}`}var vt=Object(s["defineComponent"])({props:{offsetAccuracy:{type:Number,required:!0},scrollAccuracy:{type:Number,required:!0},autoPlayEnabled:Boolean,skipPausesEnabled:Boolean,replaySpeed:{type:Number,default:1}},data(){return{isPlaying:!1,progress:0,isFinished:!1,isLoading:!0,seekTimeout:null,lastFramePainted:0,recording:JSON.parse(JSON.stringify(window.sessionRecordingData)),positionPretty:"00:00",previousRecordingId:null,previousRecordingInfo:null,nextRecordingId:null,nextRecordingInfo:null,frame:0,hasFoundPrevious:!1,hasFoundNext:!1,videoPlayerInterval:null,lastCanvasCoordinates:!1,actualAutoPlayEnabled:!!this.autoPlayEnabled,replayWidth:0,replayHeight:0,replayScale:0,replayMarginLeft:0,seek:e=>e,actualSkipPausesEnabled:!!this.skipPausesEnabled,actualReplaySpeed:this.replaySpeed}},setup(){const e=Object(s["ref"])(!1);let t=null;const a=new Promise(a=>{t=a,e.value=!0}),i=()=>{setTimeout(()=>{t("loaded")},500)};return{iframeLoadedPromise:a,onLoaded:i,iframeLoaded:e}},created(){this.recording.duration=ht(this.recording.duration),this.recording.pageviews.forEach(e=>{e&&e.idloghsr&&(""+e.idloghsr===""+this.recording.idLogHsr?this.hasFoundPrevious=!0:this.hasFoundPrevious?this.hasFoundNext||(this.hasFoundNext=!0,this.nextRecordingId=e.idloghsr,this.nextRecordingInfo=[e.label,e.server_time_pretty,e.time_on_page_pretty].join(" - ")):(this.previousRecordingId=e.idloghsr,this.previousRecordingInfo=[e.label,e.server_time_pretty,e.time_on_page_pretty].join(" - ")))})},mounted(){ut.bind(["space","k"],()=>{this.togglePlay()}),ut.bind("0",()=>{this.isFinished&&this.replay()}),ut.bind("p",()=>{this.loadNewRecording(this.previousRecordingId)}),ut.bind("n",()=>{this.loadNewRecording(this.nextRecordingId)}),ut.bind("s",()=>{this.increaseReplaySpeed()}),ut.bind("a",()=>{this.toggleAutoPlay()}),ut.bind("b",()=>{this.toggleSkipPauses()}),ut.bind("left",()=>{const e=5,t=!1;this.jumpRelative(e,t)}),ut.bind("right",()=>{const e=5,t=!0;this.jumpRelative(e,t)}),ut.bind("j",()=>{const e=10,t=!1;this.jumpRelative(e,t)}),ut.bind("l",()=>{const e=10,t=!0;this.jumpRelative(e,t)}),this.initViewport(),pt(window).on("resize",()=>this.initViewport()),this.iframeLoadedPromise.then(()=>{this.initPlayer()}),window.addEventListener("beforeunload",()=>{this.isPlaying=!1,this.videoPlayerInterval&&(clearInterval(this.videoPlayerInterval),this.videoPlayerInterval=null)})},methods:{initPlayer(){const e=this.$refs.recordingPlayer,t=F(e).recordingFrame;if(!t||!t.isSupportedBrowser())return;t.addClass("html","piwikSessionRecording"),t.addClass("html","matomoSessionRecording");let a=null;const i=(e,i)=>{a&&a.css({left:e.x-8+"px",top:e.y-8+"px"}),this.lastCanvasCoordinates&&(t.drawLine(this.lastCanvasCoordinates.x,this.lastCanvasCoordinates.y,e.x,e.y,i),this.lastCanvasCoordinates=e)},n=(e,n)=>{if(!this.lastCanvasCoordinates||!a)return void t.scrollTo(e,n);const s=t.getScrollTop(),r=t.getScrollLeft();t.scrollTo(e,n);const o=n-s,l=e-r;let c=l+this.lastCanvasCoordinates.x,d=o+this.lastCanvasCoordinates.y;c<=0&&(c=0),d<=0&&(d=0),i({x:c,y:d},"blue")},s=(e,t,a)=>{null!==e&&void 0!==e&&e.scrollTo?e.scrollTo(t,a):(e.scrollLeft=t,e.scrollTop=a)};let r=null;const o=e=>{const{isPlaying:a}=this;this.isPlaying=!1;const i=gt(e);let o=null;if(i===et)e.selector&&(o=t.getCoordinatesInFrame(e.selector,e.x,e.y,this.offsetAccuracy,!1),o&&r(o));else if(i===tt)e.selector&&(o=t.getCoordinatesInFrame(e.selector,e.x,e.y,this.offsetAccuracy,!1),o&&(r(o),t.drawCircle(o.x,o.y,"#ff9407")));else if(i===st)e.text&&t.applyMutation(e.text);else if(i===at){const a=t.getIframeHeight(),i=t.getIframeWidth(),s=parseInt(""+a/this.scrollAccuracy*ht(e.y),10),r=parseInt(""+i/this.scrollAccuracy*ht(e.x),10);n(r,s)}else if(i===lt){if(e.selector){const a=t.findElement(e.selector);if(a&&a.length&&a[0]){const t=Math.max(a[0].scrollHeight,a[0].offsetHeight,a.height(),0),i=Math.max(a[0].scrollWidth,a[0].offsetWidth,a.width(),0);if(t&&i){const n=parseInt(""+t/this.scrollAccuracy*ht(e.y),10),r=parseInt(""+i/this.scrollAccuracy*ht(e.x),10);s(a[0],r,n)}}}}else if(i===it)this.setViewportResolution(e.x,e.y);else if(i===rt){if(e.selector){const a=t.findElement(e.selector);if(a.length){const t=a.attr("type");t&&"file"===(""+t).toLowerCase()||a.val(e.text).change()}}}else if(i===ot&&e.selector){const a=t.findElement(e.selector);a.is("input")?a.prop("checked",1===e.text||"1"===e.text):a.is("select")&&a.val(e.text).change()}this.isPlaying=a};r=e=>{const n=()=>{const e=t.getIframeWidth(),a=t.getIframeHeight();t.makeSvg(e,a);for(let t=0;t<=this.frame;t+=Ze){if(!this.timeFrameBuckets[t])return;this.timeFrameBuckets[t].forEach(e=>{const a=gt(e);a!==et&&a!==at&&a!==lt&&a!==tt||(this.lastFramePainted=t,o(e))})}},s=t.getIframeWindow();if(!this.lastCanvasCoordinates){const i=t.getIframeHeight(),r=t.getIframeWidth();return t.appendContent(mt),a=t.findElement(".mousePointer"),t.makeSvg(r,i),s.removeEventListener("resize",n,!1),s.addEventListener("resize",n,!1),this.lastCanvasCoordinates=e,void a.css({left:e.x-8+"px",top:e.y-8+"px"})}let r=t.getScrollTop();const l=t.getScrollLeft();(e.y>r+ht(this.recording.viewport_h_px)||e.y<r)&&t.scrollTo(l,e.y-10),r=t.getScrollTop(),(e.x>l+ht(this.recording.viewport_w_px)||e.x<l)&&t.scrollTo(e.x-10,r),i(e,"#ff9407")},this.seek=e=>{if(!this.iframeLoaded)return;this.isLoading=!0;let a=this.frame;const i=e=>{for(let t=e;t<=this.frame;t+=Ze)(this.timeFrameBuckets[t]||[]).forEach(e=>{this.lastFramePainted=t,o(e)})};this.isFinished=!1,this.frame=e-e%Ze,this.progress=parseFloat(parseFloat(""+this.frame/ht(this.recording.duration)*100).toFixed(2)),this.positionPretty=bt(this.frame),a>this.frame?(a=0,this.lastCanvasCoordinates=!1,this.initialMutation&&t.initialMutation(this.initialMutation.text),t.scrollTo(0,0),this.setViewportResolution(window.sessionRecordingData.viewport_w_px,window.sessionRecordingData.viewport_h_px),this.seekTimeout&&(clearTimeout(this.seekTimeout),this.seekTimeout=null),(e=>{this.seekTimeout=setTimeout(()=>{i(e),this.isLoading=!1},1050)})(a)):(this.seekTimeout&&(clearTimeout(this.seekTimeout),this.seekTimeout=null),i(a),this.isLoading=!1)},this.isLoading=!1,this.isPlaying=!0;let l=0;const c=()=>{if(this.isPlaying&&!this.isLoading){l+=1;const e=ht(this.recording.duration);if(this.frame>=e?(this.isPlaying=!1,this.progress=100,this.isFinished=!0,this.positionPretty=this.durationPretty,this.actualAutoPlayEnabled&&this.nextRecordingId&&this.loadNewRecording(this.nextRecordingId)):(this.progress=parseFloat(parseFloat(""+this.frame/e*100).toFixed(2)),20===l&&(l=0,this.positionPretty=bt(this.frame))),(this.timeFrameBuckets[this.frame]||[]).forEach(e=>{this.lastFramePainted=this.frame,o(e)}),this.actualSkipPausesEnabled&&this.frame-this.lastFramePainted>1800){let t=Object.keys(this.timeFrameBuckets).map(e=>parseInt(e,10));t=t.sort((e,t)=>e-t);const a=t.find(e=>e>this.frame),i=!!a;if(a){const e=a-this.frame>1e3;e&&(this.frame=a-20*Ze)}if(!i){const t=e-this.frame>1e3;t&&(this.frame=e-20*Ze)}}this.frame+=Ze}};this.videoPlayerInterval=setInterval(()=>{for(let e=1;e<=this.actualReplaySpeed;e+=1)c()},Ze)},initViewport(){this.replayHeight=pt(window).height()-48-pt(".sessionRecording .sessionRecordingHead").outerHeight(!0)-pt(".sessionRecordingPlayer .controls").outerHeight(!0),this.replayWidth=pt(window).width()-48;const e=ht(this.recording.viewport_w_px),t=ht(this.recording.viewport_h_px),a=400;this.replayWidth<a&&e>a&&(this.replayWidth=a);const i=400;this.replayHeight<i&&t>i&&(this.replayHeight=i);let n=1,s=1;e>this.replayWidth&&(n=parseFloat(parseFloat(""+this.replayWidth/e).toFixed(4))),t>this.replayHeight&&(s=parseFloat(parseFloat(""+this.replayHeight/t).toFixed(4))),this.replayScale=Math.min(n,s),this.replayMarginLeft=(this.replayWidth-this.replayScale*e)/2},setViewportResolution(e,t){this.recording.viewport_w_px=parseInt(""+e,10),this.recording.viewport_h_px=parseInt(""+t,10),pt(".recordingWidth").text(e),pt(".recordingHeight").text(t),this.initViewport()},increaseReplaySpeed(){1===this.actualReplaySpeed?this.actualReplaySpeed=2:2===this.actualReplaySpeed?this.actualReplaySpeed=4:4===this.actualReplaySpeed?this.actualReplaySpeed=6:this.actualReplaySpeed=1,this.updateSettings()},updateSettings(){B["AjaxHelper"].fetch({module:"HeatmapSessionRecording",action:"saveSessionRecordingSettings",autoplay:this.actualAutoPlayEnabled?1:0,skippauses:this.actualSkipPausesEnabled?1:0,replayspeed:this.actualReplaySpeed},{format:"html"})},toggleAutoPlay(){this.actualAutoPlayEnabled=!this.actualAutoPlayEnabled,this.updateSettings()},toggleSkipPauses(){this.actualSkipPausesEnabled=!this.actualSkipPausesEnabled,this.updateSettings()},loadNewRecording(e){e&&(this.isPlaying=!1,B["MatomoUrl"].updateUrl(Object.assign(Object.assign({},B["MatomoUrl"].urlParsed.value),{},{idLogHsr:parseInt(""+e,10),updated:B["MatomoUrl"].urlParsed.value.updated?parseInt(B["MatomoUrl"].urlParsed.value.updated,10)+1:1})))},jumpRelative(e,t){const a=1e3*e;let i;t?(i=this.frame+a,i>this.recording.duration&&(i=ht(this.recording.duration)-Ze)):(i=this.frame-a,i<0&&(i=0)),this.seek(i)},replay(){this.isFinished=!1,this.lastFramePainted=0,this.seek(0),this.play()},pause(){this.isPlaying=!1},togglePlay(){this.isFinished?this.replay():this.isPlaying?this.pause():this.play()},seekEvent(e){const t=pt(e.currentTarget).offset(),a=e.pageX-t.left,i=this.replayWidth,n=a/i,s=ht(this.recording.duration)*n;this.seek(s)},play(){this.isPlaying=!0}},computed:{durationPretty(){return bt(ht(this.recording.duration))},embedUrl(){return"?"+B["MatomoUrl"].stringify({module:"HeatmapSessionRecording",action:"embedPage",idSite:this.recording.idSite,idLogHsr:this.recording.idLogHsr,idSiteHsr:this.recording.idSiteHsr,token_auth:B["MatomoUrl"].urlParsed.value.token_auth||void 0})},skipPreviousButtonTitle(){return Object(B["translate"])("HeatmapSessionRecording_PlayerPageViewPrevious",this.previousRecordingInfo||"","P")},skipPausesEnabledText(){return this.actualSkipPausesEnabled?Object(B["translate"])("HeatmapSessionRecording_disable"):Object(B["translate"])("HeatmapSessionRecording_enable")},autoplayEnabledText(){return this.actualAutoPlayEnabled?Object(B["translate"])("HeatmapSessionRecording_disable"):Object(B["translate"])("HeatmapSessionRecording_enable")},recordingEvents(){return this.recording?this.recording.events.map(e=>{const t=gt(e);let{text:a}=e;return t!==nt&&t!==st||"string"!==typeof a||(a=JSON.parse(a)),Object.assign(Object.assign({},e),{},{text:a})}):[]},initialMutation(){const e=this.recordingEvents.find(e=>{const t=gt(e),a=t===nt||t===st,i=a&&(t===nt||!e.time_since_load||"0"===e.time_since_load);return i});return e},timeFrameBuckets(){const e={};return this.recordingEvents.forEach(t=>{if(t===this.initialMutation)return;const a=Math.round(ht(t.time_since_load)/Ze)*Ze;e[a]=e[a]||[],e[a].push(t)}),e},clues(){const e=[];return this.recordingEvents.forEach(t=>{if(t===this.initialMutation)return;const a=gt(t),i=ct[a]||"",n=dt[a]||"";if(i){if((0===t.time_since_load||"0"===t.time_since_load)&&"moveEvent"===i)return;e.push({left:parseFloat(""+ht(t.time_since_load)/ht(this.recording.duration)*100).toFixed(2),type:i,title:n})}}),e}}});vt.render=Qe;var Ot=vt;const jt={class:"form-group hsrTargetTest"},ft={class:"loadingPiwik loadingMatchingSteps"},yt=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif",alt:""},null,-1),St=Object(s["createElementVNode"])("div",{id:"hsrTargetValidationError"},null,-1);function Ht(e,t,a,i,n,r){return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",jt,[Object(s["createElementVNode"])("label",null,[Object(s["createElementVNode"])("strong",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestTitle"))+":",1),Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestLabel")),1)]),Object(s["withDirectives"])(Object(s["createElementVNode"])("input",{type:"text",id:"urltargettest",placeholder:"http://www.example.com/","onUpdate:modelValue":t[0]||(t[0]=t=>e.url=t),class:Object(s["normalizeClass"])({invalid:e.url&&!e.matches&&e.isValid})},null,2),[[s["vModelText"],e.url]]),Object(s["createElementVNode"])("div",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"testInfo"},Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestErrorInvalidUrl")),513),[[s["vShow"],e.url&&!e.isValid]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"testInfo matches"},Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestUrlMatches")),513),[[s["vShow"],e.url&&e.matches&&e.isValid]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"testInfo notMatches"},Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestUrlNotMatches")),513),[[s["vShow"],e.url&&!e.matches&&e.isValid]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",ft,[yt,Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)],512),[[s["vShow"],e.isLoadingTestMatchPage]])]),St])}function _t(e){return e.indexOf("://")>3}var Et=Object(s["defineComponent"])({props:{includedTargets:Array},data(){return{url:"",matches:!1,isLoadingTestMatchPage:!1}},watch:{isValid(e){e||(this.matches=!1)},includedTargets(){this.runTest()},url(){this.runTest()}},setup(){return{testUrlMatchPages:L("HeatmapSessionRecording.testUrlMatchPages",{errorElement:"#hsrTargetValidationError"})}},created(){this.runTest=Object(B["debounce"])(this.runTest,200)},methods:{checkIsMatchingUrl(){if(!this.isValid)return;const e=this.targetUrl,t=this.filteredIncludedTargets;null!==t&&void 0!==t&&t.length&&(this.isLoadingTestMatchPage=!0,this.testUrlMatchPages({url:e},{matchPageRules:t}).then(e=>{var t;null!==(t=this.filteredIncludedTargets)&&void 0!==t&&t.length&&(null===e||void 0===e?void 0:e.url)===this.targetUrl&&(this.matches=e.matches)}).finally(()=>{this.isLoadingTestMatchPage=!1}))},runTest(){this.isValid&&this.checkIsMatchingUrl()}},computed:{targetUrl(){return(this.url||"").trim()},isValid(){return this.targetUrl&&_t(this.targetUrl)},filteredIncludedTargets(){if(this.includedTargets)return this.includedTargets.filter(e=>(null===e||void 0===e?void 0:e.value)||"any"===(null===e||void 0===e?void 0:e.type)).map(e=>Object.assign(Object.assign({},e),{},{value:e.value?e.value.trim():""}))}}});Et.render=Ht;var Vt=Et;const Nt={style:{width:"100%"}},Rt={name:"targetAttribute"},wt={name:"targetType"},kt={name:"targetValue"},xt={name:"targetValue2"},Ct=["title"],Dt=["title"];function Tt(e,t,a,i,n,r){const o=Object(s["resolveComponent"])("Field");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{class:Object(s["normalizeClass"])(["form-group hsrUrltarget valign-wrapper",{disabled:e.disableIfNoValue&&!e.modelValue.value}])},[Object(s["createElementVNode"])("div",Nt,[Object(s["createElementVNode"])("div",Rt,[Object(s["createVNode"])(o,{uicontrol:"select",name:"targetAttribute","model-value":e.modelValue.attribute,"onUpdate:modelValue":t[0]||(t[0]=t=>e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{attribute:t}))),title:e.translate("HeatmapSessionRecording_Rule"),options:e.targetAttributes,"full-width":!0},null,8,["model-value","title","options"])]),Object(s["createElementVNode"])("div",wt,[Object(s["createVNode"])(o,{uicontrol:"select",name:"targetType","model-value":e.pattern_type,"onUpdate:modelValue":t[1]||(t[1]=t=>{e.onTypeChange(t)}),options:e.targetOptions[e.modelValue.attribute],"full-width":!0},null,8,["model-value","options"])]),Object(s["createElementVNode"])("div",kt,[Object(s["withDirectives"])(Object(s["createVNode"])(o,{uicontrol:"text",name:"targetValue",placeholder:"eg. "+e.targetExamples[e.modelValue.attribute],"model-value":e.modelValue.value,"onUpdate:modelValue":t[2]||(t[2]=t=>e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{value:t.trim()}))),maxlength:500,"full-width":!0},null,8,["placeholder","model-value"]),[[s["vShow"],"any"!==e.pattern_type]])]),Object(s["createElementVNode"])("div",xt,[Object(s["withDirectives"])(Object(s["createVNode"])(o,{uicontrol:"text",name:"targetValue2","model-value":e.modelValue.value2,"onUpdate:modelValue":t[3]||(t[3]=t=>e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{value2:t.trim()}))),maxlength:500,"full-width":!0,placeholder:e.translate("HeatmapSessionRecording_UrlParameterValueToMatchPlaceholder")},null,8,["model-value","placeholder"]),[[s["vShow"],"urlparam"===e.modelValue.attribute&&e.pattern_type&&"exists"!==e.pattern_type&&"not_exists"!==e.pattern_type]])])]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"icon-plus valign",title:e.translate("General_Add"),onClick:t[4]||(t[4]=t=>e.$emit("addUrl"))},null,8,Ct),[[s["vShow"],e.showAddUrl]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("span",{class:"icon-minus valign",title:e.translate("General_Remove"),onClick:t[5]||(t[5]=t=>e.$emit("removeUrl"))},null,8,Dt),[[s["vShow"],e.canBeRemoved]])],2)}function Mt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */class Pt{constructor(){Mt(this,"privateState",Object(s["reactive"])({rules:[]})),Mt(this,"state",Object(s["computed"])(()=>Object(s["readonly"])(this.privateState))),Mt(this,"rules",Object(s["computed"])(()=>this.state.value.rules)),Mt(this,"initPromise",null)}init(){return this.initPromise||(this.initPromise=B["AjaxHelper"].fetch({method:"HeatmapSessionRecording.getAvailableTargetPageRules",filter_limit:"-1"}).then(e=>(this.privateState.rules=e,this.rules.value))),this.initPromise}}var At=new Pt,Bt=Object(s["defineComponent"])({props:{modelValue:{type:Object,required:!0},canBeRemoved:Boolean,disableIfNoValue:Boolean,allowAny:Boolean,showAddUrl:Boolean},components:{Field:U["Field"]},emits:["addUrl","removeUrl","update:modelValue"],created(){At.init()},watch:{modelValue(e){if(!e.attribute)return;const t=this.targetOptions[e.attribute],a=t.find(e=>e.key===this.pattern_type);!a&&t[0]&&this.onTypeChange(t[0].key)}},computed:{pattern_type(){let e=this.modelValue.type;return this.modelValue.inverted&&"0"!==this.modelValue.inverted&&(e="not_"+this.modelValue.type),e},targetAttributes(){return At.rules.value.map(e=>({key:e.value,value:e.name}))},targetOptions(){const e={};return At.rules.value.forEach(t=>{e[t.value]=[],this.allowAny&&"url"===t.value&&e[t.value].push({value:Object(B["translate"])("HeatmapSessionRecording_TargetTypeIsAny"),key:"any"}),t.types.forEach(a=>{e[t.value].push({value:a.name,key:a.value}),e[t.value].push({value:Object(B["translate"])("HeatmapSessionRecording_TargetTypeIsNot",a.name),key:"not_"+a.value})})}),e},targetExamples(){const e={};return At.rules.value.forEach(t=>{e[t.value]=t.example}),e}},methods:{onTypeChange(e){let t=0,a=e;0===e.indexOf("not_")&&(a=e.substring("not_".length),t=1),this.$emit("update:modelValue",Object.assign(Object.assign({},this.modelValue),{},{type:a,inverted:t}))}}});Bt.render=Tt;var Ut=Bt;const Ft={class:"loadingPiwik"},Lt=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),It={class:"loadingPiwik"},Wt=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),qt={name:"name"},zt={name:"sampleLimit"},$t={class:"form-group row"},Gt={class:"col s12"},Jt={class:"col s12 m6",style:{"padding-left":"0"}},Xt=Object(s["createElementVNode"])("hr",null,null,-1),Yt={class:"col s12 m6"},Kt={class:"form-help"},Qt={class:"inline-help"},Zt={name:"sampleRate"},ea={name:"excludedElements"},ta={name:"screenshotUrl"},aa={name:"breakpointMobile"},ia={name:"breakpointTablet"},na={name:"trackManually"},sa=["innerHTML"],ra={class:"entityCancel"};function oa(e,t,a,i,n,r){const o=Object(s["resolveComponent"])("Field"),l=Object(s["resolveComponent"])("HsrUrlTarget"),c=Object(s["resolveComponent"])("HsrTargetTest"),d=Object(s["resolveComponent"])("SaveButton"),m=Object(s["resolveComponent"])("ContentBlock");return Object(s["openBlock"])(),Object(s["createBlock"])(m,{class:"editHsr","content-title":e.contentTitle},{default:Object(s["withCtx"])(()=>[Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",Ft,[Lt,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[s["vShow"],e.isLoading]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",It,[Wt,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_UpdatingData")),1)])],512),[[s["vShow"],e.isUpdating]]),Object(s["createElementVNode"])("form",{onSubmit:t[12]||(t[12]=t=>e.edit?e.updateHsr():e.createHsr())},[Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("div",qt,[Object(s["createVNode"])(o,{uicontrol:"text",name:"name","model-value":e.siteHsr.name,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.siteHsr.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,placeholder:e.translate("HeatmapSessionRecording_FieldNamePlaceholder"),"inline-help":e.translate("HeatmapSessionRecording_HeatmapNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",zt,[Object(s["createVNode"])(o,{uicontrol:"select",name:"sampleLimit","model-value":e.siteHsr.sample_limit,"onUpdate:modelValue":t[1]||(t[1]=t=>{e.siteHsr.sample_limit=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_HeatmapSampleLimit"),options:e.sampleLimits,"inline-help":e.translate("HeatmapSessionRecording_HeatmapSampleLimitHelp")},null,8,["model-value","title","options","inline-help"])]),Object(s["createElementVNode"])("div",$t,[Object(s["createElementVNode"])("div",Gt,[Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPage"))+":",1)]),Object(s["createElementVNode"])("div",Jt,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.siteHsr.match_page_rules,(a,i)=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{class:Object(s["normalizeClass"])(`matchPageRules ${i} multiple`),key:i},[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{"model-value":a,"onUpdate:modelValue":t=>e.setMatchPageRule(t,i),onAddUrl:t[2]||(t[2]=t=>e.addMatchPageRule()),onRemoveUrl:t=>e.removeMatchPageRule(i),onAnyChange:t[3]||(t[3]=t=>e.setValueHasChanged()),"allow-any":!1,"disable-if-no-value":i>0,"can-be-removed":i>0,"show-add-url":!0},null,8,["model-value","onUpdate:modelValue","onRemoveUrl","disable-if-no-value","can-be-removed"])]),Xt],2))),128))]),Object(s["createElementVNode"])("div",Yt,[Object(s["createElementVNode"])("div",Kt,[Object(s["createElementVNode"])("span",Qt,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_FieldIncludedTargetsHelp"))+" ",1),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c,{"included-targets":e.siteHsr.match_page_rules},null,8,["included-targets"])])])])])]),Object(s["createElementVNode"])("div",Zt,[Object(s["createVNode"])(o,{uicontrol:"select",name:"sampleRate","model-value":e.siteHsr.sample_rate,"onUpdate:modelValue":t[4]||(t[4]=t=>{e.siteHsr.sample_rate=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SampleRate"),options:e.sampleRates,introduction:e.translate("HeatmapSessionRecording_AdvancedOptions"),"inline-help":e.translate("HeatmapSessionRecording_HeatmapSampleRateHelp")},null,8,["model-value","title","options","introduction","inline-help"])]),Object(s["createElementVNode"])("div",ea,[Object(s["createVNode"])(o,{uicontrol:"text",name:"excludedElements","model-value":e.siteHsr.excluded_elements,"onUpdate:modelValue":t[5]||(t[5]=t=>{e.siteHsr.excluded_elements=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_ExcludedElements"),maxlength:1e3,"inline-help":e.translate("HeatmapSessionRecording_ExcludedElementsHelp")},null,8,["model-value","title","inline-help"])]),Object(s["createElementVNode"])("div",ta,[Object(s["createVNode"])(o,{uicontrol:"text",name:"screenshotUrl","model-value":e.siteHsr.screenshot_url,"onUpdate:modelValue":t[6]||(t[6]=t=>{e.siteHsr.screenshot_url=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_ScreenshotUrl"),maxlength:300,disabled:!!e.siteHsr.page_treemirror,"inline-help":e.translate("HeatmapSessionRecording_ScreenshotUrlHelp")},null,8,["model-value","title","disabled","inline-help"])]),Object(s["createElementVNode"])("div",aa,[Object(s["createVNode"])(o,{uicontrol:"text",name:"breakpointMobile","model-value":e.siteHsr.breakpoint_mobile,"onUpdate:modelValue":t[7]||(t[7]=t=>{e.siteHsr.breakpoint_mobile=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_BreakpointX",e.translate("General_Mobile")),maxlength:4,"inline-help":e.breakpointMobileInlineHelp},null,8,["model-value","title","inline-help"])]),Object(s["createElementVNode"])("div",ia,[Object(s["createVNode"])(o,{uicontrol:"text",name:"breakpointTablet","model-value":e.siteHsr.breakpoint_tablet,"onUpdate:modelValue":t[8]||(t[8]=t=>{e.siteHsr.breakpoint_tablet=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_BreakpointX",e.translate("DevicesDetection_Tablet")),maxlength:4,"inline-help":e.breakpointGeneralHelp},null,8,["model-value","title","inline-help"])]),Object(s["createElementVNode"])("div",na,[Object(s["createVNode"])(o,{uicontrol:"checkbox",name:"capture_manually",title:e.translate("HeatmapSessionRecording_CaptureDomTitle"),"inline-help":e.captureDomInlineHelp,"model-value":e.siteHsr.capture_manually,"onUpdate:modelValue":t[9]||(t[9]=t=>{e.siteHsr.capture_manually=t,e.setValueHasChanged()})},null,8,["title","inline-help","model-value"])]),Object(s["createElementVNode"])("p",{innerHTML:e.$sanitize(e.personalInformationNote)},null,8,sa),Object(s["createVNode"])(d,{class:"createButton",onConfirm:t[10]||(t[10]=t=>e.edit?e.updateHsr():e.createHsr()),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),Object(s["createElementVNode"])("div",ra,[Object(s["createElementVNode"])("a",{onClick:t[11]||(t[11]=t=>e.cancel())},Object(s["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]),_:1},8,["content-title"])}function la(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */class ca{constructor(e){la(this,"context",void 0),la(this,"privateState",Object(s["reactive"])({allHsrs:[],isLoading:!1,isUpdating:!1,filterStatus:""})),la(this,"state",Object(s["computed"])(()=>Object(s["readonly"])(this.privateState))),la(this,"hsrs",Object(s["computed"])(()=>this.privateState.filterStatus?this.state.value.allHsrs.filter(e=>e.status===this.privateState.filterStatus):this.state.value.allHsrs)),la(this,"hsrsCloned",Object(s["computed"])(()=>Object(B["clone"])(this.hsrs.value))),la(this,"statusOptions",Object(s["readonly"])([{key:"",value:Object(B["translate"])("General_All")},{key:"active",value:Object(B["translate"])("HeatmapSessionRecording_StatusActive")},{key:"ended",value:Object(B["translate"])("HeatmapSessionRecording_StatusEnded")},{key:"paused",value:Object(B["translate"])("HeatmapSessionRecording_StatusPaused")}])),la(this,"fetchPromises",{}),this.context=e}setFilterStatus(e){this.privateState.filterStatus=e}reload(){return this.privateState.allHsrs=[],this.fetchPromises={},this.fetchHsrs()}filterRules(e){return e.filter(e=>!!e&&(e.value||"any"===e.type))}getApiMethodInContext(e){return`${e}${this.context}`}fetchHsrs(){let e="HeatmapSessionRecording.getHeatmaps";"SessionRecording"===this.context&&(e="HeatmapSessionRecording.getSessionRecordings");const t={method:e,filter_limit:"-1"};return this.fetchPromises[e]||(this.fetchPromises[e]=B["AjaxHelper"].fetch(t)),this.privateState.isLoading=!0,this.privateState.allHsrs=[],this.fetchPromises[e].then(e=>(this.privateState.allHsrs=e,this.state.value.allHsrs)).finally(()=>{this.privateState.isLoading=!1})}findHsr(e){const t=this.state.value.allHsrs.find(t=>t.idsitehsr===e);return t?Promise.resolve(t):(this.privateState.isLoading=!0,B["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.get"),filter_limit:"-1"}).finally(()=>{this.privateState.isLoading=!1}))}deleteHsr(e){return this.privateState.isUpdating=!0,this.privateState.allHsrs=[],B["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.delete")},{withTokenInUrl:!0}).then(()=>({type:"success"})).catch(e=>({type:"error",message:e.message||e})).finally(()=>{this.privateState.isUpdating=!1})}completeHsr(e){return this.privateState.isUpdating=!0,this.privateState.allHsrs=[],B["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.end")},{withTokenInUrl:!0}).then(()=>({type:"success"})).catch(e=>({type:"error",message:e.message||e})).finally(()=>{this.privateState.isUpdating=!1})}createOrUpdateHsr(e,t){const a={idSiteHsr:e.idsitehsr,sampleLimit:e.sample_limit,sampleRate:e.sample_rate,excludedElements:e.excluded_elements?e.excluded_elements.trim():void 0,screenshotUrl:e.screenshot_url?e.screenshot_url.trim():void 0,breakpointMobile:e.breakpoint_mobile,breakpointTablet:e.breakpoint_tablet,minSessionTime:e.min_session_time,requiresActivity:e.requires_activity?1:0,captureKeystrokes:e.capture_keystrokes?1:0,captureDomManually:e.capture_manually?1:0,method:t,name:e.name.trim()},i={matchPageRules:this.filterRules(e.match_page_rules)};return this.privateState.isUpdating=!0,B["AjaxHelper"].post(a,i,{withTokenInUrl:!0}).then(e=>({type:"success",response:e})).catch(e=>({type:"error",message:e.message||e})).finally(()=>{this.privateState.isUpdating=!1})}}const da=new ca("Heatmap"),ma=new ca("SessionRecording"),pa="hsrmanagement";var ua=Object(s["defineComponent"])({props:{idSiteHsr:Number,breakpointMobile:Number,breakpointTablet:Number},components:{ContentBlock:B["ContentBlock"],Field:U["Field"],HsrUrlTarget:Ut,HsrTargetTest:Vt,SaveButton:U["SaveButton"]},data(){return{isDirty:!1,showAdvancedView:!1,siteHsr:{}}},created(){this.init()},watch:{idSiteHsr(e){null!==e&&this.init()}},methods:{removeAnyHsrNotification(){B["NotificationsStore"].remove(pa),B["NotificationsStore"].remove("ajaxHelper")},showNotification(e,t){const a=B["NotificationsStore"].show({message:e,context:t,id:pa,type:"transient"});setTimeout(()=>{B["NotificationsStore"].scrollToNotification(a)},200)},showErrorFieldNotProvidedNotification(e){const t=Object(B["translate"])("HeatmapSessionRecording_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init(){const{idSiteHsr:e}=this;if(this.siteHsr={},this.showAdvancedView=!1,B["Matomo"].helper.lazyScrollToContent(),this.edit&&e)da.findHsr(e).then(e=>{e&&(this.siteHsr=Object(B["clone"])(e),this.siteHsr.sample_rate=""+this.siteHsr.sample_rate,this.addInitialMatchPageRule(),this.isDirty=!1)});else if(this.create){this.siteHsr={idSite:B["Matomo"].idSite,name:"",sample_rate:"10.0",sample_limit:1e3,breakpoint_mobile:this.breakpointMobile,breakpoint_tablet:this.breakpointTablet,capture_manually:0},this.isDirty=!1;const e=B["MatomoUrl"].hashParsed.value;if(e.name&&(this.siteHsr.name=e.name,this.isDirty=!0),e.matchPageRules)try{this.siteHsr.match_page_rules=JSON.parse(e.matchPageRules),this.isDirty=!0}catch(t){console.log("warning: could not parse matchPageRules query param, expected JSON")}else this.addInitialMatchPageRule()}},addInitialMatchPageRule(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||this.addMatchPageRule())},addMatchPageRule(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[]),this.siteHsr.match_page_rules.push({attribute:"url",type:"equals_simple",value:"",inverted:0}),this.isDirty=!0)},removeMatchPageRule(e){this.siteHsr&&e>-1&&(this.siteHsr.match_page_rules=[...this.siteHsr.match_page_rules],this.siteHsr.match_page_rules.splice(e,1),this.isDirty=!0)},cancel(){const e=Object.assign({},B["MatomoUrl"].hashParsed.value);delete e.idSiteHsr,B["MatomoUrl"].updateHash(e)},createHsr(){this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&da.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.addHeatmap").then(e=>{if(!e||"error"===e.type||!e.response)return;this.isDirty=!1;const t=e.response.value;da.reload().then(()=>{B["Matomo"].helper.isReportingPage()&&B["Matomo"].postEvent("updateReportingMenu"),B["MatomoUrl"].updateHash(Object.assign(Object.assign({},B["MatomoUrl"].hashParsed.value),{},{idSiteHsr:t})),setTimeout(()=>{this.showNotification(Object(B["translate"])("HeatmapSessionRecording_HeatmapCreated"),e.type)},200)})})},setValueHasChanged(){this.isDirty=!0},updateHsr(){this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&da.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.updateHeatmap").then(e=>{"error"!==e.type&&(this.isDirty=!1,this.siteHsr={},da.reload().then(()=>{this.init()}),this.showNotification(Object(B["translate"])("HeatmapSessionRecording_HeatmapUpdated"),e.type))})},checkRequiredFieldsAreSet(){var e;if(!this.siteHsr.name){const e=Object(B["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}if(null===(e=this.siteHsr.match_page_rules)||void 0===e||!e.length||!da.filterRules(this.siteHsr.match_page_rules).length){const e=Object(B["translate"])("HeatmapSessionRecording_ErrorPageRuleRequired");return this.showNotification(e,"error"),!1}return!0},setMatchPageRule(e,t){this.siteHsr.match_page_rules=[...this.siteHsr.match_page_rules],this.siteHsr.match_page_rules[t]=e}},computed:{sampleLimits(){return[1e3,2e3,5e3].map(e=>({key:""+e,value:e}))},sampleRates(){const e=[.1,.5,1,2,3,4,5,6,8,10,15,20,30,40,50,60,70,80,90,100];return e.map(e=>({key:e.toFixed(1),value:e+"%"}))},create(){return!this.idSiteHsr},edit(){return!this.create},editTitle(){const e=this.create?"HeatmapSessionRecording_CreateNewHeatmap":"HeatmapSessionRecording_EditHeatmapX";return e},contentTitle(){return Object(B["translate"])(this.editTitle,this.siteHsr.name?`"${this.siteHsr.name}"`:"")},isLoading(){return da.state.value.isLoading},isUpdating(){return da.state.value.isUpdating},breakpointMobileInlineHelp(){const e=Object(B["translate"])("HeatmapSessionRecording_BreakpointGeneralHelp"),t=Object(B["translate"])("HeatmapSessionRecording_BreakpointGeneralHelpManage");return`${e} ${t}`},breakpointGeneralHelp(){const e=Object(B["translate"])("HeatmapSessionRecording_BreakpointGeneralHelp"),t=Object(B["translate"])("HeatmapSessionRecording_BreakpointGeneralHelpManage");return`${e} ${t}`},captureDomInlineHelp(){const e=this.idSiteHsr?this.idSiteHsr:"{idHeatmap}",t=`<br><br><strong>_paq.push(['HeatmapSessionRecording::captureInitialDom', ${e}])</strong>`;return Object(B["translate"])("HeatmapSessionRecording_CaptureDomInlineHelp",t,"<br><br><strong>","</strong>")},personalInformationNote(){const e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-content-on-your-website";return Object(B["translate"])("HeatmapSessionRecording_PersonalInformationNote",Object(B["translate"])("HeatmapSessionRecording_Heatmap"),"<code>","</code>",`<a href="${e}" target="_blank" rel="noreferrer noopener">`,"</a>")},saveButtonText(){return this.edit?Object(B["translate"])("CoreUpdater_UpdateTitle"):Object(B["translate"])("HeatmapSessionRecording_CreateNewHeatmap")}}});ua.render=oa;var ha=ua;const ga={class:"heatmapList"},ba={class:"filterStatus"},va={class:"hsrSearchFilter",style:{"margin-left":"3.5px"}},Oa={class:"index"},ja={class:"name"},fa={class:"creationDate"},ya={class:"sampleLimit"},Sa={class:"status"},Ha={class:"action"},_a={colspan:"7"},Ea={class:"loadingPiwik"},Va=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Na={colspan:"7"},Ra=["id"],wa={class:"index"},ka={class:"name"},xa={class:"creationDate"},Ca={class:"sampleLimit"},Da={key:0,class:"status status-paused"},Ta=["title"],Ma={key:1,class:"status"},Pa=["title","onClick"],Aa=["title","onClick"],Ba=["title","href"],Ua=["title","onClick"],Fa={class:"tableActionBar"},La=Object(s["createElementVNode"])("span",{class:"icon-add"},null,-1),Ia={class:"ui-confirm",id:"confirmDeleteHeatmap",ref:"confirmDeleteHeatmap"},Wa=["value"],qa=["value"],za={class:"ui-confirm",id:"confirmEndHeatmap",ref:"confirmEndHeatmap"},$a=["value"],Ga=["value"];function Ja(e,t,a,i,n,r){const o=Object(s["resolveComponent"])("Field"),l=Object(s["resolveComponent"])("EntityDuplicatorAction"),c=Object(s["resolveComponent"])("ContentBlock"),d=Object(s["resolveComponent"])("EntityDuplicatorModal"),m=Object(s["resolveDirective"])("content-table");return Object(s["openBlock"])(),Object(s["createElementBlock"])(s["Fragment"],null,[Object(s["createElementVNode"])("div",ga,[Object(s["createVNode"])(c,{"content-title":e.translate("HeatmapSessionRecording_ManageHeatmaps")},{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapUsageBenefits")),1),Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("div",ba,[Object(s["createVNode"])(o,{uicontrol:"select",name:"filterStatus","model-value":e.filterStatus,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.setFilterStatus(t)}),title:e.translate("HeatmapSessionRecording_Filter"),"full-width":!0,options:e.statusOptions},null,8,["model-value","title","options"])]),Object(s["createElementVNode"])("div",va,[Object(s["withDirectives"])(Object(s["createVNode"])(o,{uicontrol:"text",name:"hsrSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[1]||(t[1]=t=>e.searchFilter=t),"full-width":!0},null,8,["title","modelValue"]),[[s["vShow"],e.hsrs.length>0]])])]),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("table",null,[Object(s["createElementVNode"])("thead",null,[Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("th",Oa,Object(s["toDisplayString"])(e.translate("General_Id")),1),Object(s["createElementVNode"])("th",ja,Object(s["toDisplayString"])(e.translate("General_Name")),1),Object(s["createElementVNode"])("th",fa,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_CreationDate")),1),Object(s["createElementVNode"])("th",ya,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_SampleLimit")),1),Object(s["createElementVNode"])("th",Sa,Object(s["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(s["createElementVNode"])("th",Ha,Object(s["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(s["createElementVNode"])("tbody",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("td",_a,[Object(s["createElementVNode"])("span",Ea,[Va,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[s["vShow"],e.isLoading||e.isUpdating]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("td",Na,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_NoHeatmapsFound")),1)],512),[[s["vShow"],!e.isLoading&&0===e.hsrs.length]]),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.sortedHsrs,t=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{id:"hsr"+t.idsitehsr,class:"hsrs",key:t.idsitehsr},[Object(s["createElementVNode"])("td",wa,Object(s["toDisplayString"])(t.idsitehsr),1),Object(s["createElementVNode"])("td",ka,Object(s["toDisplayString"])(t.name),1),Object(s["createElementVNode"])("td",xa,Object(s["toDisplayString"])(t.created_date_pretty),1),Object(s["createElementVNode"])("td",Ca,Object(s["toDisplayString"])(t.sample_limit),1),"paused"===t.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("td",Da,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.ucfirst(t.status))+" ",1),Object(s["createElementVNode"])("span",{class:"icon icon-help",title:e.pauseReason},null,8,Ta)])):(Object(s["openBlock"])(),Object(s["createElementBlock"])("td",Ma,Object(s["toDisplayString"])(e.ucfirst(t.status)),1)),Object(s["createElementVNode"])("td",{class:Object(s["normalizeClass"])({action:!0,"duplicate-available":e.isEntityDuplicatorAvailable})},[Object(s["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("HeatmapSessionRecording_EditX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:a=>e.editHsr(t.idsitehsr)},null,8,Pa),Object(s["withDirectives"])(Object(s["createElementVNode"])("a",{class:"table-action stopRecording icon-drop-crossed",title:e.translate("HeatmapSessionRecording_StopX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:a=>e.completeHsr(t)},null,8,Aa),[[s["vShow"],"ended"!==t.status]]),Object(s["createElementVNode"])("a",{target:"_blank",class:"table-action icon-show",title:e.translate("HeatmapSessionRecording_ViewReport"),href:e.getViewReportLink(t)},null,8,Ba),Object(s["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("HeatmapSessionRecording_DeleteX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:a=>e.deleteHsr(t)},null,8,Ua),Object(s["createVNode"])(l,{actionFormData:{idSiteHsr:t.idsitehsr},modalStore:e.entityDuplicatorStore,isActionVisible:e.showDuplicatorAction,isActionEnabled:e.enableDuplicatorAction,tooltipTextOverrideDisabled:e.translate("HeatmapSessionRecording_QuotaReachedForX",e.translate("HeatmapSessionRecording_Heatmap"),e.translate("HeatmapSessionRecording_Heatmaps")),extraClasses:["heatmap-duplicate-action","hsr-"+t.idsitehsr]},null,8,["actionFormData","modalStore","isActionVisible","isActionEnabled","tooltipTextOverrideDisabled","extraClasses"])],2)],8,Ra))),128))])])),[[m]]),Object(s["createElementVNode"])("div",Fa,[Object(s["createElementVNode"])("a",{class:"createNewHsr",value:"",onClick:t[2]||(t[2]=t=>e.createHsr())},[La,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_CreateNewHeatmap")),1)])])]),_:1},8,["content-title"]),Object(s["createElementVNode"])("div",Ia,[Object(s["createElementVNode"])("h2",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteHeatmapConfirm")),1),Object(s["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Wa),Object(s["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,qa)],512),Object(s["createElementVNode"])("div",za,[Object(s["createElementVNode"])("h2",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_EndHeatmapConfirm")),1),Object(s["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,$a),Object(s["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Ga)],512)]),Object(s["createVNode"])(d,{modalStore:e.entityDuplicatorStore},null,8,["modalStore"])],64)}const Xa=Object(B["useExternalPluginComponent"])("CoreHome","EntityDuplicatorModal"),Ya=Object(B["useExternalPluginComponent"])("CoreHome","EntityDuplicatorAction");let Ka=void 0;Object(B["importPluginUmd"])("CoreHome").then(e=>{Ka=null===e||void 0===e?void 0:e.EntityDuplicatorStore});var Qa=Object(s["defineComponent"])({props:{pauseReason:String},components:{ContentBlock:B["ContentBlock"],Field:U["Field"],EntityDuplicatorModal:Xa,EntityDuplicatorAction:Ya},directives:{ContentTable:B["ContentTable"]},data(){return{searchFilter:"",showDuplicatorAction:!0,enableDuplicatorAction:!1,entityDuplicatorStore:"undefined"!==typeof Ka?Ka.buildStoreInstance("HeatmapSessionRecording_Heatmap",{method:"HeatmapSessionRecording.duplicateHeatmap",requiredFields:["idSite","idDestinationSites","idSiteHsr"]}):void 0}},created(){da.setFilterStatus(""),da.fetchHsrs()},mounted(){if(this.checkIsAddingHeatmapAllowed(),this.entityDuplicatorStore){const e=this.entityDuplicatorStore.adapter;e.onSuccessCallback=e=>new Promise(t=>{var a,i,n;const s=null===(a=e.additionalData)||void 0===a?void 0:a.idSite;return null!==(i=e.additionalData)&&void 0!==i&&i.idSite&&Array.isArray(null===(n=e.additionalData)||void 0===n?void 0:n.idDestinationSites)&&!e.additionalData.idDestinationSites.some(e=>+e===+s)?t():da.reload().then(()=>t())})}},methods:{createHsr(){this.editHsr(0)},editHsr(e){B["MatomoUrl"].updateHash(Object.assign(Object.assign({},B["MatomoUrl"].hashParsed.value),{},{idSiteHsr:e}))},deleteHsr(e){B["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteHeatmap,{yes:()=>{da.deleteHsr(e.idsitehsr).then(()=>{da.reload(),B["Matomo"].postEvent("updateReportingMenu")})}})},completeHsr(e){B["Matomo"].helper.modalConfirm(this.$refs.confirmEndHeatmap,{yes:()=>{da.completeHsr(e.idsitehsr).then(()=>{da.reload()})}})},setFilterStatus(e){da.setFilterStatus(e)},ucfirst(e){return`${e[0].toUpperCase()}${e.substr(1)}`},getViewReportLink(e){return"?"+B["MatomoUrl"].stringify({module:"Widgetize",action:"iframe",moduleToWidgetize:"HeatmapSessionRecording",actionToWidgetize:"showHeatmap",idSiteHsr:e.idsitehsr,idSite:e.idsite,period:"day",date:"yesterday"})},checkIsAddingHeatmapAllowed(){const e={isAllowed:!0};return B["Matomo"].postEvent("HeatmapSessionRecording.initAddHeatmap",e),this.enableDuplicatorAction=e&&!0===e.isAllowed,!this.enableDuplicatorAction}},computed:{filterStatus(){return da.state.value.filterStatus},statusOptions(){return da.statusOptions},hsrs(){return da.hsrs.value},isLoading(){return da.state.value.isLoading},isUpdating(){return da.state.value.isUpdating},sortedHsrs(){const e=[...this.hsrs].filter(e=>Object.keys(e).some(t=>{const a=e;return"string"===typeof a[t]&&-1!==a[t].indexOf(this.searchFilter)}));return e.sort((e,t)=>t.idsitehsr-e.idsitehsr),e},isEntityDuplicatorAvailable(){return"undefined"!==typeof Ka}}});Qa.render=Ja;var Za=Qa;const ei={class:"manageHsr",ref:"root"},ti={key:0},ai={key:1};function ii(e,t,a,i,n,r){const o=Object(s["resolveComponent"])("MatomoJsNotWritableAlert"),l=Object(s["resolveComponent"])("HeatmapList"),c=Object(s["resolveComponent"])("HeatmapEdit");return Object(s["openBlock"])(),Object(s["createElementBlock"])(s["Fragment"],null,[e.editMode?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createBlock"])(o,{key:0,"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_Heatmaps")},null,8,["is-matomo-js-writable","recording-type"])),Object(s["createElementVNode"])("div",ei,[e.editMode?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",ti,[Object(s["createVNode"])(l,{"pause-reason":e.pauseReason},null,8,["pause-reason"])])),e.editMode?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",ai,[Object(s["createVNode"])(c,{"breakpoint-mobile":e.breakpointMobile,"breakpoint-tablet":e.breakpointTablet,"id-site-hsr":e.idSiteHsr},null,8,["breakpoint-mobile","breakpoint-tablet","id-site-hsr"])])):Object(s["createCommentVNode"])("",!0)],512)],64)}const ni=["innerHTML"];function si(e,t,a,i,n,r){return e.isMatomoJsWritable?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{key:0,class:"alert alert-warning",innerHTML:e.getJsNotWritableErrorMessage()},null,8,ni))}var ri=Object(s["defineComponent"])({props:{recordingType:{type:String,required:!0},isMatomoJsWritable:{type:Boolean,required:!0}},methods:{getJsNotWritableErrorMessage(){return Object(B["translate"])("HeatmapSessionRecording_MatomoJSNotWritableErrorMessage",this.recordingType,'<a href="https://developer.matomo.org/guides/heatmap-session-recording/setup#when-the-matomojs-in-your-piwik-directory-file-is-not-writable" target="_blank" rel="noreferrer noopener">',"</a>")}}});ri.render=si;var oi=ri;const{$:li}=window;var ci=Object(s["defineComponent"])({props:{breakpointMobile:Number,breakpointTablet:Number,pauseReason:String,isMatomoJsWritable:{type:Boolean,required:!0}},data(){return{editMode:!1,idSiteHsr:null}},components:{MatomoJsNotWritableAlert:oi,HeatmapList:Za,HeatmapEdit:ha},watch:{editMode(){li(".ui-tooltip").remove()}},created(){Object(s["watch"])(()=>B["MatomoUrl"].hashParsed.value.idSiteHsr,e=>{this.initState(e)}),this.initState(B["MatomoUrl"].hashParsed.value.idSiteHsr)},methods:{removeAnyHsrNotification(){B["NotificationsStore"].remove("hsrmanagement")},initState(e){if(e){if("0"===e){const e={isAllowed:!0};if(B["Matomo"].postEvent("HeatmapSessionRecording.initAddHeatmap",e),e&&!e.isAllowed)return this.editMode=!1,void(this.idSiteHsr=null)}this.editMode=!0,this.idSiteHsr=parseInt(e,10)}else this.editMode=!1,this.idSiteHsr=null;this.removeAnyHsrNotification()}}});ci.render=ii;var di=ci;const mi={class:"loadingPiwik"},pi=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),ui={class:"loadingPiwik"},hi=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),gi={name:"name"},bi={name:"sampleLimit"},vi={class:"form-group row"},Oi={class:"col s12"},ji={class:"col s12 m6",style:{"padding-left":"0"}},fi=Object(s["createElementVNode"])("hr",null,null,-1),yi={class:"col s12 m6"},Si={class:"form-help"},Hi={class:"inline-help"},_i={name:"sampleRate"},Ei={name:"minSessionTime"},Vi={name:"requiresActivity"},Ni={class:"inline-help-node"},Ri=["innerHTML"],wi=["innerHTML"],ki={class:"entityCancel"};function xi(e,t,a,i,n,r){const o=Object(s["resolveComponent"])("Field"),l=Object(s["resolveComponent"])("HsrUrlTarget"),c=Object(s["resolveComponent"])("HsrTargetTest"),d=Object(s["resolveComponent"])("SaveButton"),m=Object(s["resolveComponent"])("ContentBlock");return Object(s["openBlock"])(),Object(s["createBlock"])(m,{class:"editHsr","content-title":e.contentTitle},{default:Object(s["withCtx"])(()=>[Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",mi,[pi,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[s["vShow"],e.isLoading]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("p",null,[Object(s["createElementVNode"])("span",ui,[hi,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_UpdatingData")),1)])],512),[[s["vShow"],e.isUpdating]]),Object(s["createElementVNode"])("form",{onSubmit:t[10]||(t[10]=t=>e.edit?e.updateHsr():e.createHsr())},[Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("div",gi,[Object(s["createVNode"])(o,{uicontrol:"text",name:"name","model-value":e.siteHsr.name,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.siteHsr.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,placeholder:e.translate("HeatmapSessionRecording_FieldNamePlaceholder"),"inline-help":e.translate("HeatmapSessionRecording_SessionNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(s["createElementVNode"])("div",bi,[Object(s["createVNode"])(o,{uicontrol:"select",name:"sampleLimit","model-value":e.siteHsr.sample_limit,"onUpdate:modelValue":t[1]||(t[1]=t=>{e.siteHsr.sample_limit=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SessionSampleLimit"),options:e.sampleLimits,"inline-help":e.translate("HeatmapSessionRecording_SessionSampleLimitHelp")},null,8,["model-value","title","options","inline-help"])]),Object(s["createElementVNode"])("div",vi,[Object(s["createElementVNode"])("div",Oi,[Object(s["createElementVNode"])("h3",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPages"))+":",1)]),Object(s["createElementVNode"])("div",ji,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.siteHsr.match_page_rules,(a,i)=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",{class:Object(s["normalizeClass"])(`matchPageRules ${i} multiple`),key:i},[Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{"model-value":a,"onUpdate:modelValue":t=>e.setMatchPageRule(t,i),onAddUrl:t[2]||(t[2]=t=>e.addMatchPageRule()),onRemoveUrl:t=>e.removeMatchPageRule(i),onAnyChange:t[3]||(t[3]=t=>e.setValueHasChanged()),"allow-any":!0,"disable-if-no-value":i>0,"can-be-removed":i>0,"show-add-url":!0},null,8,["model-value","onUpdate:modelValue","onRemoveUrl","disable-if-no-value","can-be-removed"])]),fi],2))),128))]),Object(s["createElementVNode"])("div",yi,[Object(s["createElementVNode"])("div",Si,[Object(s["createElementVNode"])("span",Hi,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_FieldIncludedTargetsHelpSessions"))+" ",1),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c,{"included-targets":e.siteHsr.match_page_rules},null,8,["included-targets"])])])])])]),Object(s["createElementVNode"])("div",_i,[Object(s["createVNode"])(o,{uicontrol:"select",name:"sampleRate","model-value":e.siteHsr.sample_rate,"onUpdate:modelValue":t[4]||(t[4]=t=>{e.siteHsr.sample_rate=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SampleRate"),options:e.sampleRates,introduction:e.translate("HeatmapSessionRecording_AdvancedOptions"),"inline-help":e.translate("HeatmapSessionRecording_SessionSampleRateHelp")},null,8,["model-value","title","options","introduction","inline-help"])]),Object(s["createElementVNode"])("div",Ei,[Object(s["createVNode"])(o,{uicontrol:"select",name:"minSessionTime","model-value":e.siteHsr.min_session_time,"onUpdate:modelValue":t[5]||(t[5]=t=>{e.siteHsr.min_session_time=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_MinSessionTime"),options:e.minSessionTimes,"inline-help":e.translate("HeatmapSessionRecording_MinSessionTimeHelp")},null,8,["model-value","title","options","inline-help"])]),Object(s["createElementVNode"])("div",Vi,[Object(s["createVNode"])(o,{uicontrol:"checkbox",name:"requiresActivity","model-value":e.siteHsr.requires_activity,"onUpdate:modelValue":t[6]||(t[6]=t=>{e.siteHsr.requires_activity=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_RequiresActivity"),"inline-help":e.translate("HeatmapSessionRecording_RequiresActivityHelp")},null,8,["model-value","title","inline-help"])]),Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(o,{uicontrol:"checkbox",name:"captureKeystrokes","model-value":e.siteHsr.capture_keystrokes,"onUpdate:modelValue":t[7]||(t[7]=t=>{e.siteHsr.capture_keystrokes=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_CaptureKeystrokes")},{"inline-help":Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("div",Ni,[Object(s["createElementVNode"])("span",{innerHTML:e.$sanitize(e.captureKeystrokesHelp)},null,8,Ri)])]),_:1},8,["model-value","title"])]),Object(s["createElementVNode"])("p",{innerHTML:e.$sanitize(e.personalInformationNote)},null,8,wi),Object(s["createVNode"])(d,{class:"createButton",onConfirm:t[8]||(t[8]=t=>e.edit?e.updateHsr():e.createHsr()),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),Object(s["createElementVNode"])("div",ki,[Object(s["createElementVNode"])("a",{onClick:t[9]||(t[9]=t=>e.cancel())},Object(s["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]),_:1},8,["content-title"])}const Ci="hsrmanagement";var Di=Object(s["defineComponent"])({props:{idSiteHsr:Number},components:{ContentBlock:B["ContentBlock"],Field:U["Field"],HsrUrlTarget:Ut,HsrTargetTest:Vt,SaveButton:U["SaveButton"]},data(){return{isDirty:!1,showAdvancedView:!1,sampleLimits:[],siteHsr:{}}},created(){B["AjaxHelper"].fetch({method:"HeatmapSessionRecording.getAvailableSessionRecordingSampleLimits"}).then(e=>{this.sampleLimits=(e||[]).map(e=>({key:""+e,value:e}))}),this.init()},watch:{idSiteHsr(e){null!==e&&this.init()}},methods:{removeAnyHsrNotification(){B["NotificationsStore"].remove(Ci),B["NotificationsStore"].remove("ajaxHelper")},showNotification(e,t){const a=B["NotificationsStore"].show({message:e,context:t,id:Ci,type:"transient"});setTimeout(()=>{B["NotificationsStore"].scrollToNotification(a)},200)},showErrorFieldNotProvidedNotification(e){const t=Object(B["translate"])("HeatmapSessionRecording_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init(){const{idSiteHsr:e}=this;this.siteHsr={},this.showAdvancedView=!1,B["Matomo"].helper.lazyScrollToContent(),this.edit&&e?ma.findHsr(e).then(e=>{e&&(this.siteHsr=Object(B["clone"])(e),this.siteHsr.sample_rate=""+this.siteHsr.sample_rate,this.addInitialMatchPageRule(),this.isDirty=!1)}):this.create&&(this.siteHsr={idSite:B["Matomo"].idSite,name:"",sample_rate:"10.0",sample_limit:250,min_session_time:0,requires_activity:!0,capture_keystrokes:!1},this.addInitialMatchPageRule(),this.isDirty=!1)},addInitialMatchPageRule(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[{attribute:"url",type:"any",value:"",inverted:0}]))},addMatchPageRule(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[]),this.siteHsr.match_page_rules.push({attribute:"url",type:"equals_simple",value:"",inverted:0}),this.isDirty=!0)},removeMatchPageRule(e){this.siteHsr&&e>-1&&(this.siteHsr.match_page_rules=[...this.siteHsr.match_page_rules],this.siteHsr.match_page_rules.splice(e,1),this.isDirty=!0)},cancel(){const e=Object.assign({},B["MatomoUrl"].hashParsed.value);delete e.idSiteHsr,B["MatomoUrl"].updateHash(e)},createHsr(){this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&ma.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.addSessionRecording").then(e=>{if(!e||"error"===e.type||!e.response)return;this.isDirty=!1;const t=e.response.value;ma.reload().then(()=>{B["Matomo"].helper.isReportingPage()&&B["Matomo"].postEvent("updateReportingMenu"),B["MatomoUrl"].updateHash(Object.assign(Object.assign({},B["MatomoUrl"].hashParsed.value),{},{idSiteHsr:t})),setTimeout(()=>{this.showNotification(Object(B["translate"])("HeatmapSessionRecording_SessionRecordingCreated"),e.type)},200)})})},setValueHasChanged(){this.isDirty=!0},updateHsr(){this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&ma.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.updateSessionRecording").then(e=>{"error"!==e.type&&(this.isDirty=!1,this.siteHsr={},ma.reload().then(()=>{this.init()}),this.showNotification(Object(B["translate"])("HeatmapSessionRecording_SessionRecordingUpdated"),e.type))})},checkRequiredFieldsAreSet(){var e;if(!this.siteHsr.name){const e=this.translate("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}if(null===(e=this.siteHsr.match_page_rules)||void 0===e||!e.length||!ma.filterRules(this.siteHsr.match_page_rules).length){const e=this.translate("HeatmapSessionRecording_ErrorPageRuleRequired");return this.showNotification(e,"error"),!1}return!0},setMatchPageRule(e,t){this.siteHsr.match_page_rules=[...this.siteHsr.match_page_rules],this.siteHsr.match_page_rules[t]=e}},computed:{minSessionTimes(){return[0,5,10,15,20,30,45,60,90,120].map(e=>({key:""+e,value:e+" seconds"}))},sampleRates(){const e=[.1,.5,1,2,3,4,5,6,8,10,15,20,30,40,50,60,70,80,90,100];return e.map(e=>({key:""+e.toFixed(1),value:e+"%"}))},create(){return!this.idSiteHsr},edit(){return!this.create},editTitle(){const e=this.create?"HeatmapSessionRecording_CreateNewSessionRecording":"HeatmapSessionRecording_EditSessionRecordingX";return e},contentTitle(){return Object(B["translate"])(this.editTitle,this.siteHsr.name?`"${this.siteHsr.name}"`:"")},isLoading(){return da.state.value.isLoading},isUpdating(){return da.state.value.isUpdating},captureKeystrokesHelp(){const e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-keystrokes-in-form-fields";return Object(B["translate"])("HeatmapSessionRecording_CaptureKeystrokesHelp",`<a href="${e}" target="_blank" rel="noopener noreferrer">`,"</a>")},personalInformationNote(){const e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-content-on-your-website";return Object(B["translate"])("HeatmapSessionRecording_PersonalInformationNote",Object(B["translate"])("HeatmapSessionRecording_SessionRecording"),"<code>","</code>",`<a href="${e}" target="_blank" rel="noreferrer noopener">`,"</a>")},saveButtonText(){return this.edit?Object(B["translate"])("CoreUpdater_UpdateTitle"):Object(B["translate"])("HeatmapSessionRecording_CreateNewSessionRecording")}}});Di.render=xi;var Ti=Di;const Mi={class:"sessionRecordingList"},Pi={class:"filterStatus"},Ai={class:"hsrSearchFilter",style:{"margin-left":"3.5px"}},Bi={class:"index"},Ui={class:"name"},Fi={class:"creationDate"},Li={class:"sampleLimit"},Ii={class:"status"},Wi={class:"action"},qi={colspan:"7"},zi={class:"loadingPiwik"},$i=Object(s["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Gi={colspan:"7"},Ji=["id"],Xi={class:"index"},Yi={class:"name"},Ki={class:"creationDate"},Qi={class:"sampleLimit"},Zi={key:0,class:"status status-paused"},en=["title"],tn={key:1,class:"status"},an={class:"action"},nn=["title","onClick"],sn=["title","onClick"],rn=["title","href"],on=["title","onClick"],ln={class:"tableActionBar"},cn=Object(s["createElementVNode"])("span",{class:"icon-add"},null,-1),dn={class:"ui-confirm",ref:"confirmDeleteSessionRecording"},mn=["value"],pn=["value"],un={class:"ui-confirm",ref:"confirmEndSessionRecording"},hn=["value"],gn=["value"];function bn(e,t,a,i,n,r){const o=Object(s["resolveComponent"])("Field"),l=Object(s["resolveComponent"])("ContentBlock"),c=Object(s["resolveDirective"])("content-table");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Mi,[Object(s["createVNode"])(l,{"content-title":e.translate("HeatmapSessionRecording_ManageSessionRecordings")},{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("p",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_SessionRecordingsUsageBenefits")),1),Object(s["createElementVNode"])("div",null,[Object(s["createElementVNode"])("div",Pi,[Object(s["createVNode"])(o,{uicontrol:"select",name:"filterStatus","model-value":e.filterStatus,"onUpdate:modelValue":t[0]||(t[0]=t=>{e.setFilterStatus(t)}),title:e.translate("HeatmapSessionRecording_Filter"),"full-width":!0,options:e.statusOptions},null,8,["model-value","title","options"])]),Object(s["createElementVNode"])("div",Ai,[Object(s["withDirectives"])(Object(s["createVNode"])(o,{uicontrol:"text",name:"hsrSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[1]||(t[1]=t=>e.searchFilter=t),"full-width":!0},null,8,["title","modelValue"]),[[s["vShow"],e.hsrs.length>0]])])]),Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("table",null,[Object(s["createElementVNode"])("thead",null,[Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("th",Bi,Object(s["toDisplayString"])(e.translate("General_Id")),1),Object(s["createElementVNode"])("th",Ui,Object(s["toDisplayString"])(e.translate("General_Name")),1),Object(s["createElementVNode"])("th",Fi,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_CreationDate")),1),Object(s["createElementVNode"])("th",Li,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_SampleLimit")),1),Object(s["createElementVNode"])("th",Ii,Object(s["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(s["createElementVNode"])("th",Wi,Object(s["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(s["createElementVNode"])("tbody",null,[Object(s["withDirectives"])(Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("td",qi,[Object(s["createElementVNode"])("span",zi,[$i,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[s["vShow"],e.isLoading||e.isUpdating]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("td",Gi,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_NoSessionRecordingsFound")),1)],512),[[s["vShow"],!e.isLoading&&0==e.hsrs.length]]),(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.sortedHsrs,t=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{id:"hsr"+t.idsitehsr,class:"hsrs",key:t.idsitehsr},[Object(s["createElementVNode"])("td",Xi,Object(s["toDisplayString"])(t.idsitehsr),1),Object(s["createElementVNode"])("td",Yi,Object(s["toDisplayString"])(t.name),1),Object(s["createElementVNode"])("td",Ki,Object(s["toDisplayString"])(t.created_date_pretty),1),Object(s["createElementVNode"])("td",Qi,Object(s["toDisplayString"])(t.sample_limit),1),"paused"===t.status?(Object(s["openBlock"])(),Object(s["createElementBlock"])("td",Zi,[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.ucfirst(t.status))+" ",1),Object(s["createElementVNode"])("span",{class:"icon icon-help",title:e.pauseReason},null,8,en)])):(Object(s["openBlock"])(),Object(s["createElementBlock"])("td",tn,Object(s["toDisplayString"])(e.ucfirst(t.status)),1)),Object(s["createElementVNode"])("td",an,[Object(s["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("HeatmapSessionRecording_EditX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:a=>e.editHsr(t.idsitehsr)},null,8,nn),Object(s["withDirectives"])(Object(s["createElementVNode"])("a",{class:"table-action stopRecording icon-drop-crossed",title:e.translate("HeatmapSessionRecording_StopX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:a=>e.completeHsr(t)},null,8,sn),[[s["vShow"],"ended"!==t.status]]),Object(s["createElementVNode"])("a",{class:"table-action icon-show",title:e.translate("HeatmapSessionRecording_ViewReport"),href:e.getViewReportLink(t),target:"_blank"},null,8,rn),Object(s["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("HeatmapSessionRecording_DeleteX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:a=>e.deleteHsr(t)},null,8,on)])],8,Ji))),128))])])),[[c]]),Object(s["createElementVNode"])("div",ln,[Object(s["createElementVNode"])("a",{class:"createNewHsr",value:"",onClick:t[2]||(t[2]=t=>e.createHsr())},[cn,Object(s["createTextVNode"])(" "+Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_CreateNewSessionRecording")),1)])])]),_:1},8,["content-title"]),Object(s["createElementVNode"])("div",dn,[Object(s["createElementVNode"])("h2",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteSessionRecordingConfirm")),1),Object(s["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,mn),Object(s["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,pn)],512),Object(s["createElementVNode"])("div",un,[Object(s["createElementVNode"])("h2",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_EndSessionRecordingConfirm")),1),Object(s["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,hn),Object(s["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,gn)],512)])}var vn=Object(s["defineComponent"])({props:{pauseReason:String},components:{ContentBlock:B["ContentBlock"],Field:U["Field"]},directives:{ContentTable:B["ContentTable"]},data(){return{searchFilter:""}},created(){ma.setFilterStatus(""),ma.fetchHsrs()},methods:{createHsr(){this.editHsr(0)},editHsr(e){B["MatomoUrl"].updateHash(Object.assign(Object.assign({},B["MatomoUrl"].hashParsed.value),{},{idSiteHsr:e}))},deleteHsr(e){B["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteSessionRecording,{yes:()=>{ma.deleteHsr(e.idsitehsr).then(()=>{ma.reload(),B["Matomo"].postEvent("updateReportingMenu")})}})},completeHsr(e){B["Matomo"].helper.modalConfirm(this.$refs.confirmEndSessionRecording,{yes:()=>{ma.completeHsr(e.idsitehsr).then(()=>{ma.reload()})}})},setFilterStatus(e){ma.setFilterStatus(e)},ucfirst(e){return`${e[0].toUpperCase()}${e.substr(1)}`},getViewReportLink(e){return`?${B["MatomoUrl"].stringify({module:"CoreHome",action:"index",idSite:e.idsite,period:"day",date:"yesterday"})}#?${B["MatomoUrl"].stringify({category:"HeatmapSessionRecording_SessionRecordings",idSite:e.idsite,period:"day",date:"yesterday",subcategory:e.idsitehsr})}`}},computed:{filterStatus(){return ma.state.value.filterStatus},statusOptions(){return ma.statusOptions},hsrs(){return ma.hsrs.value},isLoading(){return ma.state.value.isLoading},isUpdating(){return ma.state.value.isUpdating},sortedHsrs(){const e=[...this.hsrs].filter(e=>Object.keys(e).some(t=>{const a=e;return"string"===typeof a[t]&&-1!==a[t].indexOf(this.searchFilter)}));return e.sort((e,t)=>t.idsitehsr-e.idsitehsr),e}}});vn.render=bn;var On=vn;const jn={class:"manageHsr"};function fn(e,t,a,i,n,r){const o=Object(s["resolveComponent"])("MatomoJsNotWritableAlert"),l=Object(s["resolveComponent"])("SessionRecordingList"),c=Object(s["resolveComponent"])("SessionRecordingEdit");return Object(s["openBlock"])(),Object(s["createElementBlock"])(s["Fragment"],null,[e.editMode?Object(s["createCommentVNode"])("",!0):(Object(s["openBlock"])(),Object(s["createBlock"])(o,{key:0,"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_SessionRecordings")},null,8,["is-matomo-js-writable","recording-type"])),Object(s["createElementVNode"])("div",jn,[Object(s["withDirectives"])(Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(l,{"pause-reason":e.pauseReason},null,8,["pause-reason"])],512),[[s["vShow"],!e.editMode]]),Object(s["withDirectives"])(Object(s["createElementVNode"])("div",null,[Object(s["createVNode"])(c,{"id-site-hsr":e.idSiteHsr},null,8,["id-site-hsr"])],512),[[s["vShow"],e.editMode]])])],64)}var yn=Object(s["defineComponent"])({props:{pauseReason:String,isMatomoJsWritable:{type:Boolean,required:!0}},data(){return{editMode:!1,idSiteHsr:null}},components:{MatomoJsNotWritableAlert:oi,SessionRecordingEdit:Ti,SessionRecordingList:On},created(){Object(s["watch"])(()=>B["MatomoUrl"].hashParsed.value.idSiteHsr,e=>{this.initState(e)}),this.initState(B["MatomoUrl"].hashParsed.value.idSiteHsr)},methods:{removeAnyHsrNotification(){B["NotificationsStore"].remove("hsrmanagement")},initState(e){if(e){if("0"===e){const e={isAllowed:!0};if(B["Matomo"].postEvent("HeatmapSessionRecording.initAddSessionRecording",e),e&&!e.isAllowed)return this.editMode=!1,void(this.idSiteHsr=null)}this.editMode=!0,this.idSiteHsr=parseInt(e,10)}else this.editMode=!1,this.idSiteHsr=null;this.removeAnyHsrNotification()}}});yn.render=fn;var Sn=yn;const Hn={class:"ui-confirm",id:"listOfPageviews"},_n=Object(s["createElementVNode"])("br",null,null,-1),En=Object(s["createElementVNode"])("br",null,null,-1),Vn=["onClick"],Nn=["title"],Rn=["value"];function wn(e,t,a,i,n,r){const o=Object(s["resolveDirective"])("content-table");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Hn,[Object(s["createElementVNode"])("h2",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_PageviewsInVisit")),1),_n,En,Object(s["withDirectives"])((Object(s["openBlock"])(),Object(s["createElementBlock"])("table",null,[Object(s["createElementVNode"])("thead",null,[Object(s["createElementVNode"])("tr",null,[Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_ColumnTime")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("General_TimeOnPage")),1),Object(s["createElementVNode"])("th",null,Object(s["toDisplayString"])(e.translate("Goals_URL")),1)])]),Object(s["createElementVNode"])("tbody",null,[(Object(s["openBlock"])(!0),Object(s["createElementBlock"])(s["Fragment"],null,Object(s["renderList"])(e.pageviews,t=>(Object(s["openBlock"])(),Object(s["createElementBlock"])("tr",{key:t.idloghsr,class:Object(s["normalizeClass"])({inactive:t.idloghsr!==e.idLogHsr}),onClick:a=>e.onClickPageView(t)},[Object(s["createElementVNode"])("td",null,Object(s["toDisplayString"])(t.server_time_pretty),1),Object(s["createElementVNode"])("td",null,Object(s["toDisplayString"])(t.time_on_page_pretty),1),Object(s["createElementVNode"])("td",{title:t.label},Object(s["toDisplayString"])((t.label||"").substr(0,50)),9,Nn)],10,Vn))),128))])])),[[o]]),Object(s["createElementVNode"])("input",{role:"close",type:"button",value:e.translate("General_Close")},null,8,Rn)])}var kn=Object(s["defineComponent"])({props:{pageviews:{type:Array,required:!0},idLogHsr:{type:Number,required:!0}},directives:{ContentTable:B["ContentTable"]},methods:{onClickPageView(e){e.idloghsr!==this.idLogHsr&&B["MatomoUrl"].updateUrl(Object.assign(Object.assign({},B["MatomoUrl"].urlParsed.value),{},{idLogHsr:e.idloghsr}),B["MatomoUrl"].hashParsed.value.length?Object.assign(Object.assign({},B["MatomoUrl"].hashParsed.value),{},{idLogHsr:e.idloghsr}):void 0)}}});kn.render=wn;var xn=kn;const Cn={class:"heatmap-vis-title"},Dn={key:0,class:"alert alert-info heatmap-country-alert"},Tn={key:1},Mn={key:2},Pn=["innerHTML"],An={class:"alert alert-info"},Bn={key:3},Un={class:"alert alert-info"};function Fn(e,t,a,i,n,r){var o;const l=Object(s["resolveComponent"])("EnrichedHeadline"),c=Object(s["resolveComponent"])("MatomoJsNotWritableAlert"),d=Object(s["resolveComponent"])("HeatmapVis"),m=Object(s["resolveComponent"])("ContentBlock");return Object(s["openBlock"])(),Object(s["createElementBlock"])("div",null,[Object(s["createElementVNode"])("h2",Cn,[Object(s["createVNode"])(l,{"edit-url":e.editUrl,"inline-help":e.inlineHelp},{default:Object(s["withCtx"])(()=>[Object(s["createTextVNode"])(Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapX",`"${e.heatmap.name}"`)),1)]),_:1},8,["edit-url","inline-help"])]),Object(s["createVNode"])(c,{"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_Heatmaps")},null,8,["is-matomo-js-writable","recording-type"]),e.includedCountries?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Dn,Object(s["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapInfoTrackVisitsFromCountries",e.includedCountries)),1)):Object(s["createCommentVNode"])("",!0),e.heatmap.page_treemirror?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Tn,[Object(s["createVNode"])(d,{"created-date":e.createdDate,"excluded-elements":e.heatmap.excluded_elements,"num-samples":e.heatmapMetadata,url:e.heatmap.screenshot_url,"heatmap-date":e.heatmapDate,"heatmap-period":e.heatmapPeriod,"offset-accuracy":e.offsetAccuracy,"breakpoint-tablet":e.heatmap.breakpoint_tablet,"breakpoint-mobile":e.heatmap.breakpoint_mobile,"heatmap-types":e.heatmapTypes,"device-types":e.deviceTypes,"id-site-hsr":e.idSiteHsr,"is-active":e.isActive,"desktop-preview-size":e.desktopPreviewSize,"iframe-resolutions-values":e.iframeResolutions},null,8,["created-date","excluded-elements","num-samples","url","heatmap-date","heatmap-period","offset-accuracy","breakpoint-tablet","breakpoint-mobile","heatmap-types","device-types","id-site-hsr","is-active","desktop-preview-size","iframe-resolutions-values"])])):null!==(o=e.heatmapMetadata)&&void 0!==o&&o.nb_samples_device_all?(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Bn,[Object(s["createVNode"])(m,null,{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("div",Un,Object(s["toDisplayString"])(e.noHeatmapScreenshotRecordedYetText),1)]),_:1})])):(Object(s["openBlock"])(),Object(s["createElementBlock"])("div",Mn,[Object(s["createElementVNode"])("p",{innerHTML:e.$sanitize(e.recordedSamplesTroubleShoot)},null,8,Pn),Object(s["createVNode"])(m,null,{default:Object(s["withCtx"])(()=>[Object(s["createElementVNode"])("div",An,Object(s["toDisplayString"])(e.translate(e.noDataMessageKey)),1)]),_:1})]))])}var Ln=Object(s["defineComponent"])({props:{idSiteHsr:{type:Number,required:!0},heatmap:{type:Object,required:!0},heatmapMetadata:{type:Object,required:!0},deviceTypes:{type:Array,required:!0},heatmapTypes:{type:Array,required:!0},offsetAccuracy:{type:Number,required:!0},heatmapPeriod:{type:String,required:!0},heatmapDate:{type:String,required:!0},isActive:Boolean,createdDate:{type:String,required:!0},editUrl:{type:String,required:!0},inlineHelp:{type:String,required:!0},includedCountries:{type:String,required:!0},desktopPreviewSize:{type:Number,required:!0},iframeResolutions:{type:Object,required:!0},noDataMessageKey:{type:String,required:!0},isMatomoJsWritable:{type:Boolean,required:!0}},components:{MatomoJsNotWritableAlert:oi,ContentBlock:B["ContentBlock"],HeatmapVis:oe,EnrichedHeadline:B["EnrichedHeadline"]},computed:{noHeatmapScreenshotRecordedYetText(){return Object(B["translate"])("HeatmapSessionRecording_NoHeatmapScreenshotRecordedYet",this.heatmapMetadata.nb_samples_device_all,Object(B["translate"])("HeatmapSessionRecording_ScreenshotUrl"))},recordedSamplesTroubleShoot(){const e=Object(B["externalLink"])("https://matomo.org/faq/heatmap-session-recording/troubleshooting-heatmaps/");return Object(B["translate"])("HeatmapSessionRecording_HeatmapTroubleshoot",e,"</a>")}},created(){B["Matomo"].postEvent("hidePeriodSelector")}});Ln.render=Fn;var In=Ln;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=HeatmapSessionRecording.umd.min.js.map