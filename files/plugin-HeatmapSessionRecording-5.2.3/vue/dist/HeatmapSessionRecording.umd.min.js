(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["HeatmapSessionRecording"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["HeatmapSessionRecording"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/HeatmapSessionRecording/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"246e":function(e,t,n){var a,i;(function(r,o,s){e.exports?e.exports=s():(a=s,i="function"===typeof a?a.call(t,n,t,e):a,void 0===i||(e.exports=i))})(0,0,(function(){var e={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},t=function(){var t=function(e){this._coordinator={},this._data=[],this._radi=[],this._min=10,this._max=1,this._xField=e["xField"]||e.defaultXField,this._yField=e["yField"]||e.defaultYField,this._valueField=e["valueField"]||e.defaultValueField,e["radius"]&&(this._cfgRadius=e["radius"])},n=e.defaultRadius;return t.prototype={_organiseData:function(e,t){var a=e[this._xField],i=e[this._yField],r=this._radi,o=this._data,s=this._max,l=this._min,c=e[this._valueField]||1,d=e.radius||this._cfgRadius||n;o[a]||(o[a]=[],r[a]=[]),o[a][i]?o[a][i]+=c:(o[a][i]=c,r[a][i]=d);var u=o[a][i];return u>s?(t?this.setDataMax(u):this._max=u,!1):u<l?(t?this.setDataMin(u):this._min=u,!1):{x:a,y:i,value:c,radius:d,min:l,max:s}},_unOrganizeData:function(){var e=[],t=this._data,n=this._radi;for(var a in t)for(var i in t[a])e.push({x:a,y:i,radius:n[a][i],value:t[a][i]});return{min:this._min,max:this._max,data:e}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0){var e=arguments[0],t=e.length;while(t--)this.addData.call(this,e[t])}else{var n=this._organiseData(arguments[0],!0);n&&(0===this._data.length&&(this._min=this._max=n.value),this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[n]}))}return this},setData:function(e){var t=e.data,n=t.length;this._data=[],this._radi=[];for(var a=0;a<n;a++)this._organiseData(t[a],!1);return this._max=e.max,this._min=e.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(e){return this._max=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(e){return this._min=e,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(e){this._coordinator=e},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),n=function(){var e=function(e){var t=e.gradient||e.defaultGradient,n=document.createElement("canvas"),a=n.getContext("2d");n.width=256,n.height=1;var i=a.createLinearGradient(0,0,256,1);for(var r in t)i.addColorStop(r,t[r]);return a.fillStyle=i,a.fillRect(0,0,256,1),a.getImageData(0,0,256,1).data},t=function(e,t){var n=document.createElement("canvas"),a=n.getContext("2d"),i=e,r=e;if(n.width=n.height=2*e,1==t)a.beginPath(),a.arc(i,r,e,0,2*Math.PI,!1),a.fillStyle="rgba(0,0,0,1)",a.fill();else{var o=a.createRadialGradient(i,r,e*t,i,r,e);o.addColorStop(0,"rgba(0,0,0,1)"),o.addColorStop(1,"rgba(0,0,0,0)"),a.fillStyle=o,a.fillRect(0,0,2*e,2*e)}return n},n=function(e){var t=[],n=e.min,a=e.max,i=e.radi,r=(e=e.data,Object.keys(e)),o=r.length;while(o--){var s=r[o],l=Object.keys(e[s]),c=l.length;while(c--){var d=l[c],u=e[s][d],m=i[s][d];t.push({x:s,y:d,value:u,radius:m})}}return{min:n,max:a,data:t}};function a(t){var n=t.container,a=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=t.canvas||document.createElement("canvas"),r=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});i.className="heatmap-canvas",this._width=i.width=a.width=t.width||+r.width.replace(/px/,""),this._height=i.height=a.height=t.height||+r.height.replace(/px/,""),this.shadowCtx=a.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=a.style.cssText="position:absolute;left:0;top:0;",n.style.position="relative",n.appendChild(i),this._palette=e(t),this._templates={},this._setStyles(t)}return a.prototype={renderPartial:function(e){e.data.length>0&&(this._drawAlpha(e),this._colorize())},renderAll:function(e){this._clear(),e.data.length>0&&(this._drawAlpha(n(e)),this._colorize())},_updateGradient:function(t){this._palette=e(t)},updateConfig:function(e){e["gradient"]&&this._updateGradient(e),this._setStyles(e)},setDimensions:function(e,t){this._width=e,this._height=t,this.canvas.width=this.shadowCanvas.width=e,this.canvas.height=this.shadowCanvas.height=t},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(e){this._blur=0==e.blur?0:e.blur||e.defaultBlur,e.backgroundColor&&(this.canvas.style.backgroundColor=e.backgroundColor),this._width=this.canvas.width=this.shadowCanvas.width=e.width||this._width,this._height=this.canvas.height=this.shadowCanvas.height=e.height||this._height,this._opacity=255*(e.opacity||0),this._maxOpacity=255*(e.maxOpacity||e.defaultMaxOpacity),this._minOpacity=255*(e.minOpacity||e.defaultMinOpacity),this._useGradientOpacity=!!e.useGradientOpacity},_drawAlpha:function(e){var n=this._min=e.min,a=this._max=e.max,i=(e=e.data||[],e.length),r=1-this._blur;while(i--){var o,s=e[i],l=s.x,c=s.y,d=s.radius,u=Math.min(s.value,a),m=l-d,p=c-d,h=this.shadowCtx;this._templates[d]?o=this._templates[d]:this._templates[d]=o=t(d,r);var g=(u-n)/(a-n);h.globalAlpha=g<.01?.01:g,h.drawImage(o,m,p),m<this._renderBoundaries[0]&&(this._renderBoundaries[0]=m),p<this._renderBoundaries[1]&&(this._renderBoundaries[1]=p),m+2*d>this._renderBoundaries[2]&&(this._renderBoundaries[2]=m+2*d),p+2*d>this._renderBoundaries[3]&&(this._renderBoundaries[3]=p+2*d)}},_colorize:function(){var e=this._renderBoundaries[0],t=this._renderBoundaries[1],n=this._renderBoundaries[2]-e,a=this._renderBoundaries[3]-t,i=this._width,r=this._height,o=this._opacity,s=this._maxOpacity,l=this._minOpacity,c=this._useGradientOpacity;e<0&&(e=0),t<0&&(t=0),e+n>i&&(n=i-e),t+a>r&&(a=r-t);for(var d=this.shadowCtx.getImageData(e,t,n,a),u=d.data,m=u.length,p=this._palette,h=3;h<m;h+=4){var g,f=u[h],b=4*f;if(b)g=o>0?o:f<s?f<l?l:f:s,u[h-3]=p[b],u[h-2]=p[b+1],u[h-1]=p[b+2],u[h]=c?p[b+3]:g}d.data=u,this.ctx.putImageData(d,e,t),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(e){var t,n=this.shadowCtx,a=n.getImageData(e.x,e.y,1,1),i=a.data[3],r=this._max,o=this._min;return t=Math.abs(r-o)*(i/255)>>0,t},getDataURL:function(){return this.canvas.toDataURL()}},a}(),a=function(){var t=!1;return"canvas2d"===e["defaultRenderer"]&&(t=n),t}(),i={merge:function(){for(var e={},t=arguments.length,n=0;n<t;n++){var a=arguments[n];for(var i in a)e[i]=a[i]}return e}},r=function(){var n=function(){function e(){this.cStore={}}return e.prototype={on:function(e,t,n){var a=this.cStore;a[e]||(a[e]=[]),a[e].push((function(e){return t.call(n,e)}))},emit:function(e,t){var n=this.cStore;if(n[e])for(var a=n[e].length,i=0;i<a;i++){var r=n[e][i];r(t)}}},e}(),r=function(e){var t=e._renderer,n=e._coordinator,a=e._store;n.on("renderpartial",t.renderPartial,t),n.on("renderall",t.renderAll,t),n.on("extremachange",(function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config["gradient"]||e._config["defaultGradient"]})})),a.setCoordinator(n)};function o(){var o=this._config=i.merge(e,arguments[0]||{});if(this._coordinator=new n,o["plugin"]){var s=o["plugin"];if(!e.plugins[s])throw new Error("Plugin '"+s+"' not found. Maybe it was not registered.");var l=e.plugins[s];this._renderer=new l.renderer(o),this._store=new l.store(o)}else this._renderer=new a(o),this._store=new t(o);r(this)}return o.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(e){return this._config=i.merge(this._config,e),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(e){return this._store.getValueAt?this._store.getValueAt(e):this._renderer.getValueAt?this._renderer.getValueAt(e):null}},o}(),o={create:function(e){return new r(e)},register:function(t,n){e.plugins[t]=n}};return o}))},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"HeatmapVis",(function(){return ve})),n.d(t,"SessionRecordingVis",(function(){return xt})),n.d(t,"HsrTargetTest",(function(){return It})),n.d(t,"HsrUrlTarget",(function(){return nn})),n.d(t,"HeatmapEdit",(function(){return Ln})),n.d(t,"HeatmapList",(function(){return Ra})),n.d(t,"HeatmapManage",(function(){return Fa})),n.d(t,"SessionRecordingEdit",(function(){return vi})),n.d(t,"SessionRecordingList",(function(){return sr})),n.d(t,"SessionRecordingManage",(function(){return ur})),n.d(t,"ListOfPageviews",(function(){return Or})),n.d(t,"HeatmapVisPage",(function(){return Rr})),n.d(t,"MatomoJsNotWritableAlert",(function(){return Ba})),n.d(t,"Tooltip",(function(){return Q})),"undefined"!==typeof window){var a=window.document.currentScript,i=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var r=n("8bbf");function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s={class:"heatmapVis"},l=["innerHTML"],c={class:"heatmapSelection"},d={style:{display:"inline","margin-right":"13.5px"}},u=["onClick"],m={style:{display:"inline","margin-left":"3rem","margin-right":"13.5px"}},p=["title","onClick"],h=["src","alt"],g=Object(r["createTextVNode"])(),f={class:"numSamples"},b={class:"legendOuter"},v={class:"legend-area"},y=Object(r["createElementVNode"])("span",{class:"min"},"0",-1),O=["src"],j=Object(r["createElementVNode"])("span",{class:"max"},"0",-1),S={class:"customIframeWidth"},_=["textContent"],H={class:"iframeRecordingContainer",ref:"iframeRecordingContainer"},V={class:"heatmapWrapper"},N={id:"heatmapContainer",ref:"heatmapContainer"},w=Object(r["createElementVNode"])("div",{id:"highlightDiv"},null,-1),E=Object(r["createElementVNode"])("div",{class:"loadingUnderlay"},null,-1),k={class:"valign-wrapper loadingInner"},R={class:"loadingContent"},C=["title"],x=["src","width"],T={style:{"margin-top":"2rem"}},D={class:"ui-confirm",id:"confirmDeleteHeatmapScreenshot",ref:"confirmDeleteHeatmapScreenshot"},M=["value"],P=["value"];function A(e,t,n,a,i,A){var B=Object(r["resolveComponent"])("Field"),U=Object(r["resolveComponent"])("SaveButton"),I=Object(r["resolveComponent"])("Tooltip");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",s,[e.actualNumSamples.nb_samples_device_all?(Object(r["openBlock"])(),Object(r["createElementBlock"])("p",{key:0,innerHTML:e.$sanitize(e.recordedSamplesSince)},null,8,l)):Object(r["createCommentVNode"])("",!0),Object(r["createElementVNode"])("div",c,[Object(r["createElementVNode"])("h4",d,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_Action")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.heatmapTypes,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{class:Object(r["normalizeClass"])(["btn-flat",o({visActive:t.key===e.heatmapType},"heatmapType".concat(t.key),!0)]),onClick:function(n){return e.changeHeatmapType(t.key)},key:t.key},Object(r["toDisplayString"])(t.name),11,u)})),128)),Object(r["createElementVNode"])("h4",m,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeviceType")),1),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.deviceTypesWithSamples,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("span",{class:Object(r["normalizeClass"])(["btn-flat",o({visActive:t.key===e.deviceType},"deviceType".concat(t.key),!0)]),title:t.tooltip,onClick:function(n){return e.changeDeviceType(t.key)},key:t.key},[Object(r["createElementVNode"])("img",{height:"15",src:t.logo,alt:"".concat(e.translate("DevicesDetection_Device")," ").concat(t.name)},null,8,h),g,Object(r["createElementVNode"])("span",f,Object(r["toDisplayString"])(t.numSamples),1)],10,p)})),128)),Object(r["createElementVNode"])("div",b,[Object(r["createElementVNode"])("h4",null,Object(r["toDisplayString"])(e.translate("Installation_Legend")),1),Object(r["createElementVNode"])("div",v,[y,Object(r["createElementVNode"])("img",{class:"gradient",alt:"gradient",src:e.gradientImgData},null,8,O),j])]),Object(r["createElementVNode"])("div",S,[Object(r["createElementVNode"])("span",{style:{"margin-left":"2.5rem","margin-right":"13.5px"},textContent:Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_Width"))},null,8,_),Object(r["createVNode"])(B,{uicontrol:"select",name:"iframewidth","model-value":e.customIframeWidth,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.customIframeWidth=t,e.changeIframeWidth(e.customIframeWidth,!0)}),options:e.iframeWidthOptions},null,8,["model-value","options"])])]),Object(r["createElementVNode"])("div",H,[Object(r["createElementVNode"])("div",V,[Object(r["createElementVNode"])("div",N,null,512),w]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"hsrLoadingOuter",style:Object(r["normalizeStyle"])([{height:"400px"},{width:e.iframeWidth+"px"}])},[E,Object(r["createElementVNode"])("div",k,[Object(r["createElementVNode"])("div",R,Object(r["toDisplayString"])(e.translate("General_Loading")),1)])],4),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"aboveFoldLine",title:e.translate("HeatmapSessionRecording_AvgAboveFoldDescription"),style:Object(r["normalizeStyle"])({width:e.iframeWidth+"px",top:e.avgFold+"px"})},[Object(r["createElementVNode"])("div",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_AvgAboveFoldTitle",e.avgFold)),1)],12,C),[[r["vShow"],e.avgFold]]),e.embedUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("iframe",{key:0,id:"recordingPlayer",ref:"recordingPlayer",sandbox:"allow-scripts allow-same-origin",referrerpolicy:"no-referrer",onLoad:t[1]||(t[1]=function(t){return e.onLoaded()}),height:"400",src:e.embedUrl,width:e.iframeWidth},null,40,x)):Object(r["createCommentVNode"])("",!0)],512),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",T,[Object(r["createVNode"])(U,{style:{display:"block !important"},loading:e.isLoading,onClick:t[2]||(t[2]=function(t){return e.deleteScreenshot()}),value:e.translate("HeatmapSessionRecording_DeleteScreenshot")},null,8,["loading","value"])],512),[[r["vShow"],e.showDeleteScreenshot]]),Object(r["createElementVNode"])("div",D,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteHeatmapScreenshotConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,M),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,P)],512),Object(r["createVNode"])(I,{ref:"tooltip","click-count":e.clickCount,"click-rate":e.clickRate,"is-moves":1===e.heatmapType},null,8,["click-count","click-rate","is-moves"])])}var B=n("246e"),U=n.n(B),I=n("19dc"),L=n("a5a2");
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */
function F(e){return e&&e.contentWindow?e.contentWindow:e&&e.contentDocument&&e.contentDocument.defaultView?e.contentDocument.defaultView:void 0}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */function W(e,t){var n=null;return function(a,i){return n&&(n.abort(),n=null),n=new AbortController,I["AjaxHelper"].post(Object.assign(Object.assign({},a),{},{method:e}),i,Object.assign(Object.assign({},t),{},{abortController:n})).finally((function(){n=null}))}}var q={class:"tooltip-item"},z={class:"tooltip-label"},G={class:"tooltip-value"},$={class:"tooltip-item"},J={class:"tooltip-label"},X={class:"tooltip-value"};function Y(e,t,n,a,i,o){return Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{ref:"tooltipRef",class:"tooltip",style:Object(r["normalizeStyle"])(e.tooltipStyle)},[Object(r["createElementVNode"])("div",q,[Object(r["createElementVNode"])("span",z,Object(r["toDisplayString"])(e.getClickCountTranslation),1),Object(r["createElementVNode"])("span",G,Object(r["toDisplayString"])(e.getClickCount),1)]),Object(r["createElementVNode"])("div",$,[Object(r["createElementVNode"])("span",J,Object(r["toDisplayString"])(e.getClickRateTranslation),1),Object(r["createElementVNode"])("span",X,Object(r["toDisplayString"])(e.getClickRate),1)])],4)),[[r["vShow"],e.visible]])}var K=Object(r["defineComponent"])({props:{clickCount:{type:Number,required:!0},clickRate:{type:Number,required:!0},isMoves:{type:Boolean,required:!1,default:!1}},setup:function(){var e=Object(r["reactive"])({visible:!1,position:{top:0,left:0}}),t=Object(r["ref"])(null),n=Object(r["computed"])((function(){return{top:"".concat(e.position.top,"px"),left:"".concat(e.position.left,"px"),position:"absolute",zIndex:1e3}}));function a(n){var a=window.scrollY||document.documentElement.scrollTop,i=window.scrollX||document.documentElement.scrollLeft;e.position.top=n.clientY+a+10,e.position.left=n.clientX+i+10,e.visible=!0,Object(r["nextTick"])((function(){var r=t.value;if(r){var o=window,s=o.innerWidth,l=o.innerHeight,c=r.getBoundingClientRect();c.right>s&&(e.position.left=n.clientX+i-c.width-10),c.bottom>l&&(e.position.top=n.clientY+a-c.height-10);var d=r.getBoundingClientRect();d.left<0&&(e.position.left=i+10),d.top<0&&(e.position.top=a+10)}}))}function i(){e.visible=!1}return Object.assign(Object.assign({},Object(r["toRefs"])(e)),{},{tooltipRef:t,show:a,hide:i,tooltipStyle:n,translate:I["translate"]})},computed:{getClickCount:function(){return I["NumberFormatter"].formatNumber(this.clickCount)},getClickRate:function(){return I["NumberFormatter"].formatPercent(this.clickRate)},getClickCountTranslation:function(){var e=this.isMoves?"HeatmapSessionRecording_Moves":"HeatmapSessionRecording_Clicks";return Object(I["translate"])(e)},getClickRateTranslation:function(){var e=this.isMoves?"HeatmapSessionRecording_MoveRate":"HeatmapSessionRecording_ClickRate";return Object(I["translate"])(e)}}});K.render=Y;var Q=K;function Z(e,t){return ie(e)||ae(e,t)||te(e,t)||ee()}function ee(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function te(e,t){if(e){if("string"===typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ae(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(l){s=!0,i=l}finally{try{o||null==n["return"]||n["return"]()}finally{if(s)throw i}}return r}}function ie(e){if(Array.isArray(e))return e}var re=window,oe=re.$,se=1,le=2,ce=3,de=32e3,ue=String(window.navigator.userAgent).toLowerCase();function me(e,t,n){var a=oe(e);a.css("height","400px");var i=n.getIframeHeight();a.css("height","".concat(i,"px")),oe(t).css("height","".concat(i,"px")).css("width","".concat(a.width(),"px")).empty();for(var r=Math.ceil(i/de),o=1;o<=r;o+=1){var s=de;o===r&&(s=i%de),oe(t).append('<div id="heatmap'.concat(o,'" class="heatmapTile"></div>')),oe(t).find("#heatmap".concat(o)).css({height:"".concat(s,"px")})}return r}function pe(e,t,n,a){var i=oe(t);i.css("height","400px");var r=n.getIframeHeight();i.css("height","".concat(r,"px"));var o=1e3,s=r/o,l=a.reduce((function(e,t){return e+parseInt(t.value,10)}),0),c=[],d=0,u=null,m=100,p=0;function h(e,t,n,a,i){return a+(e-t)/(n-t)*(i-a)}function g(e,t,n){if(t===n||!t&&!n)return[255,255,0];var a=h(e,t,n,0,255),i=(n-t)/5;return a>204?[255,h(e,n-i,n,255,0),0]:a>153?[h(e,n-2*i,n-i,0,255),255,0]:a>102?[0,255,h(e,n-3*i,n-2*i,255,0)]:a>51?[0,h(e,n-4*i,n-3*i,0,255),255]:[h(e,t,n-4*i,255,0),0,255]}if(a.forEach((function(e){var t=parseInt(e.value,10),n=parseInt(e.label,10),a=Math.round(n*s);u&&u.position===a?d+=t:(0!==l&&(m=(l-d)/l*100),d+=t,u={percentageValue:10*parseFloat(m.toFixed(1)),position:p,percent:m.toFixed(1)},c.push(u)),p=a})),c.length){var f=c.some((function(e){return 0===e.position}));f||c.unshift({percent:"100.0",percentageValue:1e3,position:0})}else c.push({percent:"0",percentageValue:0,position:0});var b=0,v=1e3;c&&c.length&&c[0]&&(b=c[c.length-1].percentageValue);for(var y=i.width(),O=null,j=0;j<c.length;j+=1){var S=c[j];O=c[j+1]?c[j+1]:{position:r};var _=S.position,H=O.position-S.position;0===H&&(H=1);var V="".concat(S.percent," percent reached this point"),N=g(S.percentageValue,b,v),w="rgb(".concat(N.join(","),")");oe(e).append('<div class="scrollHeatmapLeaf" title="'.concat(V,'" style="width: ').concat(y,"px;height:")+" ".concat(H,"px;left: 0;top: ").concat(_,"px; background-color: ").concat(w,';"></div>'))}oe(".scrollHeatmapLeaf",e).tooltip({track:!0,items:"*",tooltipClass:"heatmapTooltip",show:!1,hide:!1}),oe(".legend-area .min").text("".concat((b/10).toFixed(1),"%")),oe(".legend-area .max").text("".concat((v/10).toFixed(1),"%"))}function he(e,t,n,a){var i=me(e,t,n),r=document.createElement("canvas");r.width=100,r.height=10;var o=document.querySelector(".legend-area .min"),s=document.querySelector(".legend-area .max"),l=document.querySelector(".legend-area .gradient"),c=r.getContext("2d"),d={};function u(e){if(o.innerHTML="".concat(e.min),s.innerHTML="".concat(e.max),e.gradient&&e.gradient!==d){d=e.gradient;var t=c.createLinearGradient(0,0,100,1);Object.keys(d).forEach((function(e){t.addColorStop(parseFloat(e),d[e])})),c.fillStyle=t,c.fillRect(0,0,100,10),l.src=r.toDataURL()}}for(var m=[],p=function(e){var t={min:a.min,max:a.max,data:[]},n={container:document.getElementById("heatmap".concat(e)),radius:10,maxOpacity:.5,minOpacity:0,blur:.75};if(1===e&&(n.onExtremaChange=u),a&&a.data&&a.data.length>=2e4?n.radius=8:a&&a.data&&a.data.length>=2e3&&(n.radius=9),1===i)t.data=a.data;else{var r=(e-1)*de,o=r+de-1;a.data.forEach((function(e){if(e.y>=r&&e.y<=o){var n=Object.assign(Object.assign({},e),{},{y:e.y-r});t.data.push(n)}}))}var s=U.a.create(n);s.setData(t),m.push(s)},h=1;h<=i;h+=1)p(h);return m}ue.match(/(iPod|iPhone|iPad|Android|IEMobile|Windows Phone)/i)?de=2e3:(ue.indexOf("msie ")>0||ue.indexOf("trident/")>0||ue.indexOf("edge")>0)&&(de=8e3);var ge=Object(r["defineComponent"])({props:{idSiteHsr:{type:Number,required:!0},deviceTypes:{type:Array,required:!0},heatmapTypes:{type:Array,required:!0},breakpointMobile:{type:Number,required:!0},breakpointTablet:{type:Number,required:!0},offsetAccuracy:{type:Number,required:!0},heatmapPeriod:{type:String,required:!0},heatmapDate:{type:String,required:!0},url:{type:String,required:!0},isActive:Boolean,numSamples:{type:Object,required:!0},excludedElements:{type:String,required:!0},createdDate:{type:String,required:!0},desktopPreviewSize:{type:Number,required:!0},iframeResolutionsValues:{type:Object,required:!0}},components:{Field:L["Field"],SaveButton:L["SaveButton"],Tooltip:Q},data:function(){return{isLoading:!1,iframeWidth:this.desktopPreviewSize,customIframeWidth:this.desktopPreviewSize,avgFold:0,heatmapType:this.heatmapTypes[0].key,deviceType:this.deviceTypes[0].key,iframeResolutions:this.iframeResolutionsValues,actualNumSamples:this.numSamples,dataCoordinates:[],currentElement:null,totalClicks:0,tooltipShowTimeoutId:null,clickCount:0,clickRate:0}},setup:function(e){var t=Object(r["ref"])(null),n=null,a=new Promise((function(e){n=e})),i=null,o=function(t){return i||(i=F(t).recordingFrame,i.excludeElements(e.excludedElements),i.addClass("html","piwikHeatmap"),i.addClass("html","matomoHeatmap"),i.addWorkaroundForSharepointHeatmaps()),i},s=Object(r["ref"])(null),l=function(e,t,n,a){s.value=he(e,t,n,a)};return{iframeLoadedPromise:a,onLoaded:n,getRecordedHeatmap:W("HeatmapSessionRecording.getRecordedHeatmap"),getRecordedHeatmapMetadata:W("HeatmapSessionRecording.getRecordedHeatmapMetadata"),getRecordingIframe:o,heatmapInstances:s,renderHeatmap:l,tooltip:t}},created:function(){-1===this.iframeResolutions.indexOf(this.breakpointMobile)&&this.iframeResolutions.push(this.breakpointMobile),-1===this.iframeResolutions.indexOf(this.breakpointTablet)&&this.iframeResolutions.push(this.breakpointTablet),this.iframeResolutions=this.iframeResolutions.sort((function(e,t){return e-t})),this.fetchHeatmap(),I["Matomo"].postEvent("hidePeriodSelector")},watch:{isLoading:function(){var e=this;if(!0!==this.isLoading){var t=window.document.getElementById("heatmapContainer");t&&(t.addEventListener("mouseleave",(function(t){e.tooltipShowTimeoutId&&(clearTimeout(e.tooltipShowTimeoutId),e.tooltipShowTimeoutId=null),e.currentElement=null,e.handleTooltip(t,0,0,"hide");var n=window.document.getElementById("highlightDiv");n&&(n.hidden=!0)})),t.addEventListener("mousemove",(function(t){e.handleMouseMove(t)})))}}},beforeUnmount:function(){this.removeScrollHeatmap()},methods:{removeScrollHeatmap:function(){var e=this.$refs.iframeRecordingContainer;oe(e).find(".scrollHeatmapLeaf").remove()},deleteScreenshot:function(){var e=this;I["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteHeatmapScreenshot,{yes:function(){e.isLoading=!0,I["AjaxHelper"].fetch({method:"HeatmapSessionRecording.deleteHeatmapScreenshot",idSiteHsr:e.idSiteHsr}).then((function(){e.isLoading=!1,window.location.reload()}))}})},fetchHeatmap:function(){var e=this;if(this.removeScrollHeatmap(),this.heatmapInstances){var t=this.heatmapInstances;t.forEach((function(e){e.setData({max:1,min:0,data:[]})}))}this.isLoading=!0,this.avgFold=0;var n=I["MatomoUrl"].parsed.value.segment?decodeURIComponent(I["MatomoUrl"].parsed.value.segment):void 0,a={idSiteHsr:this.idSiteHsr,heatmapType:this.heatmapType,deviceType:this.deviceType,period:this.heatmapPeriod,date:this.heatmapDate,filter_limit:-1,segment:n},i=this.getRecordedHeatmap(a),r=this.getRecordedHeatmapMetadata(a);Promise.all([i,r,this.iframeLoadedPromise]).then((function(t){var n=e.$refs.recordingPlayer,a=e.getRecordingIframe(n);me(e.$refs.recordingPlayer,e.$refs.heatmapContainer,a),e.removeScrollHeatmap();var i=t[0],r=t[1];if(Array.isArray(r)&&r[0]){var o=Z(r,1);e.actualNumSamples=o[0]}else e.actualNumSamples=r;if(e.isLoading=!1,e.isScrollHeatmapType)pe(e.$refs.iframeRecordingContainer,n,a,i);else{for(var s,l={min:0,max:0,data:[]},c=0;c<i.length;c+=1){var d=i[c];if(d.selector){var u=a.getCoordinatesInFrame(d.selector,d.offset_x,d.offset_y,e.offsetAccuracy,!0);u&&(u.value=d.value,l.data.push(u),e.dataCoordinates.push(u),e.totalClicks+=parseInt(d.value,10))}}if(2===e.heatmapType){var m=0;l.data.forEach((function(e){null!==e&&void 0!==e&&e.value&&parseInt(e.value,10)>1&&(m+=1)})),m/l.data.length>=.1&&l.data.length>120?l.max=2:l.max=1}else{var p=10,h={};if(l.data.forEach((function(e){if(e&&e.value){var t=parseInt(e.value,10);t>l.max&&(l.max=t),t>p&&(t=p);var n="".concat(t);n in h?h[n]+=1:h[n]=0}})),l.max>p){for(var g=0,f=p;f>1;f-=1){var b="".concat(f);if(b in h&&(g+=h[b]),g/l.data.length>=.2){l.max=f;break}}if(l.max>p){l.max=5;for(var v=5;v>0;v-=1){var y="".concat(v);if(y in h){l.max=v;break}}}}}if(e.renderHeatmap(e.$refs.recordingPlayer,e.$refs.heatmapContainer,a,l),null!==(s=e.actualNumSamples)&&void 0!==s&&s["avg_fold_device_".concat(e.deviceType)]){var O=e.actualNumSamples["avg_fold_device_".concat(e.deviceType)],j=a.getIframeHeight();j&&(e.avgFold=parseInt("".concat(O/100*j),10))}}})).finally((function(){e.isLoading=!1}))},changeDeviceType:function(e){this.deviceType=e,this.deviceType===se?this.changeIframeWidth(this.desktopPreviewSize,!1):this.deviceType===le?this.changeIframeWidth(this.breakpointTablet||960,!1):this.deviceType===ce&&this.changeIframeWidth(this.breakpointMobile||600,!1)},changeIframeWidth:function(e,t){this.iframeWidth=e,this.customIframeWidth=this.iframeWidth,this.totalClicks=0,this.dataCoordinates=[],this.fetchHeatmap(),t&&I["Matomo"].helper.lazyScrollToContent()},changeHeatmapType:function(e){this.heatmapType=e,this.totalClicks=0,this.clickCount=0,this.clickRate=0,this.dataCoordinates=[],this.fetchHeatmap()},handleMouseMove:function(e){var t=this,n=window.document.getElementById("highlightDiv");if(n){this.tooltipShowTimeoutId&&(clearTimeout(this.tooltipShowTimeoutId),this.tooltipShowTimeoutId=null,this.currentElement=null),n.hidden||this.handleTooltip(e,0,0,"move");var a=this.lookUpRecordedElementAtEventLocation(e);if(a&&a!==this.currentElement){this.handleTooltip(e,0,0,"hide"),n.hidden=!0;var i=a.getBoundingClientRect(),r=0;this.dataCoordinates.forEach((function(e){e.y<i.top||e.y>i.bottom||e.x<i.left||e.x>i.right||(r+=parseInt(e.value,10))})),this.tooltipShowTimeoutId=setTimeout((function(){t.currentElement=a,n.hidden=!1;var i=t.totalClicks?Math.round(r/t.totalClicks*1e4)/100:0,o=a.getBoundingClientRect();n.style.top="".concat(o.top,"px"),n.style.left="".concat(o.left,"px"),n.style.width="".concat(o.width,"px"),n.style.height="".concat(o.height,"px"),t.handleTooltip(e,r,i,"show"),t.tooltipShowTimeoutId=null}),100)}}},lookUpRecordedElementAtEventLocation:function(e){var t=e.target;if(!t)return null;var n=window.document.getElementById("recordingPlayer");if(!n)return null;var a=n.contentWindow?n.contentWindow.document:n.contentDocument;if(!a)return null;var i=t.getBoundingClientRect();return a.elementFromPoint(e.clientX-i.left,e.clientY-i.top)},handleTooltip:function(e,t,n,a){this.tooltip&&("show"===a?(this.clickCount=t,this.clickRate=n,this.tooltip.show(e)):"move"===a?this.tooltip.show(e):this.tooltip.hide())}},computed:{isScrollHeatmapType:function(){return 3===this.heatmapType},tokenAuth:function(){return I["MatomoUrl"].parsed.value.token_auth},embedUrl:function(){return"?".concat(I["MatomoUrl"].stringify({module:"HeatmapSessionRecording",action:"embedPage",idSite:I["Matomo"].idSite,idSiteHsr:this.idSiteHsr,token_auth:this.tokenAuth||void 0}))},iframeWidthOptions:function(){return this.iframeResolutions.map((function(e){return{key:e,value:"".concat(e,"px")}}))},recordedSamplesSince:function(){var e=Object(I["translate"])("HeatmapSessionRecording_HeatmapXRecordedSamplesSince",'<span class="deviceAllCountSamples">'.concat(this.actualNumSamples.nb_samples_device_all,"</span>"),this.createdDate),t=Object(I["externalLink"])("https://matomo.org/subcategory/troubleshoot-7/"),n=Object(I["translate"])("HeatmapSessionRecording_HeatmapTroubleshoot",t,"</a>");return"".concat(e," ").concat(n)},deviceTypesWithSamples:function(){var e=this;return this.deviceTypes.map((function(t){var n;n=e.actualNumSamples["nb_samples_device_".concat(t.key)]?e.actualNumSamples["nb_samples_device_".concat(t.key)]:0;var a=Object(I["translate"])("HeatmapSessionRecording_XSamples","".concat(t.name," - ").concat(n));return Object.assign(Object.assign({},t),{},{numSamples:n,tooltip:a})}))},hasWriteAccess:function(){return!(null===I["Matomo"]||void 0===I["Matomo"]||!I["Matomo"].heatmapWriteAccess)},showDeleteScreenshot:function(){return this.isActive&&this.hasWriteAccess},gradientImgData:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAKCAYAAABCHPt+AAAAnklEQVRYR+2WQQqDQBAES5wB/f8/Y05RcMWwSu6JIT0Dm4WlH1DUdHew7/z6WYFhhnGRpnlhAEaQpi/ADbh/np0MiBhGhW+2ymFU+DZfg1EhaoB4jCFuMYYcQKZrXwPEVvm5Og0pcYakBvI35G1jNIZ4jCHexxjSpz9ZFUjAynLbpOvqteaODkm9sloz5JF+ZTVmSAWSu9Qb65AvgDwBQoLgVDlWfAQAAAAASUVORK5CYII="}}});ge.render=A;var fe,be,ve=ge,ye={class:"sessionRecordingPlayer"},Oe={class:"controls"},je={class:"playerActions"},Se=["title"],_e=["title"],He=["title"],Ve=["title"],Ne=["title"],we=["title"],Ee=["title"],ke=["title"],Re={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},Ce=Object(r["createElementVNode"])("path",{d:"M480 576.5v-321h-64.5v129h-63v-129h-64.5v192h127.5v129h64.5zM607.5 127.999c34.5 0\n              64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447z"},null,-1),xe=[Ce],Te={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},De=Object(r["createElementVNode"])("path",{d:"M448.5 576.5v-321h-129v64.5h64.5v256.5h64.5zM607.5 127.999c34.5 0 64.5 30 64.5\n              64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5 0-64.5-30-64.5-64.5v-447c0-34.5\n              30-64.5 64.5-64.5h447z"},null,-1),Me=[De],Pe={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},Ae=Object(r["createElementVNode"])("path",{d:"M480 384.5v-64.5c0-36-30-64.5-64.5-64.5h-127.5v64.5h127.5v64.5h-63c-34.5 0-64.5\n              27-64.5 63v129h192v-64.5h-127.5v-64.5h63c34.5 0 64.5-27 64.5-63zM607.5 127.999c34.5\n              0 64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447z"},null,-1),Be=[Ae],Ue={version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},Ie=Object(r["createElementVNode"])("path",{d:"M480 320v-64.5h-127.5c-34.5 0-64.5 28.5-64.5 64.5v192c0 36 30 64.5 64.5\n              64.5h63c34.5 0 64.5-28.5 64.5-64.5v-64.5c0-36-30-63-64.5-63h-63v-64.5h127.5zM607.5\n              127.999c34.5 0 64.5 30 64.5 64.5v447c0 34.5-30 64.5-64.5 64.5h-447c-34.5\n              0-64.5-30-64.5-64.5v-447c0-34.5 30-64.5 64.5-64.5h447zM352.5 512v-64.5h63v64.5h-63z"},null,-1),Le=[Ie],Fe=["title"],We=Object(r["createElementVNode"])("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 768 768"},[Object(r["createElementVNode"])("path",{d:"M223.5 415.5h111l-64.5-63h-46.5v63zM72 72l624 624-42 40.5-88.5-90c-51 36-114\n              57-181.5 57-177 0-319.5-142.5-319.5-319.5 0-67.5 21-130.5 57-181.5l-90-88.5zM544.5\n              352.5h-111l-231-231c51-36 114-57 181.5-57 177 0 319.5 142.5 319.5 319.5 0 67.5-21\n              130.5-57 181.5l-148.5-150h46.5v-63z"})],-1),qe=[We],ze=["title"],Ge=Object(r["createElementVNode"])("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 768 768"},[Object(r["createElementVNode"])("path",{d:"M544.5 609v-129h63v192h-384v96l-127.5-127.5 127.5-127.5v96h321zM223.5\n              288v129h-63v-192h384v-96l127.5 127.5-127.5 127.5v-96h-321z"})],-1),$e=[Ge],Je={class:"duration"},Xe={class:"playerHelp"},Ye=Object(r["createElementVNode"])("span",{class:"clickEvent"},null,-1),Ke=Object(r["createElementVNode"])("span",{class:"moveEvent"},null,-1),Qe=Object(r["createElementVNode"])("span",{class:"scrollEvent"},null,-1),Ze=Object(r["createElementVNode"])("span",{class:"resizeEvent"},null,-1),et=Object(r["createElementVNode"])("span",{class:"formChange"},null,-1),tt=Object(r["createElementVNode"])("span",{class:"mutationEvent"},null,-1),nt=Object(r["createElementVNode"])("br",{style:{clear:"right"}},null,-1),at=["title"],it=Object(r["createElementVNode"])("br",null,null,-1),rt=Object(r["createElementVNode"])("div",{class:"loadingUnderlay"},null,-1),ot={class:"valign-wrapper loadingInner"},st={class:"loadingContent"},lt=["src","width","height"];function ct(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ye,[Object(r["createElementVNode"])("div",Oe,[Object(r["createElementVNode"])("span",je,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-skip-previous",title:e.skipPreviousButtonTitle,onClick:t[0]||(t[0]=function(t){return e.loadNewRecording(e.previousRecordingId)})},null,8,Se),[[r["vShow"],e.previousRecordingId]]),Object(r["createElementVNode"])("span",{class:"playerAction icon-fast-rewind",title:e.translate("HeatmapSessionRecording_PlayerRewindFast",10,"J"),onClick:t[1]||(t[1]=function(t){return e.jumpRelative(10,!1)})},null,8,_e),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-play",title:e.translate("HeatmapSessionRecording_PlayerPlay","K"),onClick:t[2]||(t[2]=function(t){return e.play()})},null,8,He),[[r["vShow"],!e.isPlaying&&!e.isFinished]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-replay",title:e.translate("HeatmapSessionRecording_PlayerReplay","K"),onClick:t[3]||(t[3]=function(t){return e.replay()})},null,8,Ve),[[r["vShow"],!e.isPlaying&&e.isFinished]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-pause",title:e.translate("HeatmapSessionRecording_PlayerPause","K"),onClick:t[4]||(t[4]=function(t){return e.pause()})},null,8,Ne),[[r["vShow"],e.isPlaying]]),Object(r["createElementVNode"])("span",{class:"playerAction icon-fast-forward",title:e.translate("HeatmapSessionRecording_PlayerForwardFast",10,"L"),onClick:t[5]||(t[5]=function(t){return e.jumpRelative(10,!0)})},null,8,we),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"playerAction icon-skip-next",title:e.translate("HeatmapSessionRecording_PlayerPageViewNext",e.nextRecordingInfo,"N"),onClick:t[6]||(t[6]=function(t){return e.loadNewRecording(e.nextRecordingId)})},null,8,Ee),[[r["vShow"],e.nextRecordingId]]),Object(r["createElementVNode"])("span",{class:"changeReplaySpeed",title:e.translate("HeatmapSessionRecording_ChangeReplaySpeed","S"),onClick:t[7]||(t[7]=function(t){return e.increaseReplaySpeed()})},[Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",Re,xe,512)),[[r["vShow"],4===e.actualReplaySpeed]]),Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",Te,Me,512)),[[r["vShow"],1===e.actualReplaySpeed]]),Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",Pe,Be,512)),[[r["vShow"],2===e.actualReplaySpeed]]),Object(r["withDirectives"])((Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",Ue,Le,512)),[[r["vShow"],6===e.actualReplaySpeed]])],8,ke),Object(r["createElementVNode"])("span",{class:Object(r["normalizeClass"])(["toggleSkipPause",{active:e.actualSkipPausesEnabled}]),title:e.translate("HeatmapSessionRecording_ClickToSkipPauses",e.skipPausesEnabledText,"B"),onClick:t[8]||(t[8]=function(t){return e.toggleSkipPauses()})},qe,10,Fe),Object(r["createElementVNode"])("span",{class:Object(r["normalizeClass"])(["toggleAutoPlay",{active:e.actualAutoPlayEnabled}]),title:e.translate("HeatmapSessionRecording_AutoPlayNextPageview",e.autoplayEnabledText,"A"),onClick:t[9]||(t[9]=function(t){return e.toggleAutoPlay()})},$e,10,ze),Object(r["createElementVNode"])("span",Je,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_PlayerDurationXofY",e.positionPretty,e.durationPretty)),1)]),Object(r["createElementVNode"])("div",Xe,[Object(r["createElementVNode"])("ul",null,[Object(r["createElementVNode"])("li",null,[Ye,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityClick")),1)]),Object(r["createElementVNode"])("li",null,[Ke,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityMove")),1)]),Object(r["createElementVNode"])("li",null,[Qe,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityScroll")),1)]),Object(r["createElementVNode"])("li",null,[Ze,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityResize")),1)]),Object(r["createElementVNode"])("li",null,[et,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityFormChange")),1)]),Object(r["createElementVNode"])("li",null,[tt,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ActivityPageChange")),1)])])]),nt]),Object(r["createElementVNode"])("div",{class:"timelineOuter",onClick:t[10]||(t[10]=function(t){return e.seekEvent(t)}),style:Object(r["normalizeStyle"])({width:"".concat(e.replayWidth,"px")})},[Object(r["createElementVNode"])("div",{class:"timelineInner",style:Object(r["normalizeStyle"])({width:"".concat(e.progress,"%")})},null,4),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.clues,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{title:e.title,class:Object(r["normalizeClass"])(e.type),style:Object(r["normalizeStyle"])({left:"".concat(e.left,"%")}),key:t},null,14,at)})),128))],4),it,Object(r["withDirectives"])(Object(r["createElementVNode"])("div",{class:"hsrLoadingOuter",style:Object(r["normalizeStyle"])({width:"".concat(e.replayWidth,"px"),height:"".concat(e.replayHeight,"px")})},[rt,Object(r["createElementVNode"])("div",ot,[Object(r["createElementVNode"])("div",st,Object(r["toDisplayString"])(e.translate("General_Loading")),1)])],4),[[r["vShow"],e.isLoading]]),Object(r["createElementVNode"])("div",{class:"replayContainerOuter",onClick:t[12]||(t[12]=function(t){return e.togglePlay()}),style:Object(r["normalizeStyle"])({height:"".concat(e.replayHeight,"px"),width:"".concat(e.replayWidth,"px")})},[Object(r["createElementVNode"])("div",{class:"replayContainerInner",style:Object(r["normalizeStyle"])([{"transform-origin":"0 0"},{transform:"scale(".concat(e.replayScale,")"),"margin-left":"".concat(e.replayMarginLeft,"px")}])},[e.embedUrl?(Object(r["openBlock"])(),Object(r["createElementBlock"])("iframe",{key:0,id:"recordingPlayer",ref:"recordingPlayer",onLoad:t[11]||(t[11]=function(t){return e.onLoaded()}),scrolling:"no",sandbox:"allow-scripts allow-same-origin",referrerpolicy:"no-referrer",src:e.embedUrl,width:e.recording.viewport_w_px,height:e.recording.viewport_h_px},null,40,lt)):Object(r["createCommentVNode"])("",!0)],4)],4)])}function dt(e){return dt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dt(e)}function ut(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mt=20,pt=1,ht=2,gt=3,ft=4,bt=5,vt=6,yt=9,Ot=10,jt=12,St=(fe={},ut(fe,ht,"clickEvent"),ut(fe,pt,"moveEvent"),ut(fe,gt,"scrollEvent"),ut(fe,jt,"scrollEvent"),ut(fe,ft,"resizeEvent"),ut(fe,yt,"formChange"),ut(fe,Ot,"formChange"),ut(fe,bt,"mutationEvent"),ut(fe,vt,"mutationEvent"),fe),_t=(be={},ut(be,ht,Object(I["translate"])("HeatmapSessionRecording_ActivityClick")),ut(be,pt,Object(I["translate"])("HeatmapSessionRecording_ActivityMove")),ut(be,gt,Object(I["translate"])("HeatmapSessionRecording_ActivityScroll")),ut(be,jt,Object(I["translate"])("HeatmapSessionRecording_ActivityScroll")),ut(be,ft,Object(I["translate"])("HeatmapSessionRecording_ActivityResize")),ut(be,yt,Object(I["translate"])("HeatmapSessionRecording_ActivityFormChange")),ut(be,Ot,Object(I["translate"])("HeatmapSessionRecording_ActivityFormChange")),ut(be,bt,Object(I["translate"])("HeatmapSessionRecording_ActivityPageChange")),ut(be,vt,Object(I["translate"])("HeatmapSessionRecording_ActivityPageChange")),be),Ht='\n<div class="mousePointer" style="width: 16px;height: 16px;position: absolute;z-index: 99999999;">\n    <svg enable-background="new 0 0 24 24" fill="black" stroke="white" version="1.0"\n        viewBox="0 0 24 24" xml:space="preserve" xmlns="http://www.w3.org/2000/svg"\n        xmlns:xlink="http://www.w3.org/1999/xlink">\n        <path d="M7,2l12,11.2l-5.8,0.5l3.3,7.3l-2.2,1l-3.2-7.4L7,18.5V2"/>\n    </svg>\n</div>\n',Vt=window,Nt=Vt.$,wt=Vt.Mousetrap;function Et(e){return"number"===typeof e?e:parseInt(e,10)}function kt(e){if(null!==e&&void 0!==e&&e.event_type)return Et(e.event_type)}function Rt(e){var t=Math.floor(e/1e3),n=Math.floor(t/60),a=t%60;return n<10&&(n="0".concat(n)),a<10&&(a="0".concat(a)),"".concat(n,":").concat(a)}var Ct=Object(r["defineComponent"])({props:{offsetAccuracy:{type:Number,required:!0},scrollAccuracy:{type:Number,required:!0},autoPlayEnabled:Boolean,skipPausesEnabled:Boolean,replaySpeed:{type:Number,default:1}},data:function(){return{isPlaying:!1,progress:0,isFinished:!1,isLoading:!0,seekTimeout:null,lastFramePainted:0,recording:JSON.parse(JSON.stringify(window.sessionRecordingData)),positionPretty:"00:00",previousRecordingId:null,previousRecordingInfo:null,nextRecordingId:null,nextRecordingInfo:null,frame:0,hasFoundPrevious:!1,hasFoundNext:!1,videoPlayerInterval:null,lastCanvasCoordinates:!1,actualAutoPlayEnabled:!!this.autoPlayEnabled,replayWidth:0,replayHeight:0,replayScale:0,replayMarginLeft:0,seek:function(e){return e},actualSkipPausesEnabled:!!this.skipPausesEnabled,actualReplaySpeed:this.replaySpeed}},setup:function(){var e=Object(r["ref"])(!1),t=null,n=new Promise((function(n){t=n,e.value=!0})),a=function(){setTimeout((function(){t("loaded")}),500)};return{iframeLoadedPromise:n,onLoaded:a,iframeLoaded:e}},created:function(){var e=this;this.recording.duration=Et(this.recording.duration),this.recording.pageviews.forEach((function(t){t&&t.idloghsr&&("".concat(t.idloghsr)==="".concat(e.recording.idLogHsr)?e.hasFoundPrevious=!0:e.hasFoundPrevious?e.hasFoundNext||(e.hasFoundNext=!0,e.nextRecordingId=t.idloghsr,e.nextRecordingInfo=[t.label,t.server_time_pretty,t.time_on_page_pretty].join(" - ")):(e.previousRecordingId=t.idloghsr,e.previousRecordingInfo=[t.label,t.server_time_pretty,t.time_on_page_pretty].join(" - ")))}))},mounted:function(){var e=this;wt.bind(["space","k"],(function(){e.togglePlay()})),wt.bind("0",(function(){e.isFinished&&e.replay()})),wt.bind("p",(function(){e.loadNewRecording(e.previousRecordingId)})),wt.bind("n",(function(){e.loadNewRecording(e.nextRecordingId)})),wt.bind("s",(function(){e.increaseReplaySpeed()})),wt.bind("a",(function(){e.toggleAutoPlay()})),wt.bind("b",(function(){e.toggleSkipPauses()})),wt.bind("left",(function(){var t=5,n=!1;e.jumpRelative(t,n)})),wt.bind("right",(function(){var t=5,n=!0;e.jumpRelative(t,n)})),wt.bind("j",(function(){var t=10,n=!1;e.jumpRelative(t,n)})),wt.bind("l",(function(){var t=10,n=!0;e.jumpRelative(t,n)})),this.initViewport(),Nt(window).on("resize",(function(){return e.initViewport()})),this.iframeLoadedPromise.then((function(){e.initPlayer()})),window.addEventListener("beforeunload",(function(){e.isPlaying=!1,e.videoPlayerInterval&&(clearInterval(e.videoPlayerInterval),e.videoPlayerInterval=null)}))},methods:{initPlayer:function(){var e=this,t=this.$refs.recordingPlayer,n=F(t).recordingFrame;if(n&&n.isSupportedBrowser()){n.addClass("html","piwikSessionRecording"),n.addClass("html","matomoSessionRecording");var a=null,i=function(t,i){a&&a.css({left:"".concat(t.x-8,"px"),top:"".concat(t.y-8,"px")}),e.lastCanvasCoordinates&&(n.drawLine(e.lastCanvasCoordinates.x,e.lastCanvasCoordinates.y,t.x,t.y,i),e.lastCanvasCoordinates=t)},r=function(t,r){if(e.lastCanvasCoordinates&&a){var o=n.getScrollTop(),s=n.getScrollLeft();n.scrollTo(t,r);var l=r-o,c=t-s,d=c+e.lastCanvasCoordinates.x,u=l+e.lastCanvasCoordinates.y;d<=0&&(d=0),u<=0&&(u=0),i({x:d,y:u},"blue")}else n.scrollTo(t,r)},o=function(e,t,n){null!==e&&void 0!==e&&e.scrollTo?e.scrollTo(t,n):(e.scrollLeft=t,e.scrollTop=n)},s=null,l=function(t){var a=e.isPlaying;e.isPlaying=!1;var i=kt(t),l=null;if(i===pt)t.selector&&(l=n.getCoordinatesInFrame(t.selector,t.x,t.y,e.offsetAccuracy,!1),l&&s(l));else if(i===ht)t.selector&&(l=n.getCoordinatesInFrame(t.selector,t.x,t.y,e.offsetAccuracy,!1),l&&(s(l),n.drawCircle(l.x,l.y,"#ff9407")));else if(i===vt)t.text&&n.applyMutation(t.text);else if(i===gt){var c=n.getIframeHeight(),d=n.getIframeWidth(),u=parseInt("".concat(c/e.scrollAccuracy*Et(t.y)),10),m=parseInt("".concat(d/e.scrollAccuracy*Et(t.x)),10);r(m,u)}else if(i===jt){if(t.selector){var p=n.findElement(t.selector);if(p&&p.length&&p[0]){var h=Math.max(p[0].scrollHeight,p[0].offsetHeight,p.height(),0),g=Math.max(p[0].scrollWidth,p[0].offsetWidth,p.width(),0);if(h&&g){var f=parseInt("".concat(h/e.scrollAccuracy*Et(t.y)),10),b=parseInt("".concat(g/e.scrollAccuracy*Et(t.x)),10);o(p[0],b,f)}}}}else if(i===ft)e.setViewportResolution(t.x,t.y);else if(i===yt){if(t.selector){var v=n.findElement(t.selector);if(v.length){var y=v.attr("type");y&&"file"==="".concat(y).toLowerCase()||v.val(t.text).change()}}}else if(i===Ot&&t.selector){var O=n.findElement(t.selector);O.is("input")?O.prop("checked",1===t.text||"1"===t.text):O.is("select")&&O.val(t.text).change()}e.isPlaying=a};s=function(t){var r=function(){var t=n.getIframeWidth(),a=n.getIframeHeight();n.makeSvg(t,a);for(var i=function(t){if(!e.timeFrameBuckets[t])return{v:void 0};e.timeFrameBuckets[t].forEach((function(n){var a=kt(n);a!==pt&&a!==gt&&a!==jt&&a!==ht||(e.lastFramePainted=t,l(n))}))},r=0;r<=e.frame;r+=mt){var o=i(r);if("object"===dt(o))return o.v}},o=n.getIframeWindow();if(!e.lastCanvasCoordinates){var s=n.getIframeHeight(),c=n.getIframeWidth();return n.appendContent(Ht),a=n.findElement(".mousePointer"),n.makeSvg(c,s),o.removeEventListener("resize",r,!1),o.addEventListener("resize",r,!1),e.lastCanvasCoordinates=t,void a.css({left:"".concat(t.x-8,"px"),top:"".concat(t.y-8,"px")})}var d=n.getScrollTop(),u=n.getScrollLeft();(t.y>d+Et(e.recording.viewport_h_px)||t.y<d)&&n.scrollTo(u,t.y-10),d=n.getScrollTop(),(t.x>u+Et(e.recording.viewport_w_px)||t.x<u)&&n.scrollTo(t.x-10,d),i(t,"#ff9407")},this.seek=function(t){if(e.iframeLoaded){e.isLoading=!0;var a=e.frame,i=function(t){for(var n=function(t){(e.timeFrameBuckets[t]||[]).forEach((function(n){e.lastFramePainted=t,l(n)}))},a=t;a<=e.frame;a+=mt)n(a)};e.isFinished=!1,e.frame=t-t%mt,e.progress=parseFloat(parseFloat("".concat(e.frame/Et(e.recording.duration)*100)).toFixed(2)),e.positionPretty=Rt(e.frame),a>e.frame?(a=0,e.lastCanvasCoordinates=!1,e.initialMutation&&n.initialMutation(e.initialMutation.text),n.scrollTo(0,0),e.setViewportResolution(window.sessionRecordingData.viewport_w_px,window.sessionRecordingData.viewport_h_px),e.seekTimeout&&(clearTimeout(e.seekTimeout),e.seekTimeout=null),function(t){e.seekTimeout=setTimeout((function(){i(t),e.isLoading=!1}),1050)}(a)):(e.seekTimeout&&(clearTimeout(e.seekTimeout),e.seekTimeout=null),i(a),e.isLoading=!1)}},this.isLoading=!1,this.isPlaying=!0;var c=0,d=function(){if(e.isPlaying&&!e.isLoading){c+=1;var t=Et(e.recording.duration);if(e.frame>=t?(e.isPlaying=!1,e.progress=100,e.isFinished=!0,e.positionPretty=e.durationPretty,e.actualAutoPlayEnabled&&e.nextRecordingId&&e.loadNewRecording(e.nextRecordingId)):(e.progress=parseFloat(parseFloat("".concat(e.frame/t*100)).toFixed(2)),20===c&&(c=0,e.positionPretty=Rt(e.frame))),(e.timeFrameBuckets[e.frame]||[]).forEach((function(t){e.lastFramePainted=e.frame,l(t)})),e.actualSkipPausesEnabled&&e.frame-e.lastFramePainted>1800){var n=Object.keys(e.timeFrameBuckets).map((function(e){return parseInt(e,10)}));n=n.sort((function(e,t){return e-t}));var a=n.find((function(t){return t>e.frame})),i=!!a;if(a){var r=a-e.frame>1e3;r&&(e.frame=a-20*mt)}if(!i){var o=t-e.frame>1e3;o&&(e.frame=t-20*mt)}}e.frame+=mt}};this.videoPlayerInterval=setInterval((function(){for(var t=1;t<=e.actualReplaySpeed;t+=1)d()}),mt)}},initViewport:function(){this.replayHeight=Nt(window).height()-48-Nt(".sessionRecording .sessionRecordingHead").outerHeight(!0)-Nt(".sessionRecordingPlayer .controls").outerHeight(!0),this.replayWidth=Nt(window).width()-48;var e=Et(this.recording.viewport_w_px),t=Et(this.recording.viewport_h_px),n=400;this.replayWidth<n&&e>n&&(this.replayWidth=n);var a=400;this.replayHeight<a&&t>a&&(this.replayHeight=a);var i=1,r=1;e>this.replayWidth&&(i=parseFloat(parseFloat("".concat(this.replayWidth/e)).toFixed(4))),t>this.replayHeight&&(r=parseFloat(parseFloat("".concat(this.replayHeight/t)).toFixed(4))),this.replayScale=Math.min(i,r),this.replayMarginLeft=(this.replayWidth-this.replayScale*e)/2},setViewportResolution:function(e,t){this.recording.viewport_w_px=parseInt("".concat(e),10),this.recording.viewport_h_px=parseInt("".concat(t),10),Nt(".recordingWidth").text(e),Nt(".recordingHeight").text(t),this.initViewport()},increaseReplaySpeed:function(){1===this.actualReplaySpeed?this.actualReplaySpeed=2:2===this.actualReplaySpeed?this.actualReplaySpeed=4:4===this.actualReplaySpeed?this.actualReplaySpeed=6:this.actualReplaySpeed=1,this.updateSettings()},updateSettings:function(){I["AjaxHelper"].fetch({module:"HeatmapSessionRecording",action:"saveSessionRecordingSettings",autoplay:this.actualAutoPlayEnabled?1:0,skippauses:this.actualSkipPausesEnabled?1:0,replayspeed:this.actualReplaySpeed},{format:"html"})},toggleAutoPlay:function(){this.actualAutoPlayEnabled=!this.actualAutoPlayEnabled,this.updateSettings()},toggleSkipPauses:function(){this.actualSkipPausesEnabled=!this.actualSkipPausesEnabled,this.updateSettings()},loadNewRecording:function(e){e&&(this.isPlaying=!1,I["MatomoUrl"].updateUrl(Object.assign(Object.assign({},I["MatomoUrl"].urlParsed.value),{},{idLogHsr:parseInt("".concat(e),10),updated:I["MatomoUrl"].urlParsed.value.updated?parseInt(I["MatomoUrl"].urlParsed.value.updated,10)+1:1})))},jumpRelative:function(e,t){var n,a=1e3*e;t?(n=this.frame+a,n>this.recording.duration&&(n=Et(this.recording.duration)-mt)):(n=this.frame-a,n<0&&(n=0)),this.seek(n)},replay:function(){this.isFinished=!1,this.lastFramePainted=0,this.seek(0),this.play()},pause:function(){this.isPlaying=!1},togglePlay:function(){this.isFinished?this.replay():this.isPlaying?this.pause():this.play()},seekEvent:function(e){var t=Nt(e.currentTarget).offset(),n=e.pageX-t.left,a=this.replayWidth,i=n/a,r=Et(this.recording.duration)*i;this.seek(r)},play:function(){this.isPlaying=!0}},computed:{durationPretty:function(){return Rt(Et(this.recording.duration))},embedUrl:function(){return"?".concat(I["MatomoUrl"].stringify({module:"HeatmapSessionRecording",action:"embedPage",idSite:this.recording.idSite,idLogHsr:this.recording.idLogHsr,idSiteHsr:this.recording.idSiteHsr,token_auth:I["MatomoUrl"].urlParsed.value.token_auth||void 0}))},skipPreviousButtonTitle:function(){return Object(I["translate"])("HeatmapSessionRecording_PlayerPageViewPrevious",this.previousRecordingInfo||"","P")},skipPausesEnabledText:function(){return this.actualSkipPausesEnabled?Object(I["translate"])("HeatmapSessionRecording_disable"):Object(I["translate"])("HeatmapSessionRecording_enable")},autoplayEnabledText:function(){return this.actualAutoPlayEnabled?Object(I["translate"])("HeatmapSessionRecording_disable"):Object(I["translate"])("HeatmapSessionRecording_enable")},recordingEvents:function(){return this.recording?this.recording.events.map((function(e){var t=kt(e),n=e.text;return t!==bt&&t!==vt||"string"!==typeof n||(n=JSON.parse(n)),Object.assign(Object.assign({},e),{},{text:n})})):[]},initialMutation:function(){var e=this.recordingEvents.find((function(e){var t=kt(e),n=t===bt||t===vt,a=n&&(t===bt||!e.time_since_load||"0"===e.time_since_load);return a}));return e},timeFrameBuckets:function(){var e=this,t={};return this.recordingEvents.forEach((function(n){if(n!==e.initialMutation){var a=Math.round(Et(n.time_since_load)/mt)*mt;t[a]=t[a]||[],t[a].push(n)}})),t},clues:function(){var e=this,t=[];return this.recordingEvents.forEach((function(n){if(n!==e.initialMutation){var a=kt(n),i=St[a]||"",r=_t[a]||"";if(i){if((0===n.time_since_load||"0"===n.time_since_load)&&"moveEvent"===i)return;t.push({left:parseFloat("".concat(Et(n.time_since_load)/Et(e.recording.duration)*100)).toFixed(2),type:i,title:r})}}})),t}}});Ct.render=ct;var xt=Ct,Tt={class:"form-group hsrTargetTest"},Dt={class:"loadingPiwik loadingMatchingSteps"},Mt=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif",alt:""},null,-1),Pt=Object(r["createElementVNode"])("div",{id:"hsrTargetValidationError"},null,-1);function At(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Tt,[Object(r["createElementVNode"])("label",null,[Object(r["createElementVNode"])("strong",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestTitle"))+":",1),Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestLabel")),1)]),Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"text",id:"urltargettest",placeholder:"http://www.example.com/","onUpdate:modelValue":t[0]||(t[0]=function(t){return e.url=t}),class:Object(r["normalizeClass"])({invalid:e.url&&!e.matches&&e.isValid})},null,2),[[r["vModelText"],e.url]]),Object(r["createElementVNode"])("div",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"testInfo"},Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestErrorInvalidUrl")),513),[[r["vShow"],e.url&&!e.isValid]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"testInfo matches"},Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestUrlMatches")),513),[[r["vShow"],e.url&&e.matches&&e.isValid]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"testInfo notMatches"},Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPageTestUrlNotMatches")),513),[[r["vShow"],e.url&&!e.matches&&e.isValid]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",Dt,[Mt,Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)],512),[[r["vShow"],e.isLoadingTestMatchPage]])]),Pt])}function Bt(e){return e.indexOf("://")>3}var Ut=Object(r["defineComponent"])({props:{includedTargets:Array},data:function(){return{url:"",matches:!1,isLoadingTestMatchPage:!1}},watch:{isValid:function(e){e||(this.matches=!1)},includedTargets:function(){this.runTest()},url:function(){this.runTest()}},setup:function(){return{testUrlMatchPages:W("HeatmapSessionRecording.testUrlMatchPages",{errorElement:"#hsrTargetValidationError"})}},created:function(){this.runTest=Object(I["debounce"])(this.runTest,200)},methods:{checkIsMatchingUrl:function(){var e=this;if(this.isValid){var t=this.targetUrl,n=this.filteredIncludedTargets;null!==n&&void 0!==n&&n.length&&(this.isLoadingTestMatchPage=!0,this.testUrlMatchPages({url:t},{matchPageRules:n}).then((function(t){var n;null!==(n=e.filteredIncludedTargets)&&void 0!==n&&n.length&&(null===t||void 0===t?void 0:t.url)===e.targetUrl&&(e.matches=t.matches)})).finally((function(){e.isLoadingTestMatchPage=!1})))}},runTest:function(){this.isValid&&this.checkIsMatchingUrl()}},computed:{targetUrl:function(){return(this.url||"").trim()},isValid:function(){return this.targetUrl&&Bt(this.targetUrl)},filteredIncludedTargets:function(){if(this.includedTargets)return this.includedTargets.filter((function(e){return(null===e||void 0===e?void 0:e.value)||"any"===(null===e||void 0===e?void 0:e.type)})).map((function(e){return Object.assign(Object.assign({},e),{},{value:e.value?e.value.trim():""})}))}}});Ut.render=At;var It=Ut,Lt={style:{width:"100%"}},Ft={name:"targetAttribute"},Wt={name:"targetType"},qt={name:"targetValue"},zt={name:"targetValue2"},Gt=["title"],$t=["title"];function Jt(e,t,n,a,i,o){var s=Object(r["resolveComponent"])("Field");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])(["form-group hsrUrltarget valign-wrapper",{disabled:e.disableIfNoValue&&!e.modelValue.value}])},[Object(r["createElementVNode"])("div",Lt,[Object(r["createElementVNode"])("div",Ft,[Object(r["createVNode"])(s,{uicontrol:"select",name:"targetAttribute","model-value":e.modelValue.attribute,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{attribute:t}))}),title:e.translate("HeatmapSessionRecording_Rule"),options:e.targetAttributes,"full-width":!0},null,8,["model-value","title","options"])]),Object(r["createElementVNode"])("div",Wt,[Object(r["createVNode"])(s,{uicontrol:"select",name:"targetType","model-value":e.pattern_type,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.onTypeChange(t)}),options:e.targetOptions[e.modelValue.attribute],"full-width":!0},null,8,["model-value","options"])]),Object(r["createElementVNode"])("div",qt,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"targetValue",placeholder:"eg. ".concat(e.targetExamples[e.modelValue.attribute]),"model-value":e.modelValue.value,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{value:t.trim()}))}),maxlength:500,"full-width":!0},null,8,["placeholder","model-value"]),[[r["vShow"],"any"!==e.pattern_type]])]),Object(r["createElementVNode"])("div",zt,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"targetValue2","model-value":e.modelValue.value2,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},{value2:t.trim()}))}),maxlength:500,"full-width":!0,placeholder:e.translate("HeatmapSessionRecording_UrlParameterValueToMatchPlaceholder")},null,8,["model-value","placeholder"]),[[r["vShow"],"urlparam"===e.modelValue.attribute&&e.pattern_type&&"exists"!==e.pattern_type&&"not_exists"!==e.pattern_type]])])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-plus valign",title:e.translate("General_Add"),onClick:t[4]||(t[4]=function(t){return e.$emit("addUrl")})},null,8,Gt),[[r["vShow"],e.showAddUrl]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("span",{class:"icon-minus valign",title:e.translate("General_Remove"),onClick:t[5]||(t[5]=function(t){return e.$emit("removeUrl")})},null,8,$t),[[r["vShow"],e.canBeRemoved]])],2)}function Xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Kt(e,t,n){return t&&Yt(e.prototype,t),n&&Yt(e,n),e}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */var Zt=function(){function e(){var t=this;Xt(this,e),Qt(this,"privateState",Object(r["reactive"])({rules:[]})),Qt(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(t.privateState)}))),Qt(this,"rules",Object(r["computed"])((function(){return t.state.value.rules}))),Qt(this,"initPromise",null)}return Kt(e,[{key:"init",value:function(){var e=this;return this.initPromise||(this.initPromise=I["AjaxHelper"].fetch({method:"HeatmapSessionRecording.getAvailableTargetPageRules",filter_limit:"-1"}).then((function(t){return e.privateState.rules=t,e.rules.value}))),this.initPromise}}]),e}(),en=new Zt,tn=Object(r["defineComponent"])({props:{modelValue:{type:Object,required:!0},canBeRemoved:Boolean,disableIfNoValue:Boolean,allowAny:Boolean,showAddUrl:Boolean},components:{Field:L["Field"]},emits:["addUrl","removeUrl","update:modelValue"],created:function(){en.init()},watch:{modelValue:function(e){var t=this;if(e.attribute){var n=this.targetOptions[e.attribute],a=n.find((function(e){return e.key===t.pattern_type}));!a&&n[0]&&this.onTypeChange(n[0].key)}}},computed:{pattern_type:function(){var e=this.modelValue.type;return this.modelValue.inverted&&"0"!==this.modelValue.inverted&&(e="not_".concat(this.modelValue.type)),e},targetAttributes:function(){return en.rules.value.map((function(e){return{key:e.value,value:e.name}}))},targetOptions:function(){var e=this,t={};return en.rules.value.forEach((function(n){t[n.value]=[],e.allowAny&&"url"===n.value&&t[n.value].push({value:Object(I["translate"])("HeatmapSessionRecording_TargetTypeIsAny"),key:"any"}),n.types.forEach((function(e){t[n.value].push({value:e.name,key:e.value}),t[n.value].push({value:Object(I["translate"])("HeatmapSessionRecording_TargetTypeIsNot",e.name),key:"not_".concat(e.value)})}))})),t},targetExamples:function(){var e={};return en.rules.value.forEach((function(t){e[t.value]=t.example})),e}},methods:{onTypeChange:function(e){var t=0,n=e;0===e.indexOf("not_")&&(n=e.substring("not_".length),t=1),this.$emit("update:modelValue",Object.assign(Object.assign({},this.modelValue),{},{type:n,inverted:t}))}}});tn.render=Jt;var nn=tn,an={class:"loadingPiwik"},rn=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),on={class:"loadingPiwik"},sn=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),ln={name:"name"},cn={name:"sampleLimit"},dn={class:"form-group row"},un={class:"col s12"},mn={class:"col s12 m6",style:{"padding-left":"0"}},pn=Object(r["createElementVNode"])("hr",null,null,-1),hn={class:"col s12 m6"},gn={class:"form-help"},fn={class:"inline-help"},bn={name:"sampleRate"},vn={name:"excludedElements"},yn={name:"screenshotUrl"},On={name:"breakpointMobile"},jn={name:"breakpointTablet"},Sn={name:"trackManually"},_n=["innerHTML"],Hn={class:"entityCancel"};function Vn(e,t,n,a,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("HsrUrlTarget"),c=Object(r["resolveComponent"])("HsrTargetTest"),d=Object(r["resolveComponent"])("SaveButton"),u=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createBlock"])(u,{class:"editHsr","content-title":e.contentTitle},{default:Object(r["withCtx"])((function(){return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",an,[rn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",on,[sn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["createElementVNode"])("form",{onSubmit:t[12]||(t[12]=function(t){return e.edit?e.updateHsr():e.createHsr()})},[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",ln,[Object(r["createVNode"])(s,{uicontrol:"text",name:"name","model-value":e.siteHsr.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.siteHsr.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,placeholder:e.translate("HeatmapSessionRecording_FieldNamePlaceholder"),"inline-help":e.translate("HeatmapSessionRecording_HeatmapNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(r["createElementVNode"])("div",cn,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleLimit","model-value":e.siteHsr.sample_limit,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.siteHsr.sample_limit=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_HeatmapSampleLimit"),options:e.sampleLimits,"inline-help":e.translate("HeatmapSessionRecording_HeatmapSampleLimitHelp")},null,8,["model-value","title","options","inline-help"])]),Object(r["createElementVNode"])("div",dn,[Object(r["createElementVNode"])("div",un,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPage"))+":",1)]),Object(r["createElementVNode"])("div",mn,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.siteHsr.match_page_rules,(function(n,a){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])("matchPageRules ".concat(a," multiple")),key:a},[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"model-value":n,"onUpdate:modelValue":function(t){return e.setMatchPageRule(t,a)},onAddUrl:t[2]||(t[2]=function(t){return e.addMatchPageRule()}),onRemoveUrl:function(t){return e.removeMatchPageRule(a)},onAnyChange:t[3]||(t[3]=function(t){return e.setValueHasChanged()}),"allow-any":!1,"disable-if-no-value":a>0,"can-be-removed":a>0,"show-add-url":!0},null,8,["model-value","onUpdate:modelValue","onRemoveUrl","disable-if-no-value","can-be-removed"])]),pn],2)})),128))]),Object(r["createElementVNode"])("div",hn,[Object(r["createElementVNode"])("div",gn,[Object(r["createElementVNode"])("span",fn,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_FieldIncludedTargetsHelp"))+" ",1),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"included-targets":e.siteHsr.match_page_rules},null,8,["included-targets"])])])])])]),Object(r["createElementVNode"])("div",bn,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleRate","model-value":e.siteHsr.sample_rate,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.siteHsr.sample_rate=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SampleRate"),options:e.sampleRates,introduction:e.translate("HeatmapSessionRecording_AdvancedOptions"),"inline-help":e.translate("HeatmapSessionRecording_HeatmapSampleRateHelp")},null,8,["model-value","title","options","introduction","inline-help"])]),Object(r["createElementVNode"])("div",vn,[Object(r["createVNode"])(s,{uicontrol:"text",name:"excludedElements","model-value":e.siteHsr.excluded_elements,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.siteHsr.excluded_elements=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_ExcludedElements"),maxlength:1e3,"inline-help":e.translate("HeatmapSessionRecording_ExcludedElementsHelp")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",yn,[Object(r["createVNode"])(s,{uicontrol:"text",name:"screenshotUrl","model-value":e.siteHsr.screenshot_url,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.siteHsr.screenshot_url=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_ScreenshotUrl"),maxlength:300,disabled:!!e.siteHsr.page_treemirror,"inline-help":e.translate("HeatmapSessionRecording_ScreenshotUrlHelp")},null,8,["model-value","title","disabled","inline-help"])]),Object(r["createElementVNode"])("div",On,[Object(r["createVNode"])(s,{uicontrol:"text",name:"breakpointMobile","model-value":e.siteHsr.breakpoint_mobile,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.siteHsr.breakpoint_mobile=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_BreakpointX",e.translate("General_Mobile")),maxlength:4,"inline-help":e.breakpointMobileInlineHelp},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",jn,[Object(r["createVNode"])(s,{uicontrol:"text",name:"breakpointTablet","model-value":e.siteHsr.breakpoint_tablet,"onUpdate:modelValue":t[8]||(t[8]=function(t){e.siteHsr.breakpoint_tablet=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_BreakpointX",e.translate("DevicesDetection_Tablet")),maxlength:4,"inline-help":e.breakpointGeneralHelp},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",Sn,[Object(r["createVNode"])(s,{uicontrol:"checkbox",name:"capture_manually",title:e.translate("HeatmapSessionRecording_CaptureDomTitle"),"inline-help":e.captureDomInlineHelp,"model-value":e.siteHsr.capture_manually,"onUpdate:modelValue":t[9]||(t[9]=function(t){e.siteHsr.capture_manually=t,e.setValueHasChanged()})},null,8,["title","inline-help","model-value"])]),Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.personalInformationNote)},null,8,_n),Object(r["createVNode"])(d,{class:"createButton",onConfirm:t[10]||(t[10]=function(t){return e.edit?e.updateHsr():e.createHsr()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),Object(r["createElementVNode"])("div",Hn,[Object(r["createElementVNode"])("a",{onClick:t[11]||(t[11]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]})),_:1},8,["content-title"])}function Nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function En(e,t,n){return t&&wn(e.prototype,t),n&&wn(e,n),e}function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */var Rn=function(){function e(t){var n=this;Nn(this,e),kn(this,"context",void 0),kn(this,"privateState",Object(r["reactive"])({allHsrs:[],isLoading:!1,isUpdating:!1,filterStatus:""})),kn(this,"state",Object(r["computed"])((function(){return Object(r["readonly"])(n.privateState)}))),kn(this,"hsrs",Object(r["computed"])((function(){return n.privateState.filterStatus?n.state.value.allHsrs.filter((function(e){return e.status===n.privateState.filterStatus})):n.state.value.allHsrs}))),kn(this,"hsrsCloned",Object(r["computed"])((function(){return Object(I["clone"])(n.hsrs.value)}))),kn(this,"statusOptions",Object(r["readonly"])([{key:"",value:Object(I["translate"])("General_All")},{key:"active",value:Object(I["translate"])("HeatmapSessionRecording_StatusActive")},{key:"ended",value:Object(I["translate"])("HeatmapSessionRecording_StatusEnded")},{key:"paused",value:Object(I["translate"])("HeatmapSessionRecording_StatusPaused")}])),kn(this,"fetchPromises",{}),this.context=t}return En(e,[{key:"setFilterStatus",value:function(e){this.privateState.filterStatus=e}},{key:"reload",value:function(){return this.privateState.allHsrs=[],this.fetchPromises={},this.fetchHsrs()}},{key:"filterRules",value:function(e){return e.filter((function(e){return!!e&&(e.value||"any"===e.type)}))}},{key:"getApiMethodInContext",value:function(e){return"".concat(e).concat(this.context)}},{key:"fetchHsrs",value:function(){var e=this,t="HeatmapSessionRecording.getHeatmaps";"SessionRecording"===this.context&&(t="HeatmapSessionRecording.getSessionRecordings");var n={method:t,filter_limit:"-1"};return this.fetchPromises[t]||(this.fetchPromises[t]=I["AjaxHelper"].fetch(n)),this.privateState.isLoading=!0,this.privateState.allHsrs=[],this.fetchPromises[t].then((function(t){return e.privateState.allHsrs=t,e.state.value.allHsrs})).finally((function(){e.privateState.isLoading=!1}))}},{key:"findHsr",value:function(e){var t=this,n=this.state.value.allHsrs.find((function(t){return t.idsitehsr===e}));return n?Promise.resolve(n):(this.privateState.isLoading=!0,I["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.get"),filter_limit:"-1"}).finally((function(){t.privateState.isLoading=!1})))}},{key:"deleteHsr",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.allHsrs=[],I["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.delete")},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"completeHsr",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.allHsrs=[],I["AjaxHelper"].fetch({idSiteHsr:e,method:this.getApiMethodInContext("HeatmapSessionRecording.end")},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){t.privateState.isUpdating=!1}))}},{key:"createOrUpdateHsr",value:function(e,t){var n=this,a={idSiteHsr:e.idsitehsr,sampleLimit:e.sample_limit,sampleRate:e.sample_rate,excludedElements:e.excluded_elements?e.excluded_elements.trim():void 0,screenshotUrl:e.screenshot_url?e.screenshot_url.trim():void 0,breakpointMobile:e.breakpoint_mobile,breakpointTablet:e.breakpoint_tablet,minSessionTime:e.min_session_time,requiresActivity:e.requires_activity?1:0,captureKeystrokes:e.capture_keystrokes?1:0,captureDomManually:e.capture_manually?1:0,method:t,name:e.name.trim()},i={matchPageRules:this.filterRules(e.match_page_rules)};return this.privateState.isUpdating=!0,I["AjaxHelper"].post(a,i,{withTokenInUrl:!0}).then((function(e){return{type:"success",response:e}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){n.privateState.isUpdating=!1}))}}]),e}(),Cn=new Rn("Heatmap"),xn=new Rn("SessionRecording");function Tn(e){return An(e)||Pn(e)||Mn(e)||Dn()}function Dn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mn(e,t){if(e){if("string"===typeof e)return Bn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bn(e,t):void 0}}function Pn(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function An(e){if(Array.isArray(e))return Bn(e)}function Bn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Un="hsrmanagement",In=Object(r["defineComponent"])({props:{idSiteHsr:Number,breakpointMobile:Number,breakpointTablet:Number},components:{ContentBlock:I["ContentBlock"],Field:L["Field"],HsrUrlTarget:nn,HsrTargetTest:It,SaveButton:L["SaveButton"]},data:function(){return{isDirty:!1,showAdvancedView:!1,siteHsr:{}}},created:function(){this.init()},watch:{idSiteHsr:function(e){null!==e&&this.init()}},methods:{removeAnyHsrNotification:function(){I["NotificationsStore"].remove(Un),I["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=I["NotificationsStore"].show({message:e,context:t,id:Un,type:"transient"});setTimeout((function(){I["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(I["translate"])("HeatmapSessionRecording_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idSiteHsr;if(this.siteHsr={},this.showAdvancedView=!1,I["Matomo"].helper.lazyScrollToContent(),this.edit&&t)Cn.findHsr(t).then((function(t){t&&(e.siteHsr=Object(I["clone"])(t),e.siteHsr.sample_rate="".concat(e.siteHsr.sample_rate),e.addInitialMatchPageRule(),e.isDirty=!1)}));else if(this.create){this.siteHsr={idSite:I["Matomo"].idSite,name:"",sample_rate:"10.0",sample_limit:1e3,breakpoint_mobile:this.breakpointMobile,breakpoint_tablet:this.breakpointTablet,capture_manually:0},this.isDirty=!1;var n=I["MatomoUrl"].hashParsed.value;if(n.name&&(this.siteHsr.name=n.name,this.isDirty=!0),n.matchPageRules)try{this.siteHsr.match_page_rules=JSON.parse(n.matchPageRules),this.isDirty=!0}catch(a){console.log("warning: could not parse matchPageRules query param, expected JSON")}else this.addInitialMatchPageRule()}},addInitialMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||this.addMatchPageRule())},addMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[]),this.siteHsr.match_page_rules.push({attribute:"url",type:"equals_simple",value:"",inverted:0}),this.isDirty=!0)},removeMatchPageRule:function(e){this.siteHsr&&e>-1&&(this.siteHsr.match_page_rules=Tn(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules.splice(e,1),this.isDirty=!0)},cancel:function(){var e=Object.assign({},I["MatomoUrl"].hashParsed.value);delete e.idSiteHsr,I["MatomoUrl"].updateHash(e)},createHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&Cn.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.addHeatmap").then((function(t){if(t&&"error"!==t.type&&t.response){e.isDirty=!1;var n=t.response.value;Cn.reload().then((function(){I["Matomo"].helper.isReportingPage()&&I["Matomo"].postEvent("updateReportingMenu"),I["MatomoUrl"].updateHash(Object.assign(Object.assign({},I["MatomoUrl"].hashParsed.value),{},{idSiteHsr:n})),setTimeout((function(){e.showNotification(Object(I["translate"])("HeatmapSessionRecording_HeatmapCreated"),t.type)}),200)}))}}))},setValueHasChanged:function(){this.isDirty=!0},updateHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&Cn.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.updateHeatmap").then((function(t){"error"!==t.type&&(e.isDirty=!1,e.siteHsr={},Cn.reload().then((function(){e.init()})),e.showNotification(Object(I["translate"])("HeatmapSessionRecording_HeatmapUpdated"),t.type))}))},checkRequiredFieldsAreSet:function(){var e;if(!this.siteHsr.name){var t=Object(I["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(t),!1}if(null===(e=this.siteHsr.match_page_rules)||void 0===e||!e.length||!Cn.filterRules(this.siteHsr.match_page_rules).length){var n=Object(I["translate"])("HeatmapSessionRecording_ErrorPageRuleRequired");return this.showNotification(n,"error"),!1}return!0},setMatchPageRule:function(e,t){this.siteHsr.match_page_rules=Tn(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules[t]=e}},computed:{sampleLimits:function(){return[1e3,2e3,5e3].map((function(e){return{key:"".concat(e),value:e}}))},sampleRates:function(){var e=[.1,.5,1,2,3,4,5,6,8,10,15,20,30,40,50,60,70,80,90,100];return e.map((function(e){return{key:e.toFixed(1),value:"".concat(e,"%")}}))},create:function(){return!this.idSiteHsr},edit:function(){return!this.create},editTitle:function(){var e=this.create?"HeatmapSessionRecording_CreateNewHeatmap":"HeatmapSessionRecording_EditHeatmapX";return e},contentTitle:function(){return Object(I["translate"])(this.editTitle,this.siteHsr.name?'"'.concat(this.siteHsr.name,'"'):"")},isLoading:function(){return Cn.state.value.isLoading},isUpdating:function(){return Cn.state.value.isUpdating},breakpointMobileInlineHelp:function(){var e=Object(I["translate"])("HeatmapSessionRecording_BreakpointGeneralHelp"),t=Object(I["translate"])("HeatmapSessionRecording_BreakpointGeneralHelpManage");return"".concat(e," ").concat(t)},breakpointGeneralHelp:function(){var e=Object(I["translate"])("HeatmapSessionRecording_BreakpointGeneralHelp"),t=Object(I["translate"])("HeatmapSessionRecording_BreakpointGeneralHelpManage");return"".concat(e," ").concat(t)},captureDomInlineHelp:function(){var e=this.idSiteHsr?this.idSiteHsr:"{idHeatmap}",t="<br><br><strong>_paq.push(['HeatmapSessionRecording::captureInitialDom', ".concat(e,"])</strong>");return Object(I["translate"])("HeatmapSessionRecording_CaptureDomInlineHelp",t,"<br><br><strong>","</strong>")},personalInformationNote:function(){var e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-content-on-your-website";return Object(I["translate"])("HeatmapSessionRecording_PersonalInformationNote",Object(I["translate"])("HeatmapSessionRecording_Heatmap"),"<code>","</code>",'<a href="'.concat(e,'" target="_blank" rel="noreferrer noopener">'),"</a>")},saveButtonText:function(){return this.edit?Object(I["translate"])("CoreUpdater_UpdateTitle"):Object(I["translate"])("HeatmapSessionRecording_CreateNewHeatmap")}}});In.render=Vn;var Ln=In,Fn={class:"heatmapList"},Wn={class:"filterStatus"},qn={class:"hsrSearchFilter",style:{"margin-left":"3.5px"}},zn={class:"index"},Gn={class:"name"},$n={class:"creationDate"},Jn={class:"sampleLimit"},Xn={class:"status"},Yn={class:"action"},Kn={colspan:"7"},Qn={class:"loadingPiwik"},Zn=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),ea={colspan:"7"},ta=["id"],na={class:"index"},aa={class:"name"},ia={class:"creationDate"},ra={class:"sampleLimit"},oa={key:0,class:"status status-paused"},sa=["title"],la={key:1,class:"status"},ca={class:"action"},da=["title","onClick"],ua=["title","onClick"],ma=["title","href"],pa=["title","onClick"],ha={class:"tableActionBar"},ga=Object(r["createElementVNode"])("span",{class:"icon-add"},null,-1),fa={class:"ui-confirm",id:"confirmDeleteHeatmap",ref:"confirmDeleteHeatmap"},ba=["value"],va=["value"],ya={class:"ui-confirm",id:"confirmEndHeatmap",ref:"confirmEndHeatmap"},Oa=["value"],ja=["value"];function Sa(e,t,n,a,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("ContentBlock"),c=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Fn,[Object(r["createVNode"])(l,{"content-title":e.translate("HeatmapSessionRecording_ManageHeatmaps")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapUsageBenefits")),1),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",Wn,[Object(r["createVNode"])(s,{uicontrol:"select",name:"filterStatus","model-value":e.filterStatus,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.setFilterStatus(t)}),title:e.translate("HeatmapSessionRecording_Filter"),"full-width":!0,options:e.statusOptions},null,8,["model-value","title","options"])]),Object(r["createElementVNode"])("div",qn,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"hsrSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchFilter=t}),"full-width":!0},null,8,["title","modelValue"]),[[r["vShow"],e.hsrs.length>0]])])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",zn,Object(r["toDisplayString"])(e.translate("General_Id")),1),Object(r["createElementVNode"])("th",Gn,Object(r["toDisplayString"])(e.translate("General_Name")),1),Object(r["createElementVNode"])("th",$n,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreationDate")),1),Object(r["createElementVNode"])("th",Jn,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_SampleLimit")),1),Object(r["createElementVNode"])("th",Xn,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(r["createElementVNode"])("th",Yn,Object(r["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Kn,[Object(r["createElementVNode"])("span",Qn,[Zn,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",ea,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_NoHeatmapsFound")),1)],512),[[r["vShow"],!e.isLoading&&0===e.hsrs.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedHsrs,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"hsr".concat(t.idsitehsr),class:"hsrs",key:t.idsitehsr},[Object(r["createElementVNode"])("td",na,Object(r["toDisplayString"])(t.idsitehsr),1),Object(r["createElementVNode"])("td",aa,Object(r["toDisplayString"])(t.name),1),Object(r["createElementVNode"])("td",ia,Object(r["toDisplayString"])(t.created_date_pretty),1),Object(r["createElementVNode"])("td",ra,Object(r["toDisplayString"])(t.sample_limit),1),"paused"===t.status?(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",oa,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.ucfirst(t.status))+" ",1),Object(r["createElementVNode"])("span",{class:"icon icon-help",title:e.pauseReason},null,8,sa)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",la,Object(r["toDisplayString"])(e.ucfirst(t.status)),1)),Object(r["createElementVNode"])("td",ca,[Object(r["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("HeatmapSessionRecording_EditX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:function(n){return e.editHsr(t.idsitehsr)}},null,8,da),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{a:"",class:"table-action stopRecording icon-drop-crossed",title:e.translate("HeatmapSessionRecording_StopX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:function(n){return e.completeHsr(t)}},null,8,ua),[[r["vShow"],"ended"!==t.status]]),Object(r["createElementVNode"])("a",{target:"_blank",class:"table-action icon-show",title:e.translate("HeatmapSessionRecording_ViewReport"),href:e.getViewReportLink(t)},null,8,ma),Object(r["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("HeatmapSessionRecording_DeleteX",e.translate("HeatmapSessionRecording_Heatmap")),onClick:function(n){return e.deleteHsr(t)}},null,8,pa)])],8,ta)})),128))])],512),[[c]]),Object(r["createElementVNode"])("div",ha,[Object(r["createElementVNode"])("a",{class:"createNewHsr",value:"",onClick:t[2]||(t[2]=function(t){return e.createHsr()})},[ga,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreateNewHeatmap")),1)])])]})),_:1},8,["content-title"]),Object(r["createElementVNode"])("div",fa,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteHeatmapConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ba),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,va)],512),Object(r["createElementVNode"])("div",ya,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_EndHeatmapConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Oa),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,ja)],512)])}function _a(e){return wa(e)||Na(e)||Va(e)||Ha()}function Ha(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Va(e,t){if(e){if("string"===typeof e)return Ea(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ea(e,t):void 0}}function Na(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function wa(e){if(Array.isArray(e))return Ea(e)}function Ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ka=Object(r["defineComponent"])({props:{pauseReason:String},components:{ContentBlock:I["ContentBlock"],Field:L["Field"]},directives:{ContentTable:I["ContentTable"]},data:function(){return{searchFilter:""}},created:function(){Cn.setFilterStatus(""),Cn.fetchHsrs()},methods:{createHsr:function(){this.editHsr(0)},editHsr:function(e){I["MatomoUrl"].updateHash(Object.assign(Object.assign({},I["MatomoUrl"].hashParsed.value),{},{idSiteHsr:e}))},deleteHsr:function(e){I["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteHeatmap,{yes:function(){Cn.deleteHsr(e.idsitehsr).then((function(){Cn.reload(),I["Matomo"].postEvent("updateReportingMenu")}))}})},completeHsr:function(e){I["Matomo"].helper.modalConfirm(this.$refs.confirmEndHeatmap,{yes:function(){Cn.completeHsr(e.idsitehsr).then((function(){Cn.reload()}))}})},setFilterStatus:function(e){Cn.setFilterStatus(e)},ucfirst:function(e){return"".concat(e[0].toUpperCase()).concat(e.substr(1))},getViewReportLink:function(e){return"?".concat(I["MatomoUrl"].stringify({module:"Widgetize",action:"iframe",moduleToWidgetize:"HeatmapSessionRecording",actionToWidgetize:"showHeatmap",idSiteHsr:e.idsitehsr,idSite:e.idsite,period:"day",date:"yesterday"}))}},computed:{filterStatus:function(){return Cn.state.value.filterStatus},statusOptions:function(){return Cn.statusOptions},hsrs:function(){return Cn.hsrs.value},isLoading:function(){return Cn.state.value.isLoading},isUpdating:function(){return Cn.state.value.isUpdating},sortedHsrs:function(){var e=this,t=_a(this.hsrs).filter((function(t){return Object.keys(t).some((function(n){var a=t;return"string"===typeof a[n]&&-1!==a[n].indexOf(e.searchFilter)}))}));return t.sort((function(e,t){return t.idsitehsr-e.idsitehsr})),t}}});ka.render=Sa;var Ra=ka,Ca={class:"manageHsr",ref:"root"},xa={key:0},Ta={key:1};function Da(e,t,n,a,i,o){var s=Object(r["resolveComponent"])("MatomoJsNotWritableAlert"),l=Object(r["resolveComponent"])("HeatmapList"),c=Object(r["resolveComponent"])("HeatmapEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:0,"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_Heatmaps")},null,8,["is-matomo-js-writable","recording-type"])),Object(r["createElementVNode"])("div",Ca,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",xa,[Object(r["createVNode"])(l,{"pause-reason":e.pauseReason},null,8,["pause-reason"])])),e.editMode?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Ta,[Object(r["createVNode"])(c,{"breakpoint-mobile":e.breakpointMobile,"breakpoint-tablet":e.breakpointTablet,"id-site-hsr":e.idSiteHsr},null,8,["breakpoint-mobile","breakpoint-tablet","id-site-hsr"])])):Object(r["createCommentVNode"])("",!0)],512)],64)}var Ma=["innerHTML"];function Pa(e,t,n,a,i,o){return e.isMatomoJsWritable?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{key:0,class:"alert alert-warning",innerHTML:e.getJsNotWritableErrorMessage()},null,8,Ma))}var Aa=Object(r["defineComponent"])({props:{recordingType:{type:String,required:!0},isMatomoJsWritable:{type:Boolean,required:!0}},methods:{getJsNotWritableErrorMessage:function(){return Object(I["translate"])("HeatmapSessionRecording_MatomoJSNotWritableErrorMessage",this.recordingType,'<a href="https://developer.matomo.org/guides/heatmap-session-recording/setup#when-the-matomojs-in-your-piwik-directory-file-is-not-writable" target="_blank" rel="noreferrer noopener">',"</a>")}}});Aa.render=Pa;var Ba=Aa,Ua=window,Ia=Ua.$,La=Object(r["defineComponent"])({props:{breakpointMobile:Number,breakpointTablet:Number,pauseReason:String,isMatomoJsWritable:{type:Boolean,required:!0}},data:function(){return{editMode:!1,idSiteHsr:null}},components:{MatomoJsNotWritableAlert:Ba,HeatmapList:Ra,HeatmapEdit:Ln},watch:{editMode:function(){Ia(".ui-tooltip").remove()}},created:function(){var e=this;Object(r["watch"])((function(){return I["MatomoUrl"].hashParsed.value.idSiteHsr}),(function(t){e.initState(t)})),this.initState(I["MatomoUrl"].hashParsed.value.idSiteHsr)},methods:{removeAnyHsrNotification:function(){I["NotificationsStore"].remove("hsrmanagement")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(I["Matomo"].postEvent("HeatmapSessionRecording.initAddHeatmap",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idSiteHsr=null)}this.editMode=!0,this.idSiteHsr=parseInt(e,10)}else this.editMode=!1,this.idSiteHsr=null;this.removeAnyHsrNotification()}}});La.render=Da;var Fa=La,Wa={class:"loadingPiwik"},qa=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),za={class:"loadingPiwik"},Ga=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),$a={name:"name"},Ja={name:"sampleLimit"},Xa={class:"form-group row"},Ya={class:"col s12"},Ka={class:"col s12 m6",style:{"padding-left":"0"}},Qa=Object(r["createElementVNode"])("hr",null,null,-1),Za={class:"col s12 m6"},ei={class:"form-help"},ti={class:"inline-help"},ni={name:"sampleRate"},ai={name:"minSessionTime"},ii={name:"requiresActivity"},ri={class:"inline-help-node"},oi=["innerHTML"],si=["innerHTML"],li={class:"entityCancel"};function ci(e,t,n,a,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("HsrUrlTarget"),c=Object(r["resolveComponent"])("HsrTargetTest"),d=Object(r["resolveComponent"])("SaveButton"),u=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createBlock"])(u,{class:"editHsr","content-title":e.contentTitle},{default:Object(r["withCtx"])((function(){return[Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",Wa,[qa,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[r["vShow"],e.isLoading]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("p",null,[Object(r["createElementVNode"])("span",za,[Ga,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_UpdatingData")),1)])],512),[[r["vShow"],e.isUpdating]]),Object(r["createElementVNode"])("form",{onSubmit:t[10]||(t[10]=function(t){return e.edit?e.updateHsr():e.createHsr()})},[Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",$a,[Object(r["createVNode"])(s,{uicontrol:"text",name:"name","model-value":e.siteHsr.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.siteHsr.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,placeholder:e.translate("HeatmapSessionRecording_FieldNamePlaceholder"),"inline-help":e.translate("HeatmapSessionRecording_SessionNameHelp")},null,8,["model-value","title","placeholder","inline-help"])]),Object(r["createElementVNode"])("div",Ja,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleLimit","model-value":e.siteHsr.sample_limit,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.siteHsr.sample_limit=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SessionSampleLimit"),options:e.sampleLimits,"inline-help":e.translate("HeatmapSessionRecording_SessionSampleLimitHelp")},null,8,["model-value","title","options","inline-help"])]),Object(r["createElementVNode"])("div",Xa,[Object(r["createElementVNode"])("div",Ya,[Object(r["createElementVNode"])("h3",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_TargetPages"))+":",1)]),Object(r["createElementVNode"])("div",Ka,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.siteHsr.match_page_rules,(function(n,a){return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",{class:Object(r["normalizeClass"])("matchPageRules ".concat(a," multiple")),key:a},[Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"model-value":n,"onUpdate:modelValue":function(t){return e.setMatchPageRule(t,a)},onAddUrl:t[2]||(t[2]=function(t){return e.addMatchPageRule()}),onRemoveUrl:function(t){return e.removeMatchPageRule(a)},onAnyChange:t[3]||(t[3]=function(t){return e.setValueHasChanged()}),"allow-any":!0,"disable-if-no-value":a>0,"can-be-removed":a>0,"show-add-url":!0},null,8,["model-value","onUpdate:modelValue","onRemoveUrl","disable-if-no-value","can-be-removed"])]),Qa],2)})),128))]),Object(r["createElementVNode"])("div",Za,[Object(r["createElementVNode"])("div",ei,[Object(r["createElementVNode"])("span",ti,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_FieldIncludedTargetsHelpSessions"))+" ",1),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"included-targets":e.siteHsr.match_page_rules},null,8,["included-targets"])])])])])]),Object(r["createElementVNode"])("div",ni,[Object(r["createVNode"])(s,{uicontrol:"select",name:"sampleRate","model-value":e.siteHsr.sample_rate,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.siteHsr.sample_rate=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_SampleRate"),options:e.sampleRates,introduction:e.translate("HeatmapSessionRecording_AdvancedOptions"),"inline-help":e.translate("HeatmapSessionRecording_SessionSampleRateHelp")},null,8,["model-value","title","options","introduction","inline-help"])]),Object(r["createElementVNode"])("div",ai,[Object(r["createVNode"])(s,{uicontrol:"select",name:"minSessionTime","model-value":e.siteHsr.min_session_time,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.siteHsr.min_session_time=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_MinSessionTime"),options:e.minSessionTimes,"inline-help":e.translate("HeatmapSessionRecording_MinSessionTimeHelp")},null,8,["model-value","title","options","inline-help"])]),Object(r["createElementVNode"])("div",ii,[Object(r["createVNode"])(s,{uicontrol:"checkbox",name:"requiresActivity","model-value":e.siteHsr.requires_activity,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.siteHsr.requires_activity=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_RequiresActivity"),"inline-help":e.translate("HeatmapSessionRecording_RequiresActivityHelp")},null,8,["model-value","title","inline-help"])]),Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(s,{uicontrol:"checkbox",name:"captureKeystrokes","model-value":e.siteHsr.capture_keystrokes,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.siteHsr.capture_keystrokes=t,e.setValueHasChanged()}),title:e.translate("HeatmapSessionRecording_CaptureKeystrokes")},{"inline-help":Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",ri,[Object(r["createElementVNode"])("span",{innerHTML:e.$sanitize(e.captureKeystrokesHelp)},null,8,oi)])]})),_:1},8,["model-value","title"])]),Object(r["createElementVNode"])("p",{innerHTML:e.$sanitize(e.personalInformationNote)},null,8,si),Object(r["createVNode"])(d,{class:"createButton",onConfirm:t[8]||(t[8]=function(t){return e.edit?e.updateHsr():e.createHsr()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),Object(r["createElementVNode"])("div",li,[Object(r["createElementVNode"])("a",{onClick:t[9]||(t[9]=function(t){return e.cancel()})},Object(r["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]})),_:1},8,["content-title"])}function di(e){return hi(e)||pi(e)||mi(e)||ui()}function ui(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function mi(e,t){if(e){if("string"===typeof e)return gi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gi(e,t):void 0}}function pi(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function hi(e){if(Array.isArray(e))return gi(e)}function gi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var fi="hsrmanagement",bi=Object(r["defineComponent"])({props:{idSiteHsr:Number},components:{ContentBlock:I["ContentBlock"],Field:L["Field"],HsrUrlTarget:nn,HsrTargetTest:It,SaveButton:L["SaveButton"]},data:function(){return{isDirty:!1,showAdvancedView:!1,sampleLimits:[],siteHsr:{}}},created:function(){var e=this;I["AjaxHelper"].fetch({method:"HeatmapSessionRecording.getAvailableSessionRecordingSampleLimits"}).then((function(t){e.sampleLimits=(t||[]).map((function(e){return{key:"".concat(e),value:e}}))})),this.init()},watch:{idSiteHsr:function(e){null!==e&&this.init()}},methods:{removeAnyHsrNotification:function(){I["NotificationsStore"].remove(fi),I["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=I["NotificationsStore"].show({message:e,context:t,id:fi,type:"transient"});setTimeout((function(){I["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(I["translate"])("HeatmapSessionRecording_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idSiteHsr;this.siteHsr={},this.showAdvancedView=!1,I["Matomo"].helper.lazyScrollToContent(),this.edit&&t?xn.findHsr(t).then((function(t){t&&(e.siteHsr=Object(I["clone"])(t),e.siteHsr.sample_rate="".concat(e.siteHsr.sample_rate),e.addInitialMatchPageRule(),e.isDirty=!1)})):this.create&&(this.siteHsr={idSite:I["Matomo"].idSite,name:"",sample_rate:"10.0",sample_limit:250,min_session_time:0,requires_activity:!0,capture_keystrokes:!1},this.addInitialMatchPageRule(),this.isDirty=!1)},addInitialMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[{attribute:"url",type:"any",value:"",inverted:0}]))},addMatchPageRule:function(){var e;this.siteHsr&&(null!==(e=this.siteHsr.match_page_rules)&&void 0!==e&&e.length||(this.siteHsr.match_page_rules=[]),this.siteHsr.match_page_rules.push({attribute:"url",type:"equals_simple",value:"",inverted:0}),this.isDirty=!0)},removeMatchPageRule:function(e){this.siteHsr&&e>-1&&(this.siteHsr.match_page_rules=di(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules.splice(e,1),this.isDirty=!0)},cancel:function(){var e=Object.assign({},I["MatomoUrl"].hashParsed.value);delete e.idSiteHsr,I["MatomoUrl"].updateHash(e)},createHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&xn.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.addSessionRecording").then((function(t){if(t&&"error"!==t.type&&t.response){e.isDirty=!1;var n=t.response.value;xn.reload().then((function(){I["Matomo"].helper.isReportingPage()&&I["Matomo"].postEvent("updateReportingMenu"),I["MatomoUrl"].updateHash(Object.assign(Object.assign({},I["MatomoUrl"].hashParsed.value),{},{idSiteHsr:n})),setTimeout((function(){e.showNotification(Object(I["translate"])("HeatmapSessionRecording_SessionRecordingCreated"),t.type)}),200)}))}}))},setValueHasChanged:function(){this.isDirty=!0},updateHsr:function(){var e=this;this.removeAnyHsrNotification(),this.checkRequiredFieldsAreSet()&&xn.createOrUpdateHsr(this.siteHsr,"HeatmapSessionRecording.updateSessionRecording").then((function(t){"error"!==t.type&&(e.isDirty=!1,e.siteHsr={},xn.reload().then((function(){e.init()})),e.showNotification(Object(I["translate"])("HeatmapSessionRecording_SessionRecordingUpdated"),t.type))}))},checkRequiredFieldsAreSet:function(){var e;if(!this.siteHsr.name){var t=this.translate("General_Name");return this.showErrorFieldNotProvidedNotification(t),!1}if(null===(e=this.siteHsr.match_page_rules)||void 0===e||!e.length||!xn.filterRules(this.siteHsr.match_page_rules).length){var n=this.translate("HeatmapSessionRecording_ErrorPageRuleRequired");return this.showNotification(n,"error"),!1}return!0},setMatchPageRule:function(e,t){this.siteHsr.match_page_rules=di(this.siteHsr.match_page_rules),this.siteHsr.match_page_rules[t]=e}},computed:{minSessionTimes:function(){return[0,5,10,15,20,30,45,60,90,120].map((function(e){return{key:"".concat(e),value:"".concat(e," seconds")}}))},sampleRates:function(){var e=[.1,.5,1,2,3,4,5,6,8,10,15,20,30,40,50,60,70,80,90,100];return e.map((function(e){return{key:"".concat(e.toFixed(1)),value:"".concat(e,"%")}}))},create:function(){return!this.idSiteHsr},edit:function(){return!this.create},editTitle:function(){var e=this.create?"HeatmapSessionRecording_CreateNewSessionRecording":"HeatmapSessionRecording_EditSessionRecordingX";return e},contentTitle:function(){return Object(I["translate"])(this.editTitle,this.siteHsr.name?'"'.concat(this.siteHsr.name,'"'):"")},isLoading:function(){return Cn.state.value.isLoading},isUpdating:function(){return Cn.state.value.isUpdating},captureKeystrokesHelp:function(){var e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-keystrokes-in-form-fields";return Object(I["translate"])("HeatmapSessionRecording_CaptureKeystrokesHelp",'<a href="'.concat(e,'" target="_blank" rel="noopener noreferrer">'),"</a>")},personalInformationNote:function(){var e="https://developer.matomo.org/guides/heatmap-session-recording/setup#masking-content-on-your-website";return Object(I["translate"])("HeatmapSessionRecording_PersonalInformationNote",Object(I["translate"])("HeatmapSessionRecording_SessionRecording"),"<code>","</code>",'<a href="'.concat(e,'" target="_blank" rel="noreferrer noopener">'),"</a>")},saveButtonText:function(){return this.edit?Object(I["translate"])("CoreUpdater_UpdateTitle"):Object(I["translate"])("HeatmapSessionRecording_CreateNewSessionRecording")}}});bi.render=ci;var vi=bi,yi={class:"sessionRecordingList"},Oi={class:"filterStatus"},ji={class:"hsrSearchFilter",style:{"margin-left":"3.5px"}},Si={class:"index"},_i={class:"name"},Hi={class:"creationDate"},Vi={class:"sampleLimit"},Ni={class:"status"},wi={class:"action"},Ei={colspan:"7"},ki={class:"loadingPiwik"},Ri=Object(r["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Ci={colspan:"7"},xi=["id"],Ti={class:"index"},Di={class:"name"},Mi={class:"creationDate"},Pi={class:"sampleLimit"},Ai={key:0,class:"status status-paused"},Bi=["title"],Ui={key:1,class:"status"},Ii={class:"action"},Li=["title","onClick"],Fi=["title","onClick"],Wi=["title","href"],qi=["title","onClick"],zi={class:"tableActionBar"},Gi=Object(r["createElementVNode"])("span",{class:"icon-add"},null,-1),$i={class:"ui-confirm",ref:"confirmDeleteSessionRecording"},Ji=["value"],Xi=["value"],Yi={class:"ui-confirm",ref:"confirmEndSessionRecording"},Ki=["value"],Qi=["value"];function Zi(e,t,n,a,i,o){var s=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("ContentBlock"),c=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",yi,[Object(r["createVNode"])(l,{"content-title":e.translate("HeatmapSessionRecording_ManageSessionRecordings")},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("p",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_SessionRecordingsUsageBenefits")),1),Object(r["createElementVNode"])("div",null,[Object(r["createElementVNode"])("div",Oi,[Object(r["createVNode"])(s,{uicontrol:"select",name:"filterStatus","model-value":e.filterStatus,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.setFilterStatus(t)}),title:e.translate("HeatmapSessionRecording_Filter"),"full-width":!0,options:e.statusOptions},null,8,["model-value","title","options"])]),Object(r["createElementVNode"])("div",ji,[Object(r["withDirectives"])(Object(r["createVNode"])(s,{uicontrol:"text",name:"hsrSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchFilter=t}),"full-width":!0},null,8,["title","modelValue"]),[[r["vShow"],e.hsrs.length>0]])])]),Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",Si,Object(r["toDisplayString"])(e.translate("General_Id")),1),Object(r["createElementVNode"])("th",_i,Object(r["toDisplayString"])(e.translate("General_Name")),1),Object(r["createElementVNode"])("th",Hi,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreationDate")),1),Object(r["createElementVNode"])("th",Vi,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_SampleLimit")),1),Object(r["createElementVNode"])("th",Ni,Object(r["toDisplayString"])(e.translate("CorePluginsAdmin_Status")),1),Object(r["createElementVNode"])("th",wi,Object(r["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(r["createElementVNode"])("tbody",null,[Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Ei,[Object(r["createElementVNode"])("span",ki,[Ri,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[r["vShow"],e.isLoading||e.isUpdating]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("td",Ci,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_NoSessionRecordingsFound")),1)],512),[[r["vShow"],!e.isLoading&&0==e.hsrs.length]]),(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.sortedHsrs,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{id:"hsr".concat(t.idsitehsr),class:"hsrs",key:t.idsitehsr},[Object(r["createElementVNode"])("td",Ti,Object(r["toDisplayString"])(t.idsitehsr),1),Object(r["createElementVNode"])("td",Di,Object(r["toDisplayString"])(t.name),1),Object(r["createElementVNode"])("td",Mi,Object(r["toDisplayString"])(t.created_date_pretty),1),Object(r["createElementVNode"])("td",Pi,Object(r["toDisplayString"])(t.sample_limit),1),"paused"===t.status?(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",Ai,[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.ucfirst(t.status))+" ",1),Object(r["createElementVNode"])("span",{class:"icon icon-help",title:e.pauseReason},null,8,Bi)])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",Ui,Object(r["toDisplayString"])(e.ucfirst(t.status)),1)),Object(r["createElementVNode"])("td",Ii,[Object(r["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("HeatmapSessionRecording_EditX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:function(n){return e.editHsr(t.idsitehsr)}},null,8,Li),Object(r["withDirectives"])(Object(r["createElementVNode"])("a",{class:"table-action stopRecording icon-drop-crossed",title:e.translate("HeatmapSessionRecording_StopX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:function(n){return e.completeHsr(t)}},null,8,Fi),[[r["vShow"],"ended"!==t.status]]),Object(r["createElementVNode"])("a",{class:"table-action icon-show",title:e.translate("HeatmapSessionRecording_ViewReport"),href:e.getViewReportLink(t),target:"_blank"},null,8,Wi),Object(r["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("HeatmapSessionRecording_DeleteX",e.translate("HeatmapSessionRecording_SessionRecording")),onClick:function(n){return e.deleteHsr(t)}},null,8,qi)])],8,xi)})),128))])],512),[[c]]),Object(r["createElementVNode"])("div",zi,[Object(r["createElementVNode"])("a",{class:"createNewHsr",value:"",onClick:t[2]||(t[2]=function(t){return e.createHsr()})},[Gi,Object(r["createTextVNode"])(" "+Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_CreateNewSessionRecording")),1)])])]})),_:1},8,["content-title"]),Object(r["createElementVNode"])("div",$i,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_DeleteSessionRecordingConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Ji),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Xi)],512),Object(r["createElementVNode"])("div",Yi,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_EndSessionRecordingConfirm")),1),Object(r["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Ki),Object(r["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Qi)],512)])}function er(e){return ir(e)||ar(e)||nr(e)||tr()}function tr(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nr(e,t){if(e){if("string"===typeof e)return rr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rr(e,t):void 0}}function ar(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ir(e){if(Array.isArray(e))return rr(e)}function rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var or=Object(r["defineComponent"])({props:{pauseReason:String},components:{ContentBlock:I["ContentBlock"],Field:L["Field"]},directives:{ContentTable:I["ContentTable"]},data:function(){return{searchFilter:""}},created:function(){xn.setFilterStatus(""),xn.fetchHsrs()},methods:{createHsr:function(){this.editHsr(0)},editHsr:function(e){I["MatomoUrl"].updateHash(Object.assign(Object.assign({},I["MatomoUrl"].hashParsed.value),{},{idSiteHsr:e}))},deleteHsr:function(e){I["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteSessionRecording,{yes:function(){xn.deleteHsr(e.idsitehsr).then((function(){xn.reload(),I["Matomo"].postEvent("updateReportingMenu")}))}})},completeHsr:function(e){I["Matomo"].helper.modalConfirm(this.$refs.confirmEndSessionRecording,{yes:function(){xn.completeHsr(e.idsitehsr).then((function(){xn.reload()}))}})},setFilterStatus:function(e){xn.setFilterStatus(e)},ucfirst:function(e){return"".concat(e[0].toUpperCase()).concat(e.substr(1))},getViewReportLink:function(e){return"?".concat(I["MatomoUrl"].stringify({module:"CoreHome",action:"index",idSite:e.idsite,period:"day",date:"yesterday"}),"#?").concat(I["MatomoUrl"].stringify({category:"HeatmapSessionRecording_SessionRecordings",idSite:e.idsite,period:"day",date:"yesterday",subcategory:e.idsitehsr}))}},computed:{filterStatus:function(){return xn.state.value.filterStatus},statusOptions:function(){return xn.statusOptions},hsrs:function(){return xn.hsrs.value},isLoading:function(){return xn.state.value.isLoading},isUpdating:function(){return xn.state.value.isUpdating},sortedHsrs:function(){var e=this,t=er(this.hsrs).filter((function(t){return Object.keys(t).some((function(n){var a=t;return"string"===typeof a[n]&&-1!==a[n].indexOf(e.searchFilter)}))}));return t.sort((function(e,t){return t.idsitehsr-e.idsitehsr})),t}}});or.render=Zi;var sr=or,lr={class:"manageHsr"};function cr(e,t,n,a,i,o){var s=Object(r["resolveComponent"])("MatomoJsNotWritableAlert"),l=Object(r["resolveComponent"])("SessionRecordingList"),c=Object(r["resolveComponent"])("SessionRecordingEdit");return Object(r["openBlock"])(),Object(r["createElementBlock"])(r["Fragment"],null,[e.editMode?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(s,{key:0,"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_SessionRecordings")},null,8,["is-matomo-js-writable","recording-type"])),Object(r["createElementVNode"])("div",lr,[Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(l,{"pause-reason":e.pauseReason},null,8,["pause-reason"])],512),[[r["vShow"],!e.editMode]]),Object(r["withDirectives"])(Object(r["createElementVNode"])("div",null,[Object(r["createVNode"])(c,{"id-site-hsr":e.idSiteHsr},null,8,["id-site-hsr"])],512),[[r["vShow"],e.editMode]])])],64)}var dr=Object(r["defineComponent"])({props:{pauseReason:String,isMatomoJsWritable:{type:Boolean,required:!0}},data:function(){return{editMode:!1,idSiteHsr:null}},components:{MatomoJsNotWritableAlert:Ba,SessionRecordingEdit:vi,SessionRecordingList:sr},created:function(){var e=this;Object(r["watch"])((function(){return I["MatomoUrl"].hashParsed.value.idSiteHsr}),(function(t){e.initState(t)})),this.initState(I["MatomoUrl"].hashParsed.value.idSiteHsr)},methods:{removeAnyHsrNotification:function(){I["NotificationsStore"].remove("hsrmanagement")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(I["Matomo"].postEvent("HeatmapSessionRecording.initAddSessionRecording",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idSiteHsr=null)}this.editMode=!0,this.idSiteHsr=parseInt(e,10)}else this.editMode=!1,this.idSiteHsr=null;this.removeAnyHsrNotification()}}});dr.render=cr;var ur=dr,mr={class:"ui-confirm",id:"listOfPageviews"},pr=Object(r["createElementVNode"])("br",null,null,-1),hr=Object(r["createElementVNode"])("br",null,null,-1),gr=["onClick"],fr=["title"],br=["value"];function vr(e,t,n,a,i,o){var s=Object(r["resolveDirective"])("content-table");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",mr,[Object(r["createElementVNode"])("h2",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_PageviewsInVisit")),1),pr,hr,Object(r["withDirectives"])(Object(r["createElementVNode"])("table",null,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_ColumnTime")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("General_TimeOnPage")),1),Object(r["createElementVNode"])("th",null,Object(r["toDisplayString"])(e.translate("Goals_URL")),1)])]),Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(e.pageviews,(function(t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:t.idloghsr,class:Object(r["normalizeClass"])({inactive:t.idloghsr!==e.idLogHsr}),onClick:function(n){return e.onClickPageView(t)}},[Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.server_time_pretty),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(t.time_on_page_pretty),1),Object(r["createElementVNode"])("td",{title:t.label},Object(r["toDisplayString"])((t.label||"").substr(0,50)),9,fr)],10,gr)})),128))])],512),[[s]]),Object(r["createElementVNode"])("input",{role:"close",type:"button",value:e.translate("General_Close")},null,8,br)])}var yr=Object(r["defineComponent"])({props:{pageviews:{type:Array,required:!0},idLogHsr:{type:Number,required:!0}},directives:{ContentTable:I["ContentTable"]},methods:{onClickPageView:function(e){e.idloghsr!==this.idLogHsr&&I["MatomoUrl"].updateUrl(Object.assign(Object.assign({},I["MatomoUrl"].urlParsed.value),{},{idLogHsr:e.idloghsr}),I["MatomoUrl"].hashParsed.value.length?Object.assign(Object.assign({},I["MatomoUrl"].hashParsed.value),{},{idLogHsr:e.idloghsr}):void 0)}}});yr.render=vr;var Or=yr,jr={class:"heatmap-vis-title"},Sr={key:0,class:"alert alert-info heatmap-country-alert"},_r={key:1},Hr={key:2},Vr={class:"alert alert-info"},Nr={key:3},wr={class:"alert alert-info"};function Er(e,t,n,a,i,o){var s,l=Object(r["resolveComponent"])("EnrichedHeadline"),c=Object(r["resolveComponent"])("MatomoJsNotWritableAlert"),d=Object(r["resolveComponent"])("HeatmapVis"),u=Object(r["resolveComponent"])("ContentBlock");return Object(r["openBlock"])(),Object(r["createElementBlock"])("div",null,[Object(r["createElementVNode"])("h2",jr,[Object(r["createVNode"])(l,{"edit-url":e.editUrl,"inline-help":e.inlineHelp},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapX",'"'.concat(e.heatmap.name,'"'))),1)]})),_:1},8,["edit-url","inline-help"])]),Object(r["createVNode"])(c,{"is-matomo-js-writable":e.isMatomoJsWritable,"recording-type":e.translate("HeatmapSessionRecording_Heatmaps")},null,8,["is-matomo-js-writable","recording-type"]),e.includedCountries?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Sr,Object(r["toDisplayString"])(e.translate("HeatmapSessionRecording_HeatmapInfoTrackVisitsFromCountries",e.includedCountries)),1)):Object(r["createCommentVNode"])("",!0),e.heatmap.page_treemirror?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",_r,[Object(r["createVNode"])(d,{"created-date":e.createdDate,"excluded-elements":e.heatmap.excluded_elements,"num-samples":e.heatmapMetadata,url:e.heatmap.screenshot_url,"heatmap-date":e.heatmapDate,"heatmap-period":e.heatmapPeriod,"offset-accuracy":e.offsetAccuracy,"breakpoint-tablet":e.heatmap.breakpoint_tablet,"breakpoint-mobile":e.heatmap.breakpoint_mobile,"heatmap-types":e.heatmapTypes,"device-types":e.deviceTypes,"id-site-hsr":e.idSiteHsr,"is-active":e.isActive,"desktop-preview-size":e.desktopPreviewSize,"iframe-resolutions-values":e.iframeResolutions},null,8,["created-date","excluded-elements","num-samples","url","heatmap-date","heatmap-period","offset-accuracy","breakpoint-tablet","breakpoint-mobile","heatmap-types","device-types","id-site-hsr","is-active","desktop-preview-size","iframe-resolutions-values"])])):null!==(s=e.heatmapMetadata)&&void 0!==s&&s.nb_samples_device_all?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Nr,[Object(r["createVNode"])(u,null,{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",wr,Object(r["toDisplayString"])(e.noHeatmapScreenshotRecordedYetText),1)]})),_:1})])):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",Hr,[Object(r["createVNode"])(u,null,{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("div",Vr,Object(r["toDisplayString"])(e.translate(e.noDataMessageKey)),1)]})),_:1})]))])}var kr=Object(r["defineComponent"])({props:{idSiteHsr:{type:Number,required:!0},heatmap:{type:Object,required:!0},heatmapMetadata:{type:Object,required:!0},deviceTypes:{type:Array,required:!0},heatmapTypes:{type:Array,required:!0},offsetAccuracy:{type:Number,required:!0},heatmapPeriod:{type:String,required:!0},heatmapDate:{type:String,required:!0},isActive:Boolean,createdDate:{type:String,required:!0},editUrl:{type:String,required:!0},inlineHelp:{type:String,required:!0},includedCountries:{type:String,required:!0},desktopPreviewSize:{type:Number,required:!0},iframeResolutions:{type:Object,required:!0},noDataMessageKey:{type:String,required:!0},isMatomoJsWritable:{type:Boolean,required:!0}},components:{MatomoJsNotWritableAlert:Ba,ContentBlock:I["ContentBlock"],HeatmapVis:ve,EnrichedHeadline:I["EnrichedHeadline"]},computed:{noHeatmapScreenshotRecordedYetText:function(){return Object(I["translate"])("HeatmapSessionRecording_NoHeatmapScreenshotRecordedYet",this.heatmapMetadata.nb_samples_device_all,Object(I["translate"])("HeatmapSessionRecording_ScreenshotUrl"))}},created:function(){I["Matomo"].postEvent("hidePeriodSelector")}});kr.render=Er;var Rr=kr;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=HeatmapSessionRecording.umd.min.js.map