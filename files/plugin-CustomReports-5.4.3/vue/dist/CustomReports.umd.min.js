(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin","SegmentEditor"],t):"object"===typeof exports?exports["CustomReports"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):e["CustomReports"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"],e["SegmentEditor"])})("undefined"!==typeof self?self:this,(function(e,t,o,r){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(r,i,function(t){return e[t]}.bind(null,i));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="plugins/CustomReports/vue/dist/",o(o.s="fae3")}({"19dc":function(t,o){t.exports=e},"8bbf":function(e,o){e.exports=t},a5a2:function(e,t){e.exports=o},f06f:function(e,t){e.exports=r},fae3:function(e,t,o){"use strict";if(o.r(t),o.d(t,"ReportEdit",(function(){return Mt})),o.d(t,"ReportsList",(function(){return Vo})),o.d(t,"ReportsManage",(function(){return Io})),"undefined"!==typeof window){var r=window.document.currentScript,i=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(o.p=i[1])}var n=o("8bbf"),s={class:"loadingPiwik"},a=Object(n["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),l={class:"loadingPiwik"},c=Object(n["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),d={class:"alert alert-warning"},u={key:0},p={key:1},m={key:0,class:"alert alert-warning"},h=["innerHTML"],b={key:1},f={name:"name"},v={name:"description"},g={class:"form-group row"},j={class:"col s12"},O={class:"col s12 m6"},y={for:"all_websites",class:"siteSelectorLabel"},R={class:"sites_autocomplete"},S={class:"col s12 m6"},C={class:"form-help"},N={key:0,class:"inline-help"},E={key:1,class:"inline-help"},k={key:0,class:"col s12 m6"},V={key:0},w={for:"websitecontains"},_=Object(n["createElementVNode"])("br",null,null,-1),M=["placeholder"],D=["disabled","value"],A={key:1},I=Object(n["createElementVNode"])("br",null,null,-1),U={class:"entityTable"},B={class:"siteId"},T={class:"siteName"},L={key:0,class:"siteAction"},x={colspan:"3"},P={key:0,class:"siteAction"},H=["onClick"],G={class:"form-group row"},q={class:"col s12"},F={class:"unlockAlert alert alert-info"},W={key:0},Y={key:1},z=Object(n["createElementVNode"])("br",null,null,-1),Q=Object(n["createElementVNode"])("br",null,null,-1),X=["value"],J={class:"alertUnlocked alert alert-warning"},K={key:0},Z={key:1},ee={name:"reportType"},te={class:"form-group row"},oe={class:"col s12 m6 dimensionsGroup"},re=Object(n["createElementVNode"])("br",null,null,-1),ie={class:"groupValueSelect",name:"dimensions"},ne=["title","onClick"],se={class:"groupValueSelect addDimension",name:"dimensions"},ae={class:"col s12 m6"},le={class:"form-help"},ce=["innerHTML"],de={class:"form-group row"},ue={class:"col s12 m6 metricsGroup"},pe=Object(n["createElementVNode"])("br",null,null,-1),me={class:"groupValueSelect",name:"metrics"},he=["title","onClick"],be={class:"groupValueSelect addMetric",name:"metrics"},fe={class:"col s12 m6"},ve={class:"form-help"},ge={class:"inline-help"},je=["innerHTML"],Oe={class:"form-group row segmentFilterGroup"},ye={class:"col s12"},Re={style:{margin:"8px 0",display:"inline-block"}},Se={class:"form-group row"},Ce={class:"col s12"},Ne=Object(n["createElementVNode"])("br",null,null,-1),Ee=Object(n["createElementVNode"])("br",null,null,-1),ke={name:"reportCategories"},Ve={name:"reportSubcategories"},we={class:"alert alert-warning"},_e={key:0},Me={key:1},De={class:"alert alert-warning"},Ae={key:0},Ie={key:1},Ue={key:0,class:"form-group row"},Be=["textContent"],Te={class:"col s12 m6"},Le={id:"childReports",class:"col s12 m6"},xe=["data-id"],Pe=Object(n["createElementVNode"])("span",{class:"ui-icon ui-icon-arrowthick-2-n-s"},null,-1),He={class:"col s12 m6"},Ge={class:"form-help"},qe=["textContent"],Fe={class:"entityCancel"},We={class:"ui-confirm",id:"confirmUnlockReport",ref:"confirmUnlockReport"},$e={key:0},Ye={key:1},ze=["value"],Qe=["value"],Xe={class:"ui-confirm",id:"infoReportIsLocked",ref:"infoReportIsLocked"},Je={key:0},Ke={key:1},Ze=["value"],et=["value"];function tt(e,t,o,r,i,$){var tt=Object(n["resolveComponent"])("Field"),ot=Object(n["resolveComponent"])("SiteSelector"),rt=Object(n["resolveComponent"])("SegmentGenerator"),it=Object(n["resolveComponent"])("SaveButton"),nt=Object(n["resolveComponent"])("ContentBlock");return Object(n["openBlock"])(),Object(n["createBlock"])(nt,{class:"editReport","content-title":e.contentTitle},{default:Object(n["withCtx"])((function(){var o,r,i;return[Object(n["withDirectives"])(Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("span",s,[a,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[n["vShow"],e.isLoading]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("p",null,[Object(n["createElementVNode"])("span",l,[c,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("CustomReports_UpdatingData")),1)])],512),[[n["vShow"],e.isUpdating]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",d,[e.multipleSites.length&&!e.report.allowedToEdit?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",u,Object(n["toDisplayString"])(e.translate("CustomReports_ReportEditNotAllowedMultipleWebsitesAccessIssue")),1)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",p,Object(n["toDisplayString"])(e.translate("CustomReports_ReportEditNotAllowedAllWebsitesUpdated")),1))],512),[[n["vShow"],!e.canEdit]]),"paused"===e.report.status?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",m,[e.report.allowedToEdit?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,innerHTML:e.getPausedStateAdminMessage},null,8,h)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",b,Object(n["toDisplayString"])(e.translate("CustomReports_NoDataMessagePausedStateNonAdminUser")),1))])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("form",{onSubmit:t[15]||(t[15]=function(t){return e.edit?e.updateReport():e.createReport()})},[Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("div",f,[Object(n["createVNode"])(tt,{uicontrol:"text",name:"name","model-value":e.report.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.report.name=t,e.setValueHasChanged()}),title:e.translate("General_Name"),maxlength:50,disabled:!e.canEdit,placeholder:e.translate("CustomReports_FieldNamePlaceholder"),"inline-help":e.translate("CustomReports_ReportNameHelp")},null,8,["model-value","title","disabled","placeholder","inline-help"])]),Object(n["createElementVNode"])("div",v,[Object(n["createVNode"])(tt,{uicontrol:"textarea",name:"description","model-value":e.report.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.report.description=t,e.setValueHasChanged()}),title:"".concat(e.translate("General_Description")," (optional)"),maxlength:1e3,disabled:!e.canEdit,rows:3,placeholder:e.translate("CustomReports_FieldDescriptionPlaceholder"),"inline-help":e.translate("CustomReports_ReportDescriptionHelp")},null,8,["model-value","title","disabled","placeholder","inline-help"])]),Object(n["createElementVNode"])("div",g,[Object(n["createElementVNode"])("h3",j,Object(n["toDisplayString"])(e.translate("CustomReports_ApplyTo")),1),Object(n["createElementVNode"])("div",O,[Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("label",y,Object(n["toDisplayString"])(e.translate("General_Website")),1),Object(n["createElementVNode"])("div",R,[Object(n["createVNode"])(ot,{id:"all_websites","model-value":e.report.site,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.report.site=t,e.setWebsiteChanged(t)}),"show-all-sites-item":e.isSuperUser,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["model-value","show-all-sites-item"])])])]),Object(n["createElementVNode"])("div",S,[Object(n["createElementVNode"])("div",C,[e.isSuperUser?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",N,Object(n["toDisplayString"])(e.translate("CustomReports_ReportAllWebsitesHelp")),1)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",E,Object(n["toDisplayString"])(e.translate("CustomReports_ReportAllWebsitesNonSuperUserHelp")),1))])]),"all"!==e.report.site.id&&"0"!==e.report.site.id&&0!==e.report.site.id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",k,[e.report.allowedToEdit?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",V,[Object(n["createElementVNode"])("span",w,Object(n["toDisplayString"])(e.translate("CustomReports_SelectMeasurablesMatchingSearch")),1),_,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:"control_text customReportSearchMeasurablesField",type:"text",id:"websitecontains","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.containsText=t}),placeholder:e.translate("General_Search")},null,8,M),[[n["vModelText"],e.containsText]]),Object(n["createElementVNode"])("input",{style:{"margin-left":"3.5px"},disabled:!e.containsText,class:"btn customReportSearchFindMeasurables",type:"button",onClick:t[4]||(t[4]=function(t){return e.addSitesContaining(e.containsText)}),value:e.translate("CustomReports_FindMeasurables")},null,8,D)])):Object(n["createCommentVNode"])("",!0),e.report.allowedToEdit||e.multipleSites.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",A,[I,Object(n["createElementVNode"])("table",U,[Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("th",B,Object(n["toDisplayString"])(e.translate("General_Id")),1),Object(n["createElementVNode"])("th",T,Object(n["toDisplayString"])(e.translate("General_Name")),1),e.report.allowedToEdit?(Object(n["openBlock"])(),Object(n["createElementBlock"])("th",L,Object(n["toDisplayString"])(e.translate("General_Remove")),1)):Object(n["createCommentVNode"])("",!0)])]),Object(n["createElementVNode"])("tbody",null,[Object(n["withDirectives"])(Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("td",x,Object(n["toDisplayString"])(e.translate("CustomReports_NoMeasurableAssignedYet")),1)],512),[[n["vShow"],!e.multipleSites.length]]),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.multipleSites,(function(t,o){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{key:o},[Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(t.idsite),1),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(t.name),1),e.report.allowedToEdit?(Object(n["openBlock"])(),Object(n["createElementBlock"])("td",P,[Object(n["createElementVNode"])("span",{class:"icon-minus table-action",onClick:function(o){return e.removeSite(t)}},null,8,H)])):Object(n["createCommentVNode"])("",!0)],512)),[[n["vShow"],e.multipleSites.length>0]])})),128))])])])):Object(n["createCommentVNode"])("",!0)])):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",G,[Object(n["createElementVNode"])("h3",q,Object(n["toDisplayString"])(e.translate("CustomReports_ReportContent")),1)]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",F,[e.browserArchivingDisabled&&e.reArchiveLastN?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",W,Object(n["toDisplayString"])(e.translate("CustomReports_WarningRequiresUnlockBrowserArchivingDisabled",e.reArchiveLastN)),1)):Object(n["createCommentVNode"])("",!0),e.browserArchivingDisabled&&e.reArchiveLastN?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Y,Object(n["toDisplayString"])(e.translate("CustomReports_WarningRequiresUnlock")),1)),z,Q,Object(n["createElementVNode"])("input",{type:"button",class:"btn unlockReport",onClick:t[5]||(t[5]=function(t){return e.unlockReport()}),value:e.translate("CustomReports_Unlock")},null,8,X)],512),[[n["vShow"],e.isLocked]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",J,[e.browserArchivingDisabled&&e.reArchiveLastN?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",K,Object(n["toDisplayString"])(e.translate("CustomReports_WarningOnUpdateReportMightGetLostBrowserArchivingDisabled",e.reArchiveLastN)),1)):Object(n["createCommentVNode"])("",!0),e.browserArchivingDisabled&&e.reArchiveLastN?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Z,Object(n["toDisplayString"])(e.translate("CustomReports_WarningOnUpdateReportMightGetLost")),1))],512),[[n["vShow"],e.isUnlocked]]),Object(n["createElementVNode"])("div",ee,[Object(n["createVNode"])(tt,{uicontrol:"radio",name:"reportType","model-value":e.report.report_type,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.setReportTypeHasChanged(t)}),title:e.translate("CustomReports_ReportType"),disabled:!e.canEdit,options:e.reportTypes},null,8,["model-value","title","disabled","options"])]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",te,[Object(n["createElementVNode"])("div",oe,[Object(n["createElementVNode"])("label",null,Object(n["toDisplayString"])(e.translate("CustomReports_Dimensions")),1),re,Object(n["createElementVNode"])("div",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.report.dimensions,(function(t,o){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])("selectedDimension selectedDimension".concat(o)),key:o},[Object(n["createElementVNode"])("div",ie,[Object(n["createVNode"])(tt,{uicontrol:"expandable-select",name:"dimensions","model-value":t,"onUpdate:modelValue":function(t){return e.changeDimension(t,o)},title:e.dimensionsReadable[t]||t,"full-width":!0,options:e.dimensions},null,8,["model-value","onUpdate:modelValue","title","options"])]),Object(n["createElementVNode"])("span",{class:"icon-minus",title:e.translate("CustomReports_RemoveDimension"),onClick:function(t){return e.removeDimension(o)}},null,8,ne)],2)})),128)),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",se,[Object(n["createVNode"])(tt,{uicontrol:"expandable-select",name:"dimensions","model-value":"","onUpdate:modelValue":t[7]||(t[7]=function(t){e.addDimension(t)}),title:e.translate("CustomReports_AddDimension"),"full-width":!0,options:e.dimensions},null,8,["title","options"])],512),[[n["vShow"],e.report.dimensions.length<e.maxDimensions]])])]),Object(n["createElementVNode"])("div",ae,[Object(n["createElementVNode"])("div",le,[Object(n["createElementVNode"])("span",{class:"inline-help",innerHTML:e.$sanitize(e.getDimensionsHelpText)},null,8,ce)])])],512),[[n["vShow"],"evolution"!==e.report.report_type]]),Object(n["createElementVNode"])("div",de,[Object(n["createElementVNode"])("div",ue,[Object(n["createElementVNode"])("label",null,Object(n["toDisplayString"])(e.translate("General_Metrics")),1),pe,Object(n["createElementVNode"])("div",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.report.metrics,(function(t,o){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])("selectedMetric selectedMetric".concat(o)),key:o},[Object(n["createElementVNode"])("div",me,[Object(n["createVNode"])(tt,{uicontrol:"expandable-select",name:"metrics","model-value":t,"onUpdate:modelValue":function(t){return e.changeMetric(t,o)},title:e.metricsReadable[t]||t,"full-width":!0,options:e.metrics},null,8,["model-value","onUpdate:modelValue","title","options"])]),Object(n["createElementVNode"])("span",{class:"icon-minus",title:e.translate("CustomReports_RemoveMetric"),onClick:function(t){return e.removeMetric(o)}},null,8,he)],2)})),128)),Object(n["createElementVNode"])("div",be,[Object(n["createVNode"])(tt,{uicontrol:"expandable-select",name:"metrics","model-value":"","onUpdate:modelValue":t[8]||(t[8]=function(t){e.addMetric(t)}),title:e.translate("CustomReports_AddMetric"),"full-width":!0,options:e.metrics},null,8,["title","options"])])])]),Object(n["createElementVNode"])("div",fe,[Object(n["createElementVNode"])("div",ve,[Object(n["createElementVNode"])("span",ge,Object(n["toDisplayString"])(e.translate("CustomReports_ReportMetricsHelp")),1)])])]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"alert alert-warning",innerHTML:e.getProductRevenueDependencyMessage},null,8,je),[[n["vShow"],e.dependencyAdded]]),Object(n["createElementVNode"])("div",Oe,[Object(n["createElementVNode"])("div",ye,[Object(n["createElementVNode"])("div",null,[Object(n["createElementVNode"])("label",Re,Object(n["toDisplayString"])(e.translate("CustomReports_Filter")),1),Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.translate("CustomReports_ReportSegmentHelp")),1),Object(n["createElementVNode"])("div",null,[Object(n["createVNode"])(rt,{"model-value":e.report.segment_filter,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.setSegmentFilterHasChanged(t)}),idsite:e.report.site.id},null,8,["model-value","idsite"])])])])]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Se,[Object(n["createElementVNode"])("div",Ce,[Ne,Ee,Object(n["createVNode"])(it,{class:"showPreviewButton",disabled:!(null!==(o=e.report.metrics)&&void 0!==o&&o.length)||!(null!==(r=e.report.dimensions)&&void 0!==r&&r.length),onConfirm:t[10]||(t[10]=function(t){return e.showPreview()}),value:e.translate("CustomReports_PreviewReport")},null,8,["disabled","value"])])],512),[[n["vShow"],"table"===e.report.report_type]]),Object(n["createElementVNode"])("div",ke,[Object(n["createVNode"])(tt,{uicontrol:"select",name:"reportCategories","model-value":e.report.category.id,"onUpdate:modelValue":t[11]||(t[11]=function(t){e.report.category.id=t,e.setValueHasChanged()}),title:e.translate("CustomReports_ReportCategory"),disabled:!e.canEdit,options:e.categories,introduction:e.translate("CustomReports_ReportPage"),"inline-help":e.translate("CustomReports_ReportCategoryHelp")},null,8,["model-value","title","disabled","options","introduction","inline-help"])]),Object(n["createElementVNode"])("div",Ve,[Object(n["createVNode"])(tt,{uicontrol:"select",name:"reportSubcategories","model-value":null===(i=e.report.subcategory)||void 0===i?void 0:i.id,"onUpdate:modelValue":t[12]||(t[12]=function(t){e.setSubcategory(t),e.setValueHasChanged()}),title:e.translate("CustomReports_ReportSubcategory"),disabled:!e.canEdit,options:e.subcategories[e.report.category.id],"inline-help":e.translate("CustomReports_ReportSubcategoryHelp")},null,8,["model-value","title","disabled","options","inline-help"])]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",we,[e.browserArchivingDisabled&&e.reArchiveLastN?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",_e,Object(n["toDisplayString"])(e.translate("CustomReports_WarningOnUpdateReportMightGetLostBrowserArchivingDisabled",e.reArchiveLastN)),1)):Object(n["createCommentVNode"])("",!0),e.browserArchivingDisabled&&e.reArchiveLastN?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Me,Object(n["toDisplayString"])(e.translate("CustomReports_WarningOnUpdateReportMightGetLost")),1))],512),[[n["vShow"],e.isUnlocked]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",De,[e.multipleSites.length&&!e.report.allowedToEdit?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Ae,Object(n["toDisplayString"])(e.translate("CustomReports_ReportEditNotAllowedMultipleWebsitesAccessIssue")),1)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Ie,Object(n["toDisplayString"])(e.translate("CustomReports_ReportEditNotAllowedAllWebsitesUpdated")),1))],512),[[n["vShow"],!e.canEdit]]),e.childReports.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ue,[Object(n["createElementVNode"])("h3",{class:"col s12",textContent:Object(n["toDisplayString"])(e.translate("CustomReports_OrderSubCategoryReports"))},null,8,Be),Object(n["createElementVNode"])("div",Te,[Object(n["createElementVNode"])("ul",Le,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.childReports,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{key:e.idcustomreport,"data-id":e.idcustomreport},[Pe,Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)],8,xe)})),128))])]),Object(n["createElementVNode"])("div",He,[Object(n["createElementVNode"])("div",Ge,[Object(n["createElementVNode"])("div",{class:"form-description",textContent:Object(n["toDisplayString"])(e.translate("CustomReports_OrderSubCategoryReportsDescription"))},null,8,qe)])])])):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createVNode"])(it,{class:"createButton",onConfirm:t[13]||(t[13]=function(t){return e.edit?e.updateReport():e.createReport()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),[[n["vShow"],e.canEdit]]),Object(n["createElementVNode"])("div",Fe,[Object(n["createElementVNode"])("a",{onClick:t[14]||(t[14]=function(t){return e.cancel()})},Object(n["toDisplayString"])(e.translate("General_Cancel")),1)])])],32),Object(n["createElementVNode"])("div",We,[e.browserArchivingDisabled&&e.reArchiveLastN?(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",$e,Object(n["toDisplayString"])(e.translate("CustomReports_ConfirmUnlockReportBrowserArchivingDisabled",e.reArchiveLastN)),1)):Object(n["createCommentVNode"])("",!0),e.browserArchivingDisabled&&e.reArchiveLastN?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",Ye,Object(n["toDisplayString"])(e.translate("CustomReports_ConfirmUnlockReport")),1)),Object(n["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ze),Object(n["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Qe)],512),Object(n["createElementVNode"])("div",Xe,[e.browserArchivingDisabled&&e.reArchiveLastN?(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",Je,Object(n["toDisplayString"])(e.translate("CustomReports_InfoReportIsLockedBrowserArchivingDisabled",e.reArchiveLastN)),1)):Object(n["createCommentVNode"])("",!0),e.browserArchivingDisabled&&e.reArchiveLastN?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("h2",Ke,Object(n["toDisplayString"])(e.translate("CustomReports_InfoReportIsLocked")),1)),Object(n["createElementVNode"])("input",{role:"unlock",type:"button",value:e.translate("CustomReports_Unlock")},null,8,Ze),Object(n["createElementVNode"])("input",{role:"ok",type:"button",value:e.translate("General_Cancel")},null,8,et)],512)]})),_:1},8,["content-title"])}var ot=o("19dc"),rt=o("a5a2"),it=o("f06f");function nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function st(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function at(e,t,o){return t&&st(e.prototype,t),o&&st(e,o),e}function lt(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function ct(e){return mt(e)||pt(e)||ut(e)||dt()}function dt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ut(e,t){if(e){if("string"===typeof e)return ht(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ht(e,t):void 0}}function pt(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function mt(e){if(Array.isArray(e))return ht(e)}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */function bt(e){return ct(new Set(e)).filter((function(e){return!!e}))}function ft(e,t,o){var r=[];return e.forEach((function(e){e[t].forEach((function(t){r.push(Object.assign({group:e.category,key:t.uniqueId,value:t.name,tooltip:t.description||void 0},o?lt({},o,t[o]):{}))}))})),r}var vt={key:"",value:""},gt=function(){function e(){var t=this;nt(this,e),lt(this,"privateState",Object(n["reactive"])({reports:[],reportTypesReadable:{},dimensionsReadable:{},metricsReadable:{},categories:[],subcategories:{},isLoading:!1,isUpdating:!1,allMetrics:[],allDimensions:[]})),lt(this,"state",Object(n["computed"])((function(){return Object(n["readonly"])(t.privateState)}))),lt(this,"fetchPromise",null),lt(this,"availableReportTypesPromise",null),lt(this,"dimensionsPromise",null),lt(this,"dimensionsIdsiteLoaded",0),lt(this,"metricsPromise",null),lt(this,"metricsIdsiteLoaded",0),lt(this,"categoriesPromise",null),lt(this,"categoriesIdsiteLoaded",null)}return at(e,[{key:"reload",value:function(){return this.privateState.reports=[],this.fetchPromise=null,this.fetchReports()}},{key:"cleanupSegmentDefinition",value:function(e){var t=e;return t=t.replace("'","%27"),t=t.replace("&","%26"),t}},{key:"getAvailableReportTypes",value:function(){var e=this;return this.availableReportTypesPromise||(this.availableReportTypesPromise=ot["AjaxHelper"].fetch({method:"CustomReports.getAvailableReportTypes",filter_limit:"-1"}).then((function(t){var o={};t.forEach((function(e){o[e.key]=e.value})),e.privateState.reportTypesReadable=o}))),this.availableReportTypesPromise.then((function(){return e.state.value.reportTypesReadable}))}},{key:"getAvailableDimensions",value:function(e){var t=this;return this.dimensionsPromise&&this.dimensionsIdsiteLoaded===e||(this.dimensionsIdsiteLoaded=e,this.dimensionsPromise=ot["AjaxHelper"].fetch({method:"CustomReports.getAvailableDimensions",filter_limit:"-1",idSite:e}).then((function(e){var o={};e.forEach((function(e){e.dimensions.forEach((function(e){o[e.uniqueId]=e.name}))})),t.privateState.dimensionsReadable=o,t.privateState.allDimensions=ft(e,"dimensions","sqlSegment")}))),this.dimensionsPromise.then((function(){return t.state.value.dimensionsReadable}))}},{key:"getAvailableMetrics",value:function(e){var t=this;return this.metricsPromise&&this.metricsIdsiteLoaded===e||(this.metricsIdsiteLoaded=e,this.metricsPromise=ot["AjaxHelper"].fetch({method:"CustomReports.getAvailableMetrics",filter_limit:"-1",idSite:e}).then((function(e){var o={};e.forEach((function(e){e.metrics.forEach((function(e){o[e.uniqueId]=e.name}))})),t.privateState.metricsReadable=o,t.privateState.allMetrics=ft(e,"metrics")}))),this.metricsPromise.then((function(){return t.state.value.metricsReadable}))}},{key:"getAvailableCategories",value:function(e){var t=this,o=e&&"all"!==e?e:ot["Matomo"].idSite;return this.categoriesPromise&&this.categoriesIdsiteLoaded===e||(this.categoriesPromise=ot["AjaxHelper"].fetch({method:"CustomReports.getAvailableCategories",filter_limit:"-1",idSite:o}).then((function(e){var o=[],r={};e.forEach((function(e){o.push({key:e.uniqueId,value:e.name}),e.subcategories.forEach((function(t){r[e.uniqueId]=r[e.uniqueId]||[vt],r[e.uniqueId].push({key:t.uniqueId,value:t.name})}))})),t.privateState.categories=o,t.privateState.subcategories=r}))),this.categoriesPromise}},{key:"fetchReports",value:function(){var e=this;return this.fetchPromise||(this.fetchPromise=ot["AjaxHelper"].fetch({method:"CustomReports.getConfiguredReports",filter_limit:"-1"})),this.privateState.isLoading=!0,this.privateState.reports=[],this.fetchPromise.then((function(t){return e.privateState.reports=t.map((function(e){var t,o,r=void 0;return r=null!==e&&void 0!==e&&null!==(t=e.subcategory)&&void 0!==t&&t.id?e.subcategory.id:"CustomReports_CustomReports"===(null===e||void 0===e||null===(o=e.category)||void 0===o?void 0:o.id)?e.idcustomreport:e.name,Object.assign(Object.assign({},e),{},{linkIdSite:e.idsite?e.idsite:ot["Matomo"].idSite,subcategoryLink:r})})),e.state.value.reports})).finally((function(){e.privateState.isLoading=!1}))}},{key:"findReport",value:function(e,t){var o=this,r=this.state.value.reports.find((function(t){return parseInt("".concat(t.idcustomreport),10)===e}));return r&&!t?Promise.resolve(r):(this.privateState.isLoading=!0,ot["AjaxHelper"].fetch({idCustomReport:e,method:"CustomReports.getConfiguredReport"}).finally((function(){o.privateState.isLoading=!1})))}},{key:"deleteReport",value:function(e,t){var o=this;return this.privateState.isUpdating=!0,this.privateState.reports=[],ot["AjaxHelper"].fetch({idCustomReport:e,idSite:"".concat(t),method:"CustomReports.deleteCustomReport"},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){o.privateState.isUpdating=!1}))}},{key:"pauseReport",value:function(e,t){var o=this;return this.privateState.isUpdating=!0,this.privateState.reports=[],ot["AjaxHelper"].fetch({idCustomReport:e,idSite:"".concat(t),method:"CustomReports.pauseCustomReport"},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){o.privateState.isUpdating=!1}))}},{key:"resumeReport",value:function(e,t){var o=this;return this.privateState.isUpdating=!0,this.privateState.reports=[],ot["AjaxHelper"].fetch({idCustomReport:e,idSite:"".concat(t),method:"CustomReports.resumeCustomReport"},{withTokenInUrl:!0}).then((function(){return{type:"success"}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){o.privateState.isUpdating=!1}))}},{key:"createOrUpdateReport",value:function(e,t,o,r){var i,n,s=this;return this.privateState.isUpdating=!0,ot["AjaxHelper"].post({method:t,idCustomReport:e.idcustomreport,reportType:e.report_type,name:e.name.trim(),description:e.description.trim(),segmentFilter:encodeURIComponent(e.segment_filter),categoryId:null===(i=e.category)||void 0===i?void 0:i.id,subcategoryId:null===(n=e.subcategory)||void 0===n?void 0:n.id,idSite:e.site.id,subCategoryReportIds:o,multipleIdSites:r},{dimensionIds:bt(e.dimensions),metricIds:bt(e.metrics)},{withTokenInUrl:!0}).then((function(e){return{type:"success",response:e}})).catch((function(e){return{type:"error",message:e.message||e}})).finally((function(){s.privateState.isUpdating=!1}))}}]),e}(),jt=new gt;function Ot(e){return Ct(e)||St(e)||Rt(e)||yt()}function yt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Rt(e,t){if(e){if("string"===typeof e)return Nt(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Nt(e,t):void 0}}function St(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ct(e){if(Array.isArray(e))return Nt(e)}function Nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}var Et="reportsmanagement",kt="reportsmanagementProductMetric";function Vt(e){return Ot(new Set(e)).filter((function(e){return!!e}))}function wt(){return{dimensions:[],site:{id:ot["Matomo"].idSite,name:ot["Matomo"].currentSiteName},category:{}}}var _t=Object(n["defineComponent"])({props:{idCustomReport:Number,browserArchivingDisabled:Boolean,reArchiveLastN:Number,maxDimensions:Number,isCloud:Boolean},components:{ContentBlock:ot["ContentBlock"],Field:rt["Field"],SiteSelector:ot["SiteSelector"],SegmentGenerator:it["SegmentGenerator"],SaveButton:rt["SaveButton"]},data:function(){return{isDirty:!1,report:wt(),isLocked:!1,isUnlocked:!1,canEdit:!0,dependencyAdded:!1,childReports:[],childReportIds:[],containsText:"",multipleSites:[],multipleIdSites:[]}},created:function(){jt.getAvailableReportTypes(),this.init()},watch:{idCustomReport:function(e){null!==e&&this.init()}},methods:{initReportOptions:function(){var e=parseInt("".concat(this.report.site.id),10)||"all";jt.getAvailableDimensions(e),jt.getAvailableMetrics(e),jt.getAvailableCategories(e)},doUnlock:function(){this.isLocked=!1,this.isUnlocked=!0},confirmReportIsLocked:function(e){var t=this;ot["Matomo"].helper.modalConfirm(this.$refs.infoReportIsLocked,{unlock:function(){t.doUnlock(),e&&e()}})},removeAnyReportNotification:function(){ot["NotificationsStore"].remove(Et),ot["NotificationsStore"].remove(kt),ot["NotificationsStore"].remove("ajaxHelper")},showApiErrorMessage:function(e,t){if(e&&t){this.removeAnyReportNotification();var o=document.createElement("textarea");o.innerHTML=e,this.showNotification(o.value,t,"toast")}},showNotification:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=ot["NotificationsStore"].show({message:e,context:t,id:Et,type:null!==o&&void 0!==o?o:"transient",prepend:!0});setTimeout((function(){ot["NotificationsStore"].scrollToNotification(r)}),100)},showProductMetricNotification:function(e,t){var o=ot["NotificationsStore"].show({message:e,context:"warning",id:kt,type:"transient"});t&&setTimeout((function(){ot["NotificationsStore"].scrollToNotification(o)}),100)},showErrorFieldNotProvidedNotification:function(e){var t=Object(ot["translate"])("CustomReports_ErrorXNotProvided",[e]);this.showNotification(t,"error")},init:function(){var e=this,t=this.idCustomReport;this.canEdit=!0,this.report=wt(),ot["Matomo"].helper.lazyScrollToContent(),this.edit&&t?jt.findReport(t,!0).then((function(t){var o;if(t){e.report=Object(ot["clone"])(t),e.isLocked=!0,e.isUnlocked=!1,e.canEdit=!0,e.childReports=null!==(o=e.report.child_reports)&&void 0!==o?o:[],e.report.multipleIdSites&&e.report.multipleIdSites.length&&"all"!==e.report.site.id&&"0"!==e.report.site.id&&0!==e.report.site.id&&(e.multipleSites=e.report.multipleIdSites,e.report.allowedToEdit||(e.canEdit=!1,e.isLocked=!1)),e.childReports.length&&Object.values(e.childReports).forEach((function(t){e.childReportIds.push(t.idcustomreport)})),$(document).ready((function(){$("#childReports").sortable({connectWith:"#childReports",update:function(){e.isDirty=!0;var t=$("#childReports li");e.childReportIds=[],t.each((function(t,o){o.dataset.id&&e.childReportIds.push(o.dataset.id)}))}})}));var r=e.report.idsite;0!==r&&"0"!==r&&"all"!==r||(r="all",e.isSuperUser||(e.canEdit=!1,e.isLocked=!1)),e.report.site={id:r,name:e.report.site.name},e.isDirty=!1,e.initReportOptions()}})):this.create&&(this.report={idsite:ot["Matomo"].idSite,site:{id:ot["Matomo"].idSite,name:ot["Matomo"].currentSiteName||ot["Matomo"].siteName},name:"",description:"",dimensions:[],metrics:["nb_visits"],report_type:"table",category:{id:"CustomReports_CustomReports"},subcategory:null,segment_filter:"",child_reports:[],allowedToEdit:!0},this.isLocked=!1,this.canEdit=!0,this.isDirty=!1,this.initReportOptions())},cancel:function(){var e=Object.assign({},ot["MatomoUrl"].hashParsed.value);delete e.idCustomReport,ot["MatomoUrl"].updateHash(e)},unlockReport:function(){var e=this;this.report&&this.isLocked&&ot["Matomo"].helper.modalConfirm(this.$refs.confirmUnlockReport,{yes:function(){e.doUnlock()}})},createReport:function(){var e=this,t="CustomReports.addCustomReport";this.removeAnyReportNotification(),this.checkRequiredFieldsAreSet()&&(this.multipleIdSites=[],this.multipleSites&&this.multipleSites.length&&"all"!==this.report.site.id&&"0"!==this.report.site.id&&0!==this.report.site.id&&(this.multipleIdSites.push(ot["Matomo"].idSite),this.multipleSites.forEach((function(t){var o=t.idsite;e.multipleIdSites.includes(o)||e.multipleIdSites.push(o)}))),this.multipleIdSites&&this.multipleIdSites.length&&(this.report.site.id=ot["Matomo"].idSite),jt.createOrUpdateReport(this.report,t,this.childReportIds,this.multipleIdSites).then((function(t){if(t&&"error"!==t.type&&t.response){e.isDirty=!1;var o=t.response.value;if(e.report.site){var r=e.report.site.id;if(r&&"all"!==r&&"".concat(r)!=="".concat(ot["Matomo"].idSite))return void ot["MatomoUrl"].updateUrl(Object.assign(Object.assign({},ot["MatomoUrl"].urlParsed.value),{},{idSite:r}),Object.assign(Object.assign({},ot["MatomoUrl"].hashParsed.value),{},{idCustomReport:o}))}jt.reload().then((function(){ot["Matomo"].helper.isReportingPage()&&ot["Matomo"].postEvent("updateReportingMenu"),ot["MatomoUrl"].updateHash(Object.assign(Object.assign({},ot["MatomoUrl"].hashParsed.value),{},{idCustomReport:o})),setTimeout((function(){e.showNotification(Object(ot["translate"])("CustomReports_ReportCreated"),t.type)}),200)}))}else{var i,n;e.showApiErrorMessage(null!==(i=t.message)&&void 0!==i?i:"",null!==(n=t.type)&&void 0!==n?n:"error")}})))},showPreview:function(){var e,t,o;if(this.isProductRevenueDependencyMet(!0)){var r=null!==(e=this.report.site)&&void 0!==e&&e.id&&"all"!==this.report.site.id?this.report.site.id:ot["Matomo"].idSite,i=(null===(t=this.report.dimensions)||void 0===t?void 0:t.length)&&this.report.report_type&&"evolution"!==this.report.report_type,n=i?this.report.dimensions.join(","):void 0,s=!(null===(o=this.report.metrics)||void 0===o||!o.length),a=s?this.report.metrics.join(","):void 0,l=ot["MatomoUrl"].stringify({module:"CustomReports",action:"previewReport",period:"day",date:"today",idSite:r,report_type:this.report.report_type,dimensions:n,metrics:a,segment:this.report.segment_filter||void 0}),c=Object(ot["translate"])("CustomReports_Preview");window.Piwik_Popover.createPopupAndLoadUrl(l,c,"customReportPreview")}},setValueHasChanged:function(){this.isDirty=!0},addDimension:function(e){var t=this;this.report&&e&&(this.isLocked?this.confirmReportIsLocked((function(){t.addDimension(e)})):(this.report.dimensions||(this.report.dimensions=[]),this.report.dimensions=[].concat(Ot(this.report.dimensions),[e]),this.setValueHasChanged()))},changeDimension:function(e,t){var o,r=this;this.report&&e&&(this.isLocked?this.confirmReportIsLocked((function(){r.changeDimension(e,t)})):null!==(o=this.report.dimensions)&&void 0!==o&&o[t]&&(this.report.dimensions=Ot(this.report.dimensions),this.report.dimensions[t]=e,this.setValueHasChanged()))},changeMetric:function(e,t){var o,r=this;this.dependencyAdded=!1,this.report&&e&&(this.isLocked?this.confirmReportIsLocked((function(){r.changeMetric(e,t)})):null!==(o=this.report.metrics)&&void 0!==o&&o[t]&&(this.report.metrics=Ot(this.report.metrics),this.report.metrics[t]=e,this.setValueHasChanged(),this.addMetricIfMissingDependency(e)))},setWebsiteChanged:function(e){this.setValueHasChanged(),this.initReportOptions(),"all"===this.report.site.id||"0"===this.report.site.id||0===this.report.site.id?this.multipleSites=[]:this.report.allowedToEdit&&!this.isSiteIncludedAlready("".concat(e.id))&&this.multipleSites&&this.multipleSites.push({idsite:e.id,name:e.name})},removeDimension:function(e){var t=this;this.isLocked?this.confirmReportIsLocked((function(){t.removeDimension(e)})):(window.$('div.ui-tooltip[role="tooltip"]:not([style*="display: none"])').remove(),e>-1&&(this.report.dimensions=Ot(this.report.dimensions),this.report.dimensions.splice(e,1),this.setValueHasChanged()))},addMetric:function(e){var t=this;this.dependencyAdded=!1,this.report&&e&&(this.report.metrics||(this.report.metrics=[]),this.isLocked?this.confirmReportIsLocked((function(){t.addMetric(e)})):(this.report.metrics=[].concat(Ot(this.report.metrics),[e]),this.setValueHasChanged(),this.addMetricIfMissingDependency(e)))},addMetricIfMissingDependency:function(e){if(["sum_product_revenue","avg_product_revenue"].includes(e)&&!this.doesReportIncludeProductQuantityMetric()){var t="avg_product_revenue"===e?"avg_ecommerce_productquantity":"sum_ecommerce_productquantity";this.addMetric(t),this.dependencyAdded=!0}},removeMetric:function(e){var t=this;this.dependencyAdded=!1,this.isLocked?this.confirmReportIsLocked((function(){t.removeMetric(e)})):(window.$('div.ui-tooltip[role="tooltip"]:not([style*="display: none"])').remove(),e>-1&&(this.report.metrics=Ot(this.report.metrics),this.report.metrics.splice(e,1),this.setValueHasChanged()))},setReportTypeHasChanged:function(e){var t=this;this.report&&this.isLocked?e!==this.report.report_type&&this.confirmReportIsLocked((function(){t.report.report_type=e,t.setValueHasChanged()})):(this.report.report_type=e,this.setValueHasChanged())},setSegmentFilterHasChanged:function(e){var t=this;this.report&&this.isLocked?e!==this.report.segment_filter&&this.confirmReportIsLocked((function(){t.report.segment_filter=e,t.setValueHasChanged()})):(this.report.segment_filter=e,this.setValueHasChanged())},updateReport:function(){var e=this;if(this.removeAnyReportNotification(),this.checkRequiredFieldsAreSet()){this.multipleIdSites=[],this.multipleSites&&this.multipleSites.length&&"all"!==this.report.site.id&&"0"!==this.report.site.id&&0!==this.report.site.id&&(this.multipleIdSites.push(ot["Matomo"].idSite),this.multipleSites.forEach((function(t){var o=t.idsite;e.multipleIdSites.includes(o)||e.multipleIdSites.push(o)})));var t="CustomReports.updateCustomReport";this.multipleIdSites&&this.multipleIdSites.length&&(this.report.site.id=ot["Matomo"].idSite),jt.createOrUpdateReport(this.report,t,this.childReportIds,this.multipleIdSites).then((function(t){if(t&&"error"!==t.type){var o=e.report.site.id;e.isDirty=!1,e.canEdit=!0,o&&"all"!==o&&"".concat(o)!=="".concat(ot["Matomo"].idSite)?ot["MatomoUrl"].updateUrl(Object.assign(Object.assign({},ot["MatomoUrl"].urlParsed.value),{},{idSite:o}),Object.assign({},ot["MatomoUrl"].hashParsed.value)):(jt.reload().then((function(){e.init()})),e.showNotification(Object(ot["translate"])("CustomReports_ReportUpdated"),t.type))}else{var r,i;e.showApiErrorMessage(null!==(r=t.message)&&void 0!==r?r:"",null!==(i=t.type)&&void 0!==i?i:"error")}}))}},checkRequiredFieldsAreSet:function(){var e,t;if(!this.report.name){var o=Object(ot["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(o),!1}if("evolution"!==this.report.report_type&&(null===(t=this.report.dimensions)||void 0===t||!t.length||!Vt(this.report.dimensions).length)){var r=Object(ot["translate"])("CustomReports_ErrorMissingDimension");return this.showNotification(r,"error"),!1}if(null===(e=this.report.metrics)||void 0===e||!e.length||!Vt(this.report.metrics).length){var i=Object(ot["translate"])("CustomReports_ErrorMissingMetric");return this.showNotification(i,"error"),!1}return this.isProductRevenueDependencyMet(!1),!0},setSubcategory:function(e){this.report.subcategory=this.report.subcategory||{id:""},this.report.subcategory.id=e},isProductRevenueDependencyMet:function(e){var t=Object(ot["externalLink"])("https://matomo.org/faq/custom-reports/why-is-there-an-error-when-i-try-to-run-a-custom-report-with-the-product-revenue-metric/"),o=Object(ot["translate"])("CustomReports_WarningProductRevenueMetricDependency",t,"</a>");return this.report.metrics.includes("sum_product_revenue")&&!this.doesReportIncludeProductQuantityMetric()?(this.addMetric("sum_ecommerce_productquantity"),this.showProductMetricNotification(o,e),!1):!(this.report.metrics.includes("avg_product_revenue")&&!this.doesReportIncludeProductQuantityMetric())||(this.addMetric("avg_ecommerce_productquantity"),this.showProductMetricNotification(o,e),!1)},doesReportIncludeProductQuantityMetric:function(){return this.report.metrics.includes("sum_ecommerce_productquantity")||this.report.metrics.includes("avg_ecommerce_productquantity")},isSiteIncludedAlready:function(e){return!(!this.multipleSites||!this.multipleSites.length)&&this.multipleSites.some((function(t){return"".concat(t.idsite)==="".concat(e)}))},removeSite:function(e){this.multipleSites&&(this.isDirty=!0,this.multipleSites=this.multipleSites.filter((function(t){return t.idsite!==e.idsite})))},addSitesContaining:function(e){var t=this;if(e){var o='"'.concat(ot["Matomo"].helper.escape(ot["Matomo"].helper.htmlEntities(e)),'"');ot["AjaxHelper"].fetch({method:"SitesManager.getSitesWithAdminAccess",pattern:e,filter_limit:-1}).then((function(e){if(e&&e.length){var r=[],i=[];e.forEach((function(e){var o=window.vueSanitize(ot["Matomo"].helper.htmlEntities(e.name)),n="".concat(o," (id ").concat(parseInt("".concat(e.idsite),10),")<br />");t.isSiteIncludedAlready("".concat(e.idsite))?i.push(n):r.push(n)}));var n=Object(ot["translate"])("CustomReports_MatchingSearchConfirmTitle",r.length);if(i.length){var s=Object(ot["translate"])("CustomReports_MatchingSearchConfirmTitleAlreadyAdded",i.length);n+=" (".concat(s,")")}var a="<div><h2>".concat(n,"</h2><p>\n          ").concat(Object(ot["translate"])("CustomReports_MatchingSearchMatchedAdd",r.length,o),":\n          <br /><br />");if(a+=r.join(""),i.length){var l=Object(ot["translate"])("CustomReports_MatchingSearchMatchedAlreadyAdded",i.length,o);a+="<br />".concat(l,":<br /><br />").concat(i.join(""))}a+='</p><input role="yes" type="button" value="'.concat(Object(ot["translate"])("General_Yes"),'"/>\n          <input role="no" type="button" value="').concat(Object(ot["translate"])("General_No"),'"/>\n          </div>'),ot["Matomo"].helper.modalConfirm(a,{yes:function(){e.forEach((function(e){t.multipleSites&&(t.isSiteIncludedAlready("".concat(e.idsite))||(t.isDirty=!0,t.multipleSites.push({idsite:e.idsite,name:e.name})))})),t.containsText=""}})}else{var c="<div>\n            <h2>".concat(Object(ot["translate"])("CustomReports_MatchingSearchNotFound",o),'</h2>\n            <input role="ok" type="button" value="').concat(Object(ot["translate"])("General_Ok"),'"/>\n          </div>');ot["Matomo"].helper.modalConfirm(c)}}))}}},computed:{isSuperUser:function(){return!!ot["Matomo"].hasSuperUserAccess},allMetrics:function(){return jt.state.value.allMetrics},metrics:function(){var e,t=["pageviews_with_generation_time","avg_page_generation_time","max_actions_pagegenerationtime","sum_actions_pagegenerationtime"],o=((null===(e=this.report)||void 0===e?void 0:e.metrics)||[]).some((function(e){return t.indexOf(e)>=0})),r=!o;return this.allMetrics.filter((function(e){return!!e&&!(r&&t.indexOf(e.key)>=0)}))},allDimensions:function(){return jt.state.value.allDimensions},reportTypes:function(){return jt.state.value.reportTypesReadable},create:function(){return!this.idCustomReport},edit:function(){return!this.create},editTitle:function(){return this.create?"CustomReports_CreateNewReport":"CustomReports_EditReport"},contentTitle:function(){return Object(ot["translate"])(this.editTitle,this.report.name?'"'.concat(this.report.name,'"'):"")},categories:function(){return jt.state.value.categories},subcategories:function(){return jt.state.value.subcategories},dimensions:function(){var e,t=Ot(this.allDimensions);if(null===(e=this.report)||void 0===e||!e.dimensions)return t;for(var o=-1!==this.report.dimensions.indexOf("Actions.PageGenerationTime"),r=this.report.dimensions.map((function(e){var o;return null===(o=t.find((function(t){return t.key===e})))||void 0===o?void 0:o.sqlSegment})).filter((function(e){return!!e})),i=0;i<t.length;i+=1){var n=t[i];if(!o&&"Actions.PageGenerationTime"===n.key){t.splice(i,1),i-=1;break}n.sqlSegment&&r.indexOf(n.sqlSegment)>-1&&-1===this.report.dimensions.indexOf(n.key)&&(t.splice(i,1),i-=1)}return t},isLoading:function(){return jt.state.value.isLoading},isUpdating:function(){return jt.state.value.isUpdating},dimensionsReadable:function(){return jt.state.value.dimensionsReadable},metricsReadable:function(){return jt.state.value.metricsReadable},saveButtonText:function(){return this.edit?Object(ot["translate"])("CoreUpdater_UpdateTitle"):Object(ot["translate"])("CustomReports_CreateNewReport")},getProductRevenueDependencyMessage:function(){var e=Object(ot["externalLink"])("https://matomo.org/faq/custom-reports/why-is-there-an-error-when-i-try-to-run-a-custom-report-with-the-product-revenue-metric/");return Object(ot["translate"])("CustomReports_WarningProductRevenueMetricDependency",e,"</a>")},getPausedStateAdminMessage:function(){var e="?".concat(ot["MatomoUrl"].stringify(Object.assign(Object.assign({},ot["MatomoUrl"].urlParsed.value),{},{module:"CustomReports",action:"manage"})));return Object(ot["translate"])("CustomReports_ReportInPausedStateAdmin",'<a href="'.concat(e,'" target="_blank" rel="noreferrer noopener">'),"</a>")},getDimensionsHelpText:function(){var e=Object(ot["translate"])("CustomReports_ReportDimensionsHelpNew"),t=this.getDimensionsHelpTextExtended;return t?"".concat(e,"<br><br>").concat(t):e},getDimensionsHelpTextExtended:function(){if(this.isCloud)return"";var e=Object(ot["externalLink"])("https://matomo.org/faq/custom-reports/faq_25655/");return Object(ot["translate"])("CustomReports_ReportDimensionsHelpExtended",e,"</a>")}}});_t.render=tt;var Mt=_t,Dt={class:"reportSearchFilter"},At={class:"index"},It={class:"name"},Ut={class:"description"},Bt={class:"reportType"},Tt={class:"reportCategory"},Lt={class:"action"},xt={colspan:"7"},Pt={class:"loadingPiwik"},Ht=Object(n["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Gt={colspan:"7"},qt=["id"],Ft={class:"index"},Wt={class:"name"},$t=["title"],Yt=["title"],zt=["title"],Qt=["title"],Xt=["title"],Jt={class:"reportType"},Kt=["title"],Zt={key:0},eo={class:"action"},to=["title","onClick"],oo=["title","onClick"],ro=["title","onClick"],io=["title","href"],no=["title","onClick"],so={class:"tableActionBar"},ao=Object(n["createElementVNode"])("span",{class:"icon-add"},null,-1),lo={class:"ui-confirm",ref:"confirmDeleteReport"},co=["value"],uo=["value"],po={class:"ui-confirm",ref:"confirmPauseReport"},mo=["value"],ho=["value"],bo={class:"ui-confirm",ref:"confirmResumeReport"},fo=["value"],vo=["value"];function go(e,t,o,r,i,s){var a=Object(n["resolveComponent"])("Field"),l=Object(n["resolveComponent"])("ContentBlock"),c=Object(n["resolveDirective"])("content-table");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[Object(n["createVNode"])(l,{"content-title":e.translate("CustomReports_ManageReports"),feature:e.translate("CustomReports_ManageReports")},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("p",null,Object(n["toDisplayString"])(e.translate("CustomReports_CustomReportIntroduction")),1),Object(n["createElementVNode"])("div",Dt,[Object(n["withDirectives"])(Object(n["createVNode"])(a,{uicontrol:"text",name:"reportSearch",title:e.translate("General_Search"),modelValue:e.searchFilter,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.searchFilter=t})},null,8,["title","modelValue"]),[[n["vShow"],e.reports.length>0]])]),Object(n["withDirectives"])(Object(n["createElementVNode"])("table",null,[Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("th",At,Object(n["toDisplayString"])(e.translate("General_Id")),1),Object(n["createElementVNode"])("th",It,Object(n["toDisplayString"])(e.translate("General_Name")),1),Object(n["createElementVNode"])("th",Ut,Object(n["toDisplayString"])(e.translate("General_Description")),1),Object(n["createElementVNode"])("th",Bt,Object(n["toDisplayString"])(e.translate("CustomReports_Type")),1),Object(n["createElementVNode"])("th",Tt,Object(n["toDisplayString"])(e.translate("CustomReports_Category")),1),Object(n["createElementVNode"])("th",Lt,Object(n["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(n["createElementVNode"])("tbody",null,[Object(n["withDirectives"])(Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("td",xt,[Object(n["createElementVNode"])("span",Pt,[Ht,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[n["vShow"],e.isLoading||e.isUpdating]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("td",Gt,Object(n["toDisplayString"])(e.translate("CustomReports_NoCustomReportsFound")),1)],512),[[n["vShow"],!e.isLoading&&0==e.reports.length]]),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.sortedReports,(function(t){var o;return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{id:"report".concat(t.idcustomreport),class:"customReports",key:t.idcustomreport},[Object(n["createElementVNode"])("td",Ft,Object(n["toDisplayString"])(t.idcustomreport),1),Object(n["createElementVNode"])("td",Wt,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(t.name)+" ",1),Object(n["withDirectives"])(Object(n["createElementVNode"])("span",{class:"icon-locked",title:e.translate("CustomReports_ReportEditNotAllowedAllWebsitesUpdated")},null,8,$t),[[n["vShow"],!t.idsite&&!e.isSuperUser]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("span",{class:"icon-info2",title:e.translate("CustomReports_ReportAvailableToAllWebsites")},null,8,Yt),[[n["vShow"],!t.idsite&&e.isSuperUser]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("span",{class:"icon-locked",title:e.translate("CustomReports_ReportEditNotAllowedMultipleWebsitesAccessIssue")},null,8,zt),[[n["vShow"],!t.allowedToEdit&&e.isMultiSiteReport(t)]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("span",{class:"icon-info2",title:e.translate("CustomReports_ReportAvailableToMultipleWebsites")},null,8,Qt),[[n["vShow"],t.allowedToEdit&&e.isMultiSiteReport(t)]])]),Object(n["createElementVNode"])("td",{class:"description",title:e.htmlEntities(t.description)},Object(n["toDisplayString"])(e.truncate(t.description.trim(),60)),9,Xt),Object(n["createElementVNode"])("td",Jt,Object(n["toDisplayString"])(e.reportTypesReadable[t.report_type]),1),Object(n["createElementVNode"])("td",{class:"reportCategory",title:e.htmlEntities(t.category.name)},[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.truncate(t.category.name.trim(),60))+" ",1),null!==(o=t.subcategory)&&void 0!==o&&o.name?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Zt," - "+Object(n["toDisplayString"])(e.truncate(t.subcategory.name.trim(),60)),1)):Object(n["createCommentVNode"])("",!0)],8,Kt),Object(n["createElementVNode"])("td",eo,[Object(n["withDirectives"])(Object(n["createElementVNode"])("a",{class:"table-action icon-pause",title:e.translate("CustomReports_PauseReportInfo"),onClick:function(o){return e.pauseReport(t)}},null,8,to),[[n["vShow"],(t.idsite&&!e.isMultiSiteReport(t)||t.allowedToEdit)&&"active"===t.status]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("a",{class:"table-action icon-play",title:e.translate("CustomReports_ResumeReportInfo"),onClick:function(o){return e.resumeReport(t)}},null,8,oo),[[n["vShow"],(t.idsite&&!e.isMultiSiteReport(t)||t.allowedToEdit)&&"paused"===t.status]]),Object(n["createElementVNode"])("a",{class:"table-action icon-edit",title:e.translate("CustomReports_EditReport"),onClick:function(o){return e.editReport(t.idcustomreport)}},null,8,ro),Object(n["createElementVNode"])("a",{target:"_blank",class:"table-action icon-show",title:e.translate("CustomReports_ViewReportInfo"),href:e.getViewReportLink(t)},null,8,io),Object(n["withDirectives"])(Object(n["createElementVNode"])("a",{class:"table-action icon-delete",title:e.translate("CustomReports_DeleteReportInfo"),onClick:function(o){return e.deleteReport(t)}},null,8,no),[[n["vShow"],t.idsite&&!e.isMultiSiteReport(t)||t.allowedToEdit]])])],8,qt)})),128))])],512),[[c]]),Object(n["createElementVNode"])("div",so,[Object(n["createElementVNode"])("a",{class:"createNewReport",onClick:t[1]||(t[1]=function(t){return e.createReport()})},[ao,Object(n["createTextVNode"])(" "+Object(n["toDisplayString"])(e.translate("CustomReports_CreateNewReport")),1)])])]})),_:1},8,["content-title","feature"]),Object(n["createElementVNode"])("div",lo,[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("CustomReports_DeleteReportConfirm")),1),Object(n["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,co),Object(n["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,uo)],512),Object(n["createElementVNode"])("div",po,[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("CustomReports_PauseReportConfirm")),1),Object(n["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,mo),Object(n["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,ho)],512),Object(n["createElementVNode"])("div",bo,[Object(n["createElementVNode"])("h2",null,Object(n["toDisplayString"])(e.translate("CustomReports_ResumeReportConfirm")),1),Object(n["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,fo),Object(n["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,vo)],512)])}
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */function jo(e,t){return e&&e.length>t?"".concat(e.substr(0,t-3),"..."):e}function Oo(e){return Co(e)||So(e)||Ro(e)||yo()}function yo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ro(e,t){if(e){if("string"===typeof e)return No(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?No(e,t):void 0}}function So(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Co(e){if(Array.isArray(e))return No(e)}function No(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}var Eo="customreportmanagementlist",ko=Object(n["defineComponent"])({props:{},components:{ContentBlock:ot["ContentBlock"],Field:rt["Field"]},directives:{ContentTable:ot["ContentTable"]},data:function(){return{searchFilter:""}},created:function(){jt.getAvailableReportTypes(),jt.fetchReports()},methods:{createReport:function(){this.editReport(0)},editReport:function(e){ot["MatomoUrl"].updateHash(Object.assign(Object.assign({},ot["MatomoUrl"].hashParsed.value),{},{idCustomReport:e}))},pauseReport:function(e){var t=this;ot["Matomo"].helper.modalConfirm(this.$refs.confirmPauseReport,{yes:function(){jt.pauseReport(e.idcustomreport,e.idsite).then((function(e){e&&"error"!==e.type?(jt.reload().then((function(){t.showNotification(t.translate("CustomReports_PausedReport"),"success")})),ot["Matomo"].postEvent("updateReportingMenu")):jt.reload()}))}})},resumeReport:function(e){var t=this;ot["Matomo"].helper.modalConfirm(this.$refs.confirmResumeReport,{yes:function(){jt.resumeReport(e.idcustomreport,e.idsite).then((function(e){e&&"error"!==e.type?(jt.reload().then((function(){t.showNotification(t.translate("CustomReports_ResumedReport"),"success")})),ot["Matomo"].postEvent("updateReportingMenu")):jt.reload()}))}})},showNotification:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=ot["NotificationsStore"].show({message:e,context:t,id:Eo,type:null!==o?o:"toast"});setTimeout((function(){ot["NotificationsStore"].scrollToNotification(r)}),200)},deleteReport:function(e){ot["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteReport,{yes:function(){jt.deleteReport(e.idcustomreport,e.idsite).then((function(){jt.reload(),ot["Matomo"].postEvent("updateReportingMenu")}))}})},getViewReportLink:function(e){return"?".concat(ot["MatomoUrl"].stringify({module:"CoreHome",action:"index",idSite:e.linkIdSite,period:"day",date:"yesterday"}),"#?").concat(ot["MatomoUrl"].stringify({category:e.category.id,idSite:e.linkIdSite,date:ot["MatomoUrl"].parsed.value.date,period:ot["MatomoUrl"].parsed.value.period,segment:ot["MatomoUrl"].parsed.value.segment,subcategory:e.subcategoryLink}))},truncate:jo,htmlEntities:function(e){return ot["Matomo"].helper.htmlEntities(e)},isMultiSiteReport:function(e){return e.multiple_idsites&&e.multiple_idsites.split(",")}},computed:{isSuperUser:function(){return ot["Matomo"].hasSuperUserAccess},reports:function(){return jt.state.value.reports},sortedReports:function(){var e=this.searchFilter.toLowerCase(),t=Oo(this.reports).filter((function(t){return Object.keys(t).some((function(o){var r=t;return"string"===typeof r[o]&&-1!==r[o].toLowerCase().indexOf(e)}))}));return t.sort((function(e,t){var o=parseInt("".concat(e.idcustomreport),10),r=parseInt("".concat(t.idcustomreport),10);return o-r})),t},isLoading:function(){return jt.state.value.isLoading},isUpdating:function(){return jt.state.value.isUpdating},reportTypesReadable:function(){return jt.state.value.reportTypesReadable}}});ko.render=go;var Vo=ko,wo={class:"manageReports"},_o={key:0},Mo={key:1};function Do(e,t,o,r,i,s){var a=Object(n["resolveComponent"])("CustomReportsList"),l=Object(n["resolveComponent"])("CustomReportsEdit");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",wo,[e.editMode?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_o,[Object(n["createVNode"])(a)])),e.editMode?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Mo,[Object(n["createVNode"])(l,{"id-custom-report":e.idCustomReport,"browser-archiving-disabled":e.browserArchivingDisabled,"re-archive-last-n":e.reArchiveLastN,"max-dimensions":e.maxDimensions,"is-cloud":e.isCloud},null,8,["id-custom-report","browser-archiving-disabled","re-archive-last-n","max-dimensions","is-cloud"])])):Object(n["createCommentVNode"])("",!0)])}var Ao=Object(n["defineComponent"])({props:{browserArchivingDisabled:Boolean,reArchiveLastN:Number,maxDimensions:Number,isCloud:Boolean},components:{CustomReportsList:Vo,CustomReportsEdit:Mt},data:function(){return{editMode:!1,idCustomReport:null}},watch:{editMode:function(){$(".ui-tooltip").remove()}},created:function(){var e=this;Object(n["watch"])((function(){return ot["MatomoUrl"].hashParsed.value.idCustomReport}),(function(t){e.initState(t)})),this.initState(ot["MatomoUrl"].hashParsed.value.idCustomReport)},methods:{removeAnyReportNotification:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];ot["NotificationsStore"].remove("reportsmanagement"),e&&ot["NotificationsStore"].remove("reportsmanagementProductMetric")},initState:function(e){if(e){if("0"===e){var t={isAllowed:!0};if(ot["Matomo"].postEvent("CustomReports.initAddReport",t),t&&!t.isAllowed)return this.editMode=!1,void(this.idCustomReport=null)}this.editMode=!0,this.idCustomReport=parseInt(e,10)}else this.editMode=!1,this.idCustomReport=null;this.removeAnyReportNotification(!e)}}});Ao.render=Do;var Io=Ao;
/**
 * Copyright (C) InnoCraft Ltd - All rights reserved.
 *
 * NOTICE:  All information contained herein is, and remains the property of InnoCraft Ltd.
 * The intellectual and technical concepts contained herein are protected by trade secret
 * or copyright law. Redistribution of this information or reproduction of this material is
 * strictly forbidden unless prior written permission is obtained from InnoCraft Ltd.
 *
 * You shall use this code only in accordance with the license agreement obtained from
 * InnoCraft Ltd.
 *
 * @link https://www.innocraft.com/
 * @license For license details see https://www.innocraft.com/license
 */}})}));
//# sourceMappingURL=CustomReports.umd.min.js.map